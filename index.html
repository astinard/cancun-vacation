<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Vacation Planner 2025 - Cancun & Riviera Maya</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0891b2;
            --primary-dark: #0e7490;
            --secondary: #f97316;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f0fdfa;
            --gray: #64748b;
            --sand: #fef3c7;
            --ocean: #0891b2;
            --coral: #f97316;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.5;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 50%, #0891b2 100%);
            color: white;
            padding: 20px 30px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(8, 145, 178, 0.3);
        }

        .header-content {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-stats {
            display: flex;
            gap: 25px;
            font-size: 0.9rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 5px;
            border-radius: 12px;
        }

        .nav-tab {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: white;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.15);
        }

        .nav-tab.active {
            background: white;
            color: var(--primary);
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 380px 1fr;
            height: calc(100vh - 80px);
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }
            .sidebar {
                max-height: 50vh;
            }
        }

        /* Sidebar */
        .sidebar {
            background: white;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }

        .sidebar-section {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .sidebar-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 12px;
        }

        /* Filters */
        .filter-group {
            margin-bottom: 15px;
        }

        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .chip {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            border: 2px solid #e2e8f0;
            background: white;
            transition: all 0.2s;
        }

        .chip:hover {
            border-color: var(--primary);
        }

        .chip.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .chip.family { border-color: #10b981; }
        .chip.family.active { background: #10b981; border-color: #10b981; }
        .chip.luxury { border-color: #f59e0b; }
        .chip.luxury.active { background: #f59e0b; border-color: #f59e0b; }
        .chip.points { border-color: #0891b2; }
        .chip.points.active { background: #0891b2; border-color: #0891b2; }
        .chip.accessible { border-color: #f97316; }
        .chip.accessible.active { background: #f97316; border-color: #f97316; }
        .chip.villa { border-color: #8b5cf6; }
        .chip.villa.active { background: #8b5cf6; border-color: #8b5cf6; }

        /* Resort List */
        .resort-list {
            padding: 0;
        }

        /* Map Mode Toggle */
        .map-mode-toggle {
            display: flex;
            background: #e2e8f0;
            border-radius: 10px;
            padding: 4px;
        }

        .mode-btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.85rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s;
            color: #64748b;
        }

        .mode-btn.active {
            background: white;
            color: #0891b2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .mode-btn:hover:not(.active) {
            background: rgba(255,255,255,0.5);
        }

        /* Explore Filters */
        .explore-categories {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .explore-chip {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
        }

        /* Toggle Switch */
        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-slider {
            width: 44px;
            height: 24px;
            background: #cbd5e1;
            border-radius: 12px;
            position: relative;
            transition: background 0.2s;
        }

        .toggle-slider::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            transition: transform 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch input:checked + .toggle-slider {
            background: #10b981;
        }

        .toggle-switch input:checked + .toggle-slider::before {
            transform: translateX(20px);
        }

        .toggle-label {
            font-size: 0.85rem;
            color: #475569;
        }

        /* Add Attraction Button */
        .add-attraction-btn {
            float: right;
            background: #10b981;
            color: white;
            border: none;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .add-attraction-btn:hover {
            background: #059669;
        }

        /* Attraction List */
        .attraction-list {
            padding: 0;
            max-height: 400px;
            overflow-y: auto;
        }

        .attraction-card {
            padding: 14px 20px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .attraction-card:hover {
            background: #f0fdfa;
        }

        .attraction-card.selected {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-left: 4px solid #10b981;
        }

        .attraction-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 6px;
        }

        .attraction-icon {
            font-size: 1.4rem;
        }

        .attraction-name {
            font-weight: 600;
            color: #1e293b;
            font-size: 0.9rem;
            flex: 1;
        }

        .attraction-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            color: #f59e0b;
            font-weight: 600;
        }

        .attraction-meta {
            display: flex;
            gap: 10px;
            font-size: 0.75rem;
            color: #64748b;
        }

        .attraction-type {
            background: #f1f5f9;
            padding: 2px 8px;
            border-radius: 4px;
        }

        .attraction-price {
            font-weight: 600;
            color: #059669;
        }

        /* Attraction Detail Modal */
        .attraction-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .attraction-modal.active {
            display: flex;
        }

        .attraction-modal-content {
            background: white;
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
        }

        .attraction-modal-header {
            padding: 24px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
            border-radius: 16px 16px 0 0;
            position: relative;
        }

        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .attraction-modal-body {
            padding: 24px;
        }

        .attraction-detail-section {
            margin-bottom: 20px;
        }

        .attraction-detail-section h4 {
            color: #1e293b;
            margin-bottom: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .attraction-highlights {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .highlight-tag {
            background: #f0fdfa;
            color: #0f766e;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
        }

        .attraction-source {
            background: #f8fafc;
            border-radius: 8px;
            padding: 12px;
            font-size: 0.8rem;
            color: #64748b;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .source-verified {
            color: #10b981;
        }

        .attraction-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .attraction-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            text-align: center;
            transition: all 0.2s;
        }

        .attraction-btn-primary {
            background: linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);
            color: white;
            border: none;
        }

        .attraction-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(8,145,178,0.3);
        }

        .attraction-btn-secondary {
            background: white;
            color: #0891b2;
            border: 2px solid #0891b2;
        }

        /* Add Attraction Modal */
        .add-modal-form {
            padding: 24px;
        }

        .form-row {
            margin-bottom: 16px;
        }

        .form-row label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 6px;
        }

        .form-row input,
        .form-row select,
        .form-row textarea {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: border-color 0.2s;
        }

        .form-row input:focus,
        .form-row select:focus,
        .form-row textarea:focus {
            outline: none;
            border-color: #0891b2;
        }

        .form-row-inline {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .resort-card {
            padding: 16px 20px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .resort-card:hover {
            background: linear-gradient(to right, #f0fdfa, #fefce8);
            transform: translateX(4px);
            box-shadow: -4px 0 12px rgba(8, 145, 178, 0.1);
        }

        .resort-card.selected {
            background: linear-gradient(to right, #cffafe, #fef3c7);
            border-left: 4px solid var(--primary);
        }

        .resort-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .resort-name {
            font-weight: 700;
            font-size: 1rem;
            color: var(--dark);
        }

        .resort-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--warning);
        }

        .resort-location {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .resort-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        .tag {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .tag-family { background: #d1fae5; color: #065f46; }
        .tag-luxury { background: #fef3c7; color: #92400e; }
        .tag-points { background: #cffafe; color: #0e7490; }
        .tag-accessible { background: #ffedd5; color: #c2410c; }
        .tag-adults { background: #fee2e2; color: #991b1b; }
        .tag-new { background: #cffafe; color: #0e7490; }
        .tag-villa { background: #ede9fe; color: #5b21b6; font-weight: 700; }

        .resort-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
        }

        .price-label {
            font-size: 0.75rem;
            color: var(--gray);
        }

        .vote-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .vote-btn:hover {
            background: var(--primary);
            color: white;
        }

        .vote-btn.voted {
            background: var(--primary);
            color: white;
        }

        /* Map Container */
        .map-container {
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* Map Legend */
        .map-legend {
            position: absolute;
            bottom: 30px;
            left: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 500;
            font-size: 0.8rem;
        }

        .legend-title {
            font-weight: 700;
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .legend-marker {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        /* Info Panel */
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 400px;
            max-height: calc(100% - 40px);
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 500;
            overflow: hidden;
            display: none;
        }

        .info-panel.active {
            display: block;
        }

        .info-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
        }

        .info-panel-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .info-panel-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .info-panel-subtitle {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .info-panel-body {
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .info-section {
            margin-bottom: 20px;
        }

        .info-section-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .info-item {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
        }

        .info-item-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .info-item-value {
            font-weight: 700;
            font-size: 1rem;
        }

        .price-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .price-card {
            background: #f0fdf4;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .price-card.highlight {
            background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%);
            border: 2px solid #10b981;
        }

        .price-week {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .price-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
        }

        .link-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .link-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            background: #f8fafc;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .link-item:hover {
            background: #e2e8f0;
        }

        .link-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .link-icon.website { background: #dbeafe; color: #2563eb; }
        .link-icon.reviews { background: #fef3c7; color: #d97706; }
        .link-icon.points { background: #e0e7ff; color: #4f46e5; }
        .link-icon.booking { background: #d1fae5; color: #059669; }

        /* Views */
        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* Voting View */
        .voting-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }

        .voting-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .voting-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .voter-select {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .voter-btn {
            padding: 12px 24px;
            border-radius: 30px;
            border: 2px solid #e2e8f0;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .voter-btn:hover {
            border-color: var(--primary);
        }

        .voter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .voting-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .voting-section h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .vote-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .vote-option {
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .vote-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .vote-option.selected {
            border-color: var(--primary);
            background: linear-gradient(to right, #cffafe, #fef3c7);
        }

        .vote-option-name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .vote-option-detail {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .vote-count-display {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 600;
        }

        .vote-avatars {
            display: flex;
            gap: 4px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .vote-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
        }

        /* Ranked Choice Voting */
        .ranked-choice-container {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .ranked-choice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .ranked-choice-instructions {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 15px;
            padding: 12px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #0891b2;
        }

        .ranked-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .ranked-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .ranked-option:hover {
            border-color: #0891b2;
            transform: translateX(4px);
        }

        .ranked-option.ranked {
            border-color: #10b981;
            background: linear-gradient(to right, #ecfdf5, #f0fdf4);
        }

        .rank-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #e2e8f0;
            color: #64748b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .ranked-option.ranked .rank-number {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .ranked-option-info {
            flex-grow: 1;
        }

        .ranked-option-name {
            font-weight: 600;
            margin-bottom: 2px;
        }

        .ranked-option-detail {
            font-size: 0.8rem;
            color: #64748b;
        }

        .rank-buttons {
            display: flex;
            gap: 4px;
        }

        .rank-btn {
            width: 28px;
            height: 28px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            background: #e2e8f0;
            color: #64748b;
        }

        .rank-btn:hover {
            background: #0891b2;
            color: white;
        }

        .ranked-results {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            border-radius: 12px;
            color: white;
        }

        .ranked-result-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .ranked-result-item:last-child {
            margin-bottom: 0;
        }

        .ranked-result-position {
            width: 36px;
            height: 36px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .ranked-result-position.gold {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        }

        .ranked-result-position.silver {
            background: linear-gradient(135deg, #d1d5db 0%, #9ca3af 100%);
        }

        .ranked-result-position.bronze {
            background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
        }

        /* Voting Progress Bar */
        .voting-progress {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 20px;
        }

        .progress-bar-container {
            height: 12px;
            background: rgba(255,255,255,0.2);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #34d399 100%);
            border-radius: 6px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 0.85rem;
            opacity: 0.9;
            text-align: center;
        }

        /* Quick Pick */
        .quick-pick-container {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #f59e0b;
        }

        .quick-pick-intro {
            text-align: center;
        }

        .quick-pick-intro p {
            color: #92400e;
            margin-bottom: 15px;
        }

        .quick-pick-start-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .quick-pick-start-btn:hover {
            transform: scale(1.05);
        }

        .quick-pick-question {
            text-align: center;
        }

        .quick-pick-question h4 {
            color: #92400e;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .quick-pick-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quick-pick-option {
            background: white;
            border: 2px solid #fbbf24;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
        }

        .quick-pick-option:hover {
            border-color: #f59e0b;
            transform: translateX(5px);
        }

        .quick-pick-option.selected {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .quick-pick-result {
            text-align: center;
            padding: 20px;
        }

        .quick-pick-result h4 {
            color: #065f46;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }

        .quick-pick-resort-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            border: 3px solid #10b981;
        }

        /* Top Resorts Grid */
        .top-resorts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .resort-vote-card {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .resort-vote-card:hover {
            border-color: #0891b2;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .resort-vote-card.selected {
            border-color: #10b981;
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
        }

        .resort-vote-card.selected::after {
            content: 'âœ“';
            position: absolute;
            top: 10px;
            right: 10px;
            background: #10b981;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .resort-vote-name {
            font-weight: 700;
            font-size: 1.1rem;
            color: #1e293b;
            margin-bottom: 5px;
        }

        .resort-vote-detail {
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 10px;
        }

        .resort-vote-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: #0891b2;
        }

        .resort-vote-voters {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .show-more-btn {
            width: 100%;
            padding: 12px;
            background: #f1f5f9;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            color: #64748b;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .show-more-btn:hover {
            background: #e2e8f0;
            border-color: #94a3b8;
        }

        .more-resorts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        /* Result Buttons */
        .reveal-btn {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            color: #78350f;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .export-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .export-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Winner Celebration */
        .winner-celebration {
            text-align: center;
            padding: 30px;
            animation: celebrationPulse 0.5s ease;
        }

        @keyframes celebrationPulse {
            0% { transform: scale(0.9); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .winner-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .winner-resort {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* Budget Simple View */
        .budget-simple-view {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            border-radius: 16px;
            padding: 30px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        .budget-simple-total {
            font-size: 3rem;
            font-weight: 700;
            margin: 10px 0;
        }

        .budget-simple-per-person {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .budget-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .budget-toggle-btn {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .budget-toggle-btn.active {
            background: #0891b2;
            color: white;
            border-color: #0891b2;
        }

        .budget-detailed {
            transition: all 0.3s ease;
        }

        .budget-detailed.collapsed {
            display: none;
        }

        /* Simple Budget View Card */
        .simple-budget-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            max-width: 500px;
            margin: 0 auto 20px;
        }

        .simple-budget-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .simple-budget-card h3 {
            color: #1e293b;
            margin-bottom: 5px;
        }

        .simple-budget-amount {
            font-size: 3.5rem;
            font-weight: 700;
            color: #0891b2;
            margin: 10px 0;
        }

        .simple-budget-subtext {
            color: #64748b;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .simple-budget-breakdown {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 15px 0;
            border-top: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
            margin-bottom: 15px;
        }

        .simple-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .simple-item span:first-child {
            font-size: 0.75rem;
            color: #94a3b8;
            text-transform: uppercase;
        }

        .simple-item span:last-child {
            font-weight: 600;
            color: #334155;
        }

        .simple-budget-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: #ecfdf5;
            border-radius: 8px;
            color: #059669;
            font-weight: 500;
            margin-bottom: 15px;
        }

        .simple-budget-status.over-budget {
            background: #fef2f2;
            color: #dc2626;
        }

        .simple-details-btn {
            background: none;
            border: none;
            color: #0891b2;
            font-size: 0.9rem;
            cursor: pointer;
            padding: 10px;
            text-decoration: underline;
        }

        .simple-resort-picks {
            background: white;
            border-radius: 16px;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        .simple-resort-picks h4 {
            color: #1e293b;
            margin-bottom: 15px;
            text-align: center;
        }

        .simple-picks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }

        .simple-pick-card {
            background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);
            border: 2px solid #14b8a6;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .simple-pick-card:hover {
            transform: translateY(-2px);
        }

        .simple-pick-name {
            font-weight: 600;
            color: #0f766e;
            margin-bottom: 5px;
        }

        .simple-pick-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: #0d9488;
        }

        .simple-pick-note {
            font-size: 0.75rem;
            color: #5eead4;
            margin-top: 5px;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 50%, #0891b2 100%);
            color: white;
            border-radius: 16px;
            padding: 30px;
            margin-top: 30px;
        }

        .results-panel h3 {
            margin-bottom: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .result-label {
            font-weight: 500;
        }

        .result-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Matrix View */
        .matrix-container {
            padding: 30px;
            overflow-x: auto;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .matrix-table th {
            background: var(--dark);
            color: white;
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            white-space: nowrap;
        }

        .matrix-table th:first-child {
            position: sticky;
            left: 0;
            z-index: 10;
        }

        .matrix-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            white-space: nowrap;
        }

        .matrix-table td:first-child {
            position: sticky;
            left: 0;
            background: white;
            font-weight: 600;
            z-index: 5;
        }

        .matrix-table tr:hover td {
            background: #f8fafc;
        }

        .matrix-table tr:hover td:first-child {
            background: #f1f5f9;
        }

        .check-yes { color: var(--success); font-weight: bold; }
        .check-no { color: #cbd5e1; }

        /* Family Info */
        .family-info {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .family-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .family-member {
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .family-member h4 {
            margin-bottom: 5px;
        }

        .family-member p {
            font-size: 0.85rem;
            color: var(--gray);
        }

        /* Airport Info */
        .airport-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Deal Score Badges */
        .deal-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .deal-badge.hot-deal {
            background: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
            color: white;
            animation: pulse 2s infinite;
        }

        .deal-badge.good-value {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
        }

        .deal-badge.premium {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: #78350f;
        }

        .deal-badge.price-drop {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Price Trend Indicators */
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .trend-indicator.down { color: #10b981; }
        .trend-indicator.up { color: #ef4444; }
        .trend-indicator.stable { color: #64748b; }

        /* Budget Calculator Styles */
        .budget-view {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }

        .budget-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .budget-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .budget-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .budget-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .budget-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .budget-input-group {
            margin-bottom: 15px;
        }

        .budget-input-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gray);
            margin-bottom: 6px;
        }

        .budget-input-group input,
        .budget-input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .budget-input-group input:focus,
        .budget-input-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(8, 145, 178, 0.1);
        }

        .budget-summary {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
            border-radius: 16px;
            padding: 30px;
        }

        .budget-summary h3 {
            margin-bottom: 20px;
        }

        .budget-total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .budget-total-row:last-child {
            border-bottom: none;
            padding-top: 20px;
            margin-top: 10px;
            border-top: 2px solid rgba(255,255,255,0.3);
        }

        .budget-total-row .label {
            font-size: 0.95rem;
        }

        .budget-total-row .amount {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .budget-total-row.grand-total .label {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .budget-total-row.grand-total .amount {
            font-size: 1.8rem;
            font-weight: 800;
        }

        .per-person-badge {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
        }

        .per-person-badge .amount {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .per-person-badge .label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        /* Hidden Costs Section */
        .hidden-costs-panel {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
            border-left: 4px solid #f59e0b;
        }

        .hidden-costs-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 12px;
        }

        .hidden-cost-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(146, 64, 14, 0.1);
            font-size: 0.85rem;
        }

        .hidden-cost-item:last-child {
            border-bottom: none;
        }

        .hidden-cost-item .cost-label {
            color: #78350f;
        }

        .hidden-cost-item .cost-value {
            font-weight: 600;
            color: #92400e;
        }

        .hidden-cost-item .cost-value.included {
            color: #059669;
        }

        /* Deal Comparison Panel */
        .comparison-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .comparison-panel.active {
            transform: translateY(0);
        }

        .comparison-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .comparison-item {
            padding: 15px 20px;
            border-right: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-item h4 {
            font-size: 0.95rem;
            margin-bottom: 10px;
        }

        .compare-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            padding: 4px 0;
        }

        .compare-section {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #e2e8f0;
        }

        .compare-section-title {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: #64748b;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .compare-amenities {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .compare-amenity {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            background: #f1f5f9;
        }

        .compare-amenity.has {
            background: #d1fae5;
            color: #065f46;
        }

        .compare-amenity.missing {
            background: #fee2e2;
            color: #dc2626;
        }

        .comparison-actions {
            display: flex;
            gap: 8px;
            padding: 10px 20px;
            background: #f8fafc;
            border-top: 1px solid #e2e8f0;
        }

        .comparison-actions button {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            border: none;
        }

        .comparison-actions .share-btn {
            background: #3b82f6;
            color: white;
        }

        .comparison-actions .copy-btn {
            background: #10b981;
            color: white;
        }

        .share-toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: #1e293b;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 0.85rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }

        .share-toast.show {
            opacity: 1;
        }

        /* Savings Summary */
        .savings-panel {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
        }

        .savings-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #065f46;
            margin-bottom: 12px;
        }

        .savings-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 0.85rem;
            color: #047857;
        }

        .savings-total {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            margin-top: 8px;
            border-top: 2px solid #10b981;
            font-weight: 700;
            font-size: 1rem;
            color: #065f46;
        }

        /* Credit Card Portals */
        .portal-links {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .portal-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.2s;
        }

        .portal-link:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .portal-link .portal-name {
            font-weight: 600;
            font-size: 0.8rem;
            color: var(--dark);
        }

        .portal-link .portal-bonus {
            font-size: 0.7rem;
            color: var(--success);
            margin-top: 4px;
        }

        /* Best Time to Book */
        .booking-tips {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
        }

        .booking-tips-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 12px;
        }

        .booking-deadline {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .booking-deadline .date {
            font-weight: 700;
            color: #1e40af;
            font-size: 0.85rem;
        }

        .booking-deadline .note {
            font-size: 0.8rem;
            color: #3b82f6;
        }

        /* Budget Fit Indicators */
        .budget-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
        }

        .budget-under {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
        }

        .budget-sweet {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
            animation: glow 2s ease-in-out infinite;
        }

        .budget-over {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: #78350f;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
            50% { box-shadow: 0 0 15px rgba(59, 130, 246, 0.8); }
        }

        .budget-target-display {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .budget-target-display h3 {
            margin: 0;
            font-size: 1rem;
        }

        .budget-target-range {
            display: flex;
            gap: 20px;
        }

        .budget-target-range .target-item {
            text-align: center;
        }

        .budget-target-range .target-value {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .budget-target-range .target-label {
            font-size: 0.7rem;
            opacity: 0.8;
        }

        /* Compare checkbox */
        .compare-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
        }

        .compare-checkbox input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .compare-checkbox label {
            font-size: 0.75rem;
            color: var(--gray);
            cursor: pointer;
        }

        /* ============================================
           MOBILE RESPONSIVE STYLES
           ============================================ */

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            .header h1 {
                font-size: 1.3rem;
            }

            .nav-tabs {
                width: 100%;
                overflow-x: auto;
                justify-content: flex-start;
                gap: 5px;
                padding-bottom: 5px;
            }

            .nav-tab {
                padding: 8px 12px;
                font-size: 0.8rem;
                white-space: nowrap;
            }

            .header-stats {
                width: 100%;
                justify-content: space-around;
            }

            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                max-width: none;
                max-height: 40vh;
            }

            .map-container {
                height: 50vh;
            }

            .filter-chips {
                flex-wrap: wrap;
            }

            .chip {
                font-size: 0.7rem;
                padding: 4px 10px;
            }

            .resort-card {
                flex-direction: column;
                gap: 10px;
            }

            .resort-card-left {
                width: 100%;
            }

            .resort-card-right {
                width: 100%;
                text-align: left;
            }

            .matrix-view {
                overflow-x: auto;
            }

            .matrix-table {
                font-size: 0.75rem;
                min-width: 800px;
            }

            .matrix-table th,
            .matrix-table td {
                padding: 8px 10px;
            }

            .budget-section {
                padding: 15px;
            }

            .budget-section h3 {
                font-size: 1rem;
            }

            .budget-calculator {
                gap: 15px;
            }

            .calc-form, .calc-results {
                padding: 15px;
            }

            .budget-target-range {
                flex-wrap: wrap;
                gap: 10px;
            }

            .quick-compare-grid {
                grid-template-columns: 1fr;
            }

            .savings-panel, .hidden-costs-panel {
                padding: 12px;
            }

            .hidden-costs-breakdown {
                flex-direction: column;
                gap: 8px;
            }

            .vote-section {
                padding: 15px;
            }

            .member-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .deal-links a {
                display: block;
                margin-bottom: 8px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.1rem;
            }

            .nav-tab {
                padding: 6px 10px;
                font-size: 0.75rem;
            }

            .stat-value {
                font-size: 1.2rem;
            }

            .sidebar {
                max-height: 35vh;
            }

            .map-container {
                height: 45vh;
            }

            .resort-item {
                padding: 10px;
            }

            .resort-name {
                font-size: 0.85rem;
            }

            .calc-total {
                font-size: 1.5rem;
            }

            .member-grid {
                grid-template-columns: 1fr;
            }

            .budget-target-range .target-value {
                font-size: 1.1rem;
            }
        }

        /* Touch-friendly improvements */
        @media (hover: none) and (pointer: coarse) {
            .chip, .nav-tab, button {
                min-height: 44px;
                min-width: 44px;
            }

            .resort-item {
                min-height: 60px;
            }

            .compare-checkbox input {
                width: 24px;
                height: 24px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1><span style="font-size:1.6rem;">ðŸŒ´</span> Cancun Family Vacation 2025 <span style="font-size:1.6rem;">ðŸŒŠ</span></h1>

            <nav class="nav-tabs">
                <button class="nav-tab active" data-view="map">Map</button>
                <button class="nav-tab" data-view="matrix">Full Matrix</button>
                <button class="nav-tab" data-view="budget">Deals & Budget</button>
                <button class="nav-tab" data-view="voting">Family Voting</button>
                <button class="nav-tab" data-view="itinerary">Itinerary</button>
                <button class="nav-tab" data-view="group">Group</button>
                <button class="nav-tab" data-view="prep">Prep & Pack</button>
            </nav>

            <div class="header-stats">
                <div class="stat">
                    <div class="stat-value">14</div>
                    <div class="stat-label">People</div>
                </div>
                <div class="stat">
                    <div class="stat-value">7</div>
                    <div class="stat-label">Rooms</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="resortCount">45</div>
                    <div class="stat-label">Options</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Map View -->
    <div class="view active" id="view-map">
        <div class="main-container">
            <aside class="sidebar">
                <!-- Map Mode Toggle: Resorts vs Explore -->
                <div class="sidebar-section" style="padding-bottom:10px;">
                    <div class="map-mode-toggle">
                        <button class="mode-btn active" data-mode="resorts" onclick="setMapMode('resorts')">
                            <span>ðŸ¨</span> Resorts
                        </button>
                        <button class="mode-btn" data-mode="explore" onclick="setMapMode('explore')">
                            <span>ðŸ§­</span> Explore
                        </button>
                    </div>
                </div>

                <!-- RESORTS MODE FILTERS -->
                <div id="resortFilters">
                <div class="sidebar-section">
                    <div class="sidebar-title">Target Weeks</div>
                    <div class="filter-chips">
                        <div class="chip active" data-week="may24">May 24-31 (Best $)</div>
                        <div class="chip" data-week="may31">May 31 - Jun 7</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">Filter Resorts</div>

                    <div class="filter-group">
                        <span class="filter-label">Area</span>
                        <div class="filter-chips">
                            <div class="chip active" data-filter="area" data-value="all">All</div>
                            <div class="chip" data-filter="area" data-value="cancun">Cancun</div>
                            <div class="chip" data-filter="area" data-value="riviera">Riviera Maya</div>
                            <div class="chip" data-filter="area" data-value="tulum">Tulum</div>
                            <div class="chip" data-filter="area" data-value="costa">Costa Mujeres</div>
                        </div>
                    </div>

                    <div class="filter-group">
                        <span class="filter-label">Features</span>
                        <div class="filter-chips">
                            <div class="chip family" data-filter="feature" data-value="family">Family</div>
                            <div class="chip accessible" data-filter="feature" data-value="accessible">Accessible</div>
                            <div class="chip points" data-filter="feature" data-value="points">Bookable w/ Points</div>
                            <div class="chip luxury" data-filter="feature" data-value="luxury">Luxury</div>
                            <div class="chip villa" data-filter="feature" data-value="villa">Private Villas</div>
                        </div>
                    </div>

                    <div class="filter-group">
                        <span class="filter-label">Price Range (per room/night)</span>
                        <div class="filter-chips">
                            <div class="chip active" data-filter="price" data-value="all">All</div>
                            <div class="chip" data-filter="price" data-value="budget">Under $300</div>
                            <div class="chip" data-filter="price" data-value="mid">$300-500</div>
                            <div class="chip" data-filter="price" data-value="luxury">$500+</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section" style="padding: 0;">
                    <div class="sidebar-title" style="padding: 20px 20px 10px;">Resorts (<span id="filteredCount">0</span>)</div>
                    <div class="resort-list" id="resortList"></div>
                </div>
                </div><!-- End resortFilters -->

                <!-- EXPLORE MODE FILTERS (hidden by default) -->
                <div id="exploreFilters" style="display:none;">
                    <div class="sidebar-section">
                        <div class="sidebar-title">What are you looking for?</div>
                        <div class="filter-chips explore-categories">
                            <div class="chip explore-chip active" data-category="all" onclick="filterAttractions('all')">
                                <span>âœ¨</span> All
                            </div>
                            <div class="chip explore-chip" data-category="eco-park" onclick="filterAttractions('eco-park')">
                                <span>ðŸŒ¿</span> Eco-Parks
                            </div>
                            <div class="chip explore-chip" data-category="ruins" onclick="filterAttractions('ruins')">
                                <span>ðŸ›ï¸</span> Ruins
                            </div>
                            <div class="chip explore-chip" data-category="cenote" onclick="filterAttractions('cenote')">
                                <span>ðŸ’§</span> Cenotes
                            </div>
                            <div class="chip explore-chip" data-category="island" onclick="filterAttractions('island')">
                                <span>ðŸï¸</span> Islands
                            </div>
                            <div class="chip explore-chip" data-category="water-activity" onclick="filterAttractions('water-activity')">
                                <span>ðŸ¤¿</span> Water Sports
                            </div>
                            <div class="chip explore-chip" data-category="restaurant" onclick="filterAttractions('restaurant')">
                                <span>ðŸ½ï¸</span> Restaurants
                            </div>
                            <div class="chip explore-chip" data-category="shopping" onclick="filterAttractions('shopping')">
                                <span>ðŸ›ï¸</span> Shopping
                            </div>
                            <div class="chip explore-chip" data-category="family" onclick="filterAttractions('family')">
                                <span>ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦</span> Family Fun
                            </div>
                        </div>
                    </div>

                    <div class="sidebar-section">
                        <div class="sidebar-title">Filter by Area</div>
                        <div class="filter-chips">
                            <div class="chip active" data-explore-area="all" onclick="filterAttractionsByArea('all')">All Areas</div>
                            <div class="chip" data-explore-area="cancun" onclick="filterAttractionsByArea('cancun')">Cancun</div>
                            <div class="chip" data-explore-area="riviera" onclick="filterAttractionsByArea('riviera')">Riviera Maya</div>
                            <div class="chip" data-explore-area="tulum" onclick="filterAttractionsByArea('tulum')">Tulum</div>
                            <div class="chip" data-explore-area="costa" onclick="filterAttractionsByArea('costa')">Costa Mujeres</div>
                            <div class="chip" data-explore-area="inland" onclick="filterAttractionsByArea('inland')">Inland</div>
                        </div>
                    </div>

                    <div class="sidebar-section">
                        <div class="sidebar-title">Family Friendly Only</div>
                        <div class="filter-chips">
                            <label class="toggle-switch">
                                <input type="checkbox" id="kidFriendlyFilter" onchange="toggleKidFriendly()">
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Show only kid-friendly</span>
                            </label>
                        </div>
                    </div>

                    <div class="sidebar-section" style="padding: 0;">
                        <div class="sidebar-title" style="padding: 20px 20px 10px;">
                            Attractions (<span id="attractionCount">0</span>)
                            <button onclick="openAddAttractionModal()" class="add-attraction-btn" title="Suggest a place">+ Add</button>
                        </div>
                        <div class="attraction-list" id="attractionList"></div>
                    </div>
                </div><!-- End exploreFilters -->
            </aside>

            <div class="map-container">
                <div id="map"></div>

                <div class="map-legend">
                    <div class="legend-title">Legend</div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #10b981;"></div>
                        <span>Family-Friendly</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #f59e0b;"></div>
                        <span>Luxury</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #0891b2;"></div>
                        <span>Points Eligible</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #ef4444;"></div>
                        <span>Adults Only</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #f97316;"></div>
                        <span>Accessible</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #8b5cf6;"></div>
                        <span>Private Villa</span>
                    </div>
                </div>

                <div class="info-panel" id="infoPanel">
                    <button class="info-panel-close" onclick="closeInfoPanel()">&times;</button>
                    <div class="info-panel-header">
                        <div class="info-panel-title" id="panelTitle">Resort Name</div>
                        <div class="info-panel-subtitle" id="panelSubtitle">Location</div>
                    </div>
                    <div class="info-panel-body" id="panelBody"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Matrix View -->
    <div class="view" id="view-matrix">
        <div class="matrix-container">
            <div class="family-info">
                <h3>Our Group</h3>
                <div class="family-grid">
                    <div class="family-member">
                        <h4>Mom, Dad & Aunt</h4>
                        <p>3 people (near 80, mobility needs)</p>
                        <p>Des Moines, IA</p>
                    </div>
                    <div class="family-member">
                        <h4>Becketts Family</h4>
                        <p>5 people (3 college-age)</p>
                        <p>Iowa City, IA</p>
                    </div>
                    <div class="family-member">
                        <h4>Our Family</h4>
                        <p>4 people (kids 9 & 11)</p>
                        <p>Florida</p>
                    </div>
                    <div class="family-member">
                        <h4>Dann & Husband</h4>
                        <p>2 people</p>
                        <p>Omaha, NE</p>
                    </div>
                </div>
            </div>

            <table class="matrix-table" id="matrixTable">
                <thead>
                    <tr>
                        <th>Resort</th>
                        <th>Area</th>
                        <th>Airport</th>
                        <th>May 24-31</th>
                        <th>May 31-Jun 7</th>
                        <th>7 Nights Total</th>
                        <th>Family</th>
                        <th>Accessible</th>
                        <th>Points</th>
                        <th>Rating</th>
                        <th>Links</th>
                    </tr>
                </thead>
                <tbody id="matrixBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Voting View -->
    <div class="view" id="view-voting">
        <div class="voting-container">
            <div class="voting-header">
                <h2>Family Voting</h2>
                <p>Select your name and pick your favorites!</p>

                <!-- Voting Progress -->
                <div class="voting-progress" id="votingProgress">
                    <div class="progress-bar-container">
                        <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                    </div>
                    <div class="progress-text"><span id="voterCount">0</span> of 14 family members have voted</div>
                </div>

                <div class="voter-select" id="voterSelect"></div>
            </div>

            <!-- Quick Pick Section -->
            <div class="voting-section" id="quickPickSection">
                <h3>ðŸŽ¯ Quick Pick - Let Us Recommend!</h3>
                <div class="quick-pick-container" id="quickPickContainer">
                    <div class="quick-pick-intro">
                        <p>Not sure which resort? Answer 3 quick questions and we'll recommend the best fit!</p>
                        <button onclick="startQuickPick()" class="quick-pick-start-btn">Start Quick Pick â†’</button>
                    </div>
                </div>
            </div>

            <div class="voting-section">
                <h3>ðŸ† Pick Your Top Resort</h3>
                <p style="font-size:0.85rem;color:#64748b;margin-bottom:15px;">Click to select your #1 choice. Your vote is saved automatically!</p>
                <div class="top-resorts-grid" id="topResortsGrid">
                    <!-- Top 4 resorts rendered by JS -->
                </div>
                <button id="showMoreResortsBtn" onclick="toggleMoreResorts()" class="show-more-btn">
                    Show all resorts â–¼
                </button>
                <div class="more-resorts-grid" id="moreResortsGrid" style="display:none;">
                    <!-- Additional resorts rendered by JS -->
                </div>
            </div>

            <div class="voting-section">
                <h3>ðŸ“… Preferred Week</h3>
                <div class="vote-options" id="weekVoteOptions">
                    <div class="vote-option" data-category="week" data-value="may24">
                        <div class="vote-option-name">May 24-31, 2025</div>
                        <div class="vote-option-detail">Best value - shoulder season pricing</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                    <div class="vote-option" data-category="week" data-value="may31">
                        <div class="vote-option-name">May 31 - June 7, 2025</div>
                        <div class="vote-option-detail">Early summer - slightly higher prices</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                </div>
            </div>

            <div class="voting-section">
                <h3>Trip Length</h3>
                <div class="vote-options" id="lengthVoteOptions">
                    <div class="vote-option" data-category="length" data-value="5">
                        <div class="vote-option-name">5 Nights</div>
                        <div class="vote-option-detail">Shorter trip, lower cost</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                    <div class="vote-option" data-category="length" data-value="7">
                        <div class="vote-option-name">7 Nights</div>
                        <div class="vote-option-detail">Recommended - full week</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                </div>
            </div>

            <div class="results-panel" id="resultsPanel">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;">
                    <h3 style="margin:0;">ðŸ“Š Current Results</h3>
                    <div style="display:flex;gap:8px;">
                        <button onclick="revealWinner()" class="reveal-btn" id="revealBtn" style="display:none;">
                            ðŸŽ‰ Reveal Winner
                        </button>
                        <button onclick="exportResults()" class="export-btn">
                            ðŸ“¤ Share
                        </button>
                    </div>
                </div>
                <div id="votingResults"></div>
                <div id="winnerCelebration" style="display:none;"></div>
            </div>
        </div>
    </div>

    <!-- Confetti Canvas -->
    <canvas id="confettiCanvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999;display:none;"></canvas>

    <!-- Budget & Deals View -->
    <div class="view" id="view-budget">
        <div class="budget-view">
            <div class="budget-header">
                <h2>Trip Budget Calculator & Deal Finder</h2>
                <p>Calculate your total trip cost and find the best deals for your group of 14</p>

                <!-- Simple/Detailed Toggle -->
                <div class="budget-toggle">
                    <button class="budget-toggle-btn active" onclick="setBudgetMode('simple')">Simple View</button>
                    <button class="budget-toggle-btn" onclick="setBudgetMode('detailed')">Detailed View</button>
                </div>
            </div>

            <!-- SIMPLE VIEW - Just the essentials -->
            <div id="budgetSimpleView" class="budget-simple-view">
                <div class="simple-budget-card">
                    <div class="simple-budget-icon">ðŸ–ï¸</div>
                    <h3>Estimated Trip Total</h3>
                    <div class="simple-budget-amount" id="simpleTotalAmount">$22,500</div>
                    <div class="simple-budget-subtext">For 14 people, 7 nights all-inclusive</div>
                    <div class="simple-budget-breakdown">
                        <div class="simple-item">
                            <span>Resort</span>
                            <span id="simpleResortCost">~$15,000</span>
                        </div>
                        <div class="simple-item">
                            <span>Flights</span>
                            <span id="simpleFlightCost">~$5,500</span>
                        </div>
                        <div class="simple-item">
                            <span>Activities</span>
                            <span id="simpleActivityCost">~$2,000</span>
                        </div>
                    </div>
                    <div class="simple-budget-status" id="simpleBudgetStatus">
                        <span class="status-icon">âœ…</span>
                        <span>Within your $20K-$25K budget target!</span>
                    </div>
                    <button onclick="setBudgetMode('detailed')" class="simple-details-btn">
                        Want to customize? View detailed breakdown â†’
                    </button>
                </div>

                <!-- Quick Resort Picks in Simple View -->
                <div class="simple-resort-picks">
                    <h4>Top 3 Value Picks</h4>
                    <div class="simple-picks-grid" id="simpleResortPicks">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Price Tracking Dashboard -->
                <div style="background:white;border-radius:16px;padding:24px;margin-top:20px;">
                    <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.5rem;">ðŸ“Š</span> Price Tracking & Deals
                    </h3>

                    <!-- Deal Score Banner -->
                    <div id="dealScoreBanner" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%);color:white;padding:20px;border-radius:12px;margin-bottom:20px;">
                        <div style="display:flex;align-items:center;gap:15px;">
                            <div style="font-size:3rem;">ðŸ”¥</div>
                            <div>
                                <div style="font-size:1.5rem;font-weight:700;">Great Time to Book!</div>
                                <div style="opacity:0.9;">May prices are 15% below average for Cancun all-inclusives</div>
                            </div>
                            <div style="margin-left:auto;text-align:right;">
                                <div style="font-size:0.8rem;opacity:0.8;">DEAL SCORE</div>
                                <div style="font-size:2rem;font-weight:700;">8.5/10</div>
                            </div>
                        </div>
                    </div>

                    <!-- Price History Chart (simplified visual) -->
                    <div style="margin-bottom:20px;">
                        <h4 style="margin-bottom:15px;color:#1e293b;">Resort Price Trends (Last 6 Months)</h4>
                        <div style="background:#f8fafc;border-radius:12px;padding:20px;">
                            <div style="display:flex;justify-content:space-between;margin-bottom:10px;font-size:0.8rem;color:#64748b;">
                                <span>$300/night</span>
                                <span>$500/night</span>
                            </div>
                            <div style="display:flex;align-items:flex-end;gap:8px;height:100px;">
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#e2e8f0;border-radius:4px 4px 0 0;height:70%"></div>
                                    <span style="font-size:0.7rem;color:#64748b;margin-top:4px;">Jul</span>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#e2e8f0;border-radius:4px 4px 0 0;height:65%"></div>
                                    <span style="font-size:0.7rem;color:#64748b;margin-top:4px;">Aug</span>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#e2e8f0;border-radius:4px 4px 0 0;height:55%"></div>
                                    <span style="font-size:0.7rem;color:#64748b;margin-top:4px;">Sep</span>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#e2e8f0;border-radius:4px 4px 0 0;height:50%"></div>
                                    <span style="font-size:0.7rem;color:#64748b;margin-top:4px;">Oct</span>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#e2e8f0;border-radius:4px 4px 0 0;height:45%"></div>
                                    <span style="font-size:0.7rem;color:#64748b;margin-top:4px;">Nov</span>
                                </div>
                                <div style="flex:1;display:flex;flex-direction:column;align-items:center;">
                                    <div style="width:100%;background:#10b981;border-radius:4px 4px 0 0;height:40%;box-shadow:0 0 10px rgba(16,185,129,0.5);"></div>
                                    <span style="font-size:0.7rem;color:#10b981;font-weight:700;margin-top:4px;">May âœ“</span>
                                </div>
                            </div>
                            <div style="text-align:center;margin-top:15px;font-size:0.85rem;color:#10b981;font-weight:600;">
                                â†“ May is the lowest price point of the year for Cancun!
                            </div>
                        </div>
                    </div>

                    <!-- Quick Check Links -->
                    <div>
                        <h4 style="margin-bottom:15px;color:#1e293b;">Check Live Prices</h4>
                        <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));gap:12px;">
                            <a href="https://www.costcotravel.com/Vacation-Packages/Mexico/Cancun" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">ðŸª</span>
                                <div>
                                    <div style="font-weight:600;">Costco Travel</div>
                                    <div style="font-size:0.75rem;color:#10b981;">Often best value</div>
                                </div>
                            </a>
                            <a href="https://www.google.com/travel/flights?q=flights%20to%20cancun%20may%202025" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">âœˆï¸</span>
                                <div>
                                    <div style="font-weight:600;">Google Flights</div>
                                    <div style="font-size:0.75rem;color:#64748b;">Track flight prices</div>
                                </div>
                            </a>
                            <a href="https://www.kayak.com/hotels/Cancun,Mexico/2025-05-24/2025-05-31/2adults" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">ðŸ”</span>
                                <div>
                                    <div style="font-weight:600;">Kayak</div>
                                    <div style="font-size:0.75rem;color:#64748b;">Compare hotels</div>
                                </div>
                            </a>
                            <a href="https://www.expedia.com/Cancun-Hotels.d178236.Travel-Guide-Hotels" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">ðŸŒ</span>
                                <div>
                                    <div style="font-weight:600;">Expedia</div>
                                    <div style="font-size:0.75rem;color:#64748b;">Bundle deals</div>
                                </div>
                            </a>
                            <a href="https://www.southwest.com" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">â¤ï¸</span>
                                <div>
                                    <div style="font-weight:600;">Southwest</div>
                                    <div style="font-size:0.75rem;color:#64748b;">Free bags + changes</div>
                                </div>
                            </a>
                            <a href="https://www.tripadvisor.com/Hotels-g150807-Cancun_Yucatan_Peninsula-Hotels.html" target="_blank" style="display:flex;align-items:center;gap:10px;padding:15px;background:#f8fafc;border-radius:10px;text-decoration:none;color:#1e293b;border:2px solid transparent;transition:border-color 0.2s;" onmouseover="this.style.borderColor='#0891b2'" onmouseout="this.style.borderColor='transparent'">
                                <span style="font-size:1.5rem;">ðŸ¦‰</span>
                                <div>
                                    <div style="font-weight:600;">TripAdvisor</div>
                                    <div style="font-size:0.75rem;color:#64748b;">Reviews + prices</div>
                                </div>
                            </a>
                        </div>
                    </div>

                    <!-- Price Alert Signup -->
                    <div style="margin-top:20px;background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border-radius:12px;padding:20px;border:2px solid #f59e0b;">
                        <div style="display:flex;align-items:center;gap:15px;flex-wrap:wrap;">
                            <span style="font-size:2rem;">ðŸ””</span>
                            <div style="flex:1;min-width:200px;">
                                <div style="font-weight:700;color:#92400e;">Set Price Alerts</div>
                                <div style="font-size:0.85rem;color:#a16207;">Get notified when prices drop</div>
                            </div>
                            <div style="display:flex;gap:10px;">
                                <a href="https://www.google.com/travel/flights" target="_blank" style="padding:10px 20px;background:white;color:#92400e;border-radius:8px;text-decoration:none;font-weight:600;font-size:0.9rem;">Google Flights Alert</a>
                                <a href="https://www.kayak.com/alerts" target="_blank" style="padding:10px 20px;background:#92400e;color:white;border-radius:8px;text-decoration:none;font-weight:600;font-size:0.9rem;">Kayak Alert</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- DETAILED VIEW - Full calculator -->
            <div id="budgetDetailedView" style="display:none;">
            <div class="budget-target-display">
                <div>
                    <h3>Your Budget Target</h3>
                    <div style="font-size:0.8rem;opacity:0.9;">Total trip for 14 people, 7 nights</div>
                </div>
                <div class="budget-target-range">
                    <div class="target-item">
                        <div class="target-value">$20K</div>
                        <div class="target-label">MIN</div>
                    </div>
                    <div class="target-item" style="background:rgba(255,255,255,0.15);padding:5px 15px;border-radius:8px;">
                        <div class="target-value">$22.5K</div>
                        <div class="target-label">SWEET SPOT</div>
                    </div>
                    <div class="target-item">
                        <div class="target-value">$25K</div>
                        <div class="target-label">MAX</div>
                    </div>
                </div>
            </div>

            <div class="budget-grid">
                <!-- Resort Selection -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#cffafe;color:#0891b2;">1</span>
                        Select Resort
                    </h3>
                    <div class="budget-input-group">
                        <label>Choose Resort</label>
                        <select id="budgetResort" onchange="updateBudgetCalc()">
                            <option value="">-- Select a resort --</option>
                        </select>
                    </div>
                    <div class="budget-input-group">
                        <label>Travel Week</label>
                        <select id="budgetWeek" onchange="updateBudgetCalc()">
                            <option value="may24">May 24-31, 2025 (Best Value)</option>
                            <option value="may31">May 31 - Jun 7, 2025</option>
                        </select>
                    </div>
                    <div class="budget-input-group">
                        <label>Number of Nights</label>
                        <select id="budgetNights" onchange="updateBudgetCalc()">
                            <option value="5">5 nights</option>
                            <option value="6">6 nights</option>
                            <option value="7" selected>7 nights</option>
                        </select>
                    </div>
                    <div id="resortDealBadge" style="margin-top:15px;"></div>
                </div>

                <!-- Flights -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#dbeafe;color:#2563eb;">2</span>
                        Flights (14 people)
                    </h3>
                    <div class="budget-input-group">
                        <label>Des Moines Group (3 people - Mom, Dad, Aunt)</label>
                        <input type="number" id="flightDSM" value="450" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Iowa City Group (5 people - Becketts)</label>
                        <input type="number" id="flightIC" value="420" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Florida Group (4 people - Your family)</label>
                        <input type="number" id="flightFL" value="280" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Omaha (2 people - Dann & Husband)</label>
                        <input type="number" id="flightOMA" value="380" onchange="updateBudgetCalc()">
                    </div>
                    <div style="margin-top:10px;padding:12px;background:#f0fdf4;border-radius:8px;">
                        <div style="font-size:0.8rem;color:#059669;font-weight:600;">Flight Tips:</div>
                        <div style="font-size:0.75rem;color:#047857;margin-top:4px;">Southwest from Omaha has seasonal direct flights. Check Google Flights for best prices.</div>
                    </div>
                </div>

                <!-- Transfers -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#fef3c7;color:#d97706;">3</span>
                        Airport Transfers
                    </h3>
                    <div class="budget-input-group">
                        <label>Transfer Type</label>
                        <select id="transferType" onchange="updateBudgetCalc()">
                            <option value="private">Private Van (2 vans, door-to-door)</option>
                            <option value="shared">Shared Shuttle (per person)</option>
                            <option value="included">Included with Resort</option>
                        </select>
                    </div>
                    <div id="transferCostNote" style="margin-top:10px;padding:12px;background:#fef3c7;border-radius:8px;font-size:0.8rem;color:#92400e;"></div>
                </div>

                <!-- Excursions -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#f0fdf4;color:#059669;">4</span>
                        Excursions & Activities
                    </h3>
                    <div class="budget-input-group">
                        <label>Estimated per person for activities</label>
                        <select id="excursionBudget" onchange="updateBudgetCalc()">
                            <option value="0">None / Resort Only</option>
                            <option value="100">Light ($100/person) - 1 day trip</option>
                            <option value="200" selected>Moderate ($200/person) - 2-3 activities</option>
                            <option value="350">Full ($350/person) - Multiple parks/tours</option>
                        </select>
                    </div>
                    <div style="margin-top:10px;padding:12px;background:#f0fdf4;border-radius:8px;">
                        <div style="font-size:0.8rem;color:#059669;font-weight:600;">Popular Options:</div>
                        <ul style="font-size:0.75rem;color:#047857;margin:4px 0 0 15px;">
                            <li>Xcaret Park: ~$130/adult</li>
                            <li>Chichen Itza Tour: ~$80/person</li>
                            <li>Snorkeling Tour: ~$50/person</li>
                            <li>Hotel Xcaret includes ALL parks!</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Deal Finder Section -->
            <div style="background:white;border-radius:16px;padding:24px;margin-bottom:20px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">ðŸ”</span> Deal Finder & Booking Tips
                </h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px;">
                    <!-- Best Time to Book -->
                    <div class="booking-tips">
                        <div class="booking-tips-title">
                            <span>ðŸ“…</span> Best Time to Book
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Jan 15 - Feb 28</span>
                            <span class="note">Optimal booking window for May 2025</span>
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Feb 15</span>
                            <span class="note">Prices increase after President's Day</span>
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Mar 1</span>
                            <span class="note">Spring break surge pricing starts</span>
                        </div>
                    </div>

                    <!-- Credit Card Portals -->
                    <div style="background:linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);border-radius:12px;padding:16px;">
                        <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:#5b21b6;margin-bottom:12px;">
                            <span>ðŸ’³</span> Credit Card Portal Bonuses
                        </div>
                        <div class="portal-links">
                            <a href="https://ultimaterewardspoints.chase.com" target="_blank" class="portal-link">
                                <span class="portal-name">Chase Travel</span>
                                <span class="portal-bonus">1.5x points (Reserve)</span>
                            </a>
                            <a href="https://travel.americanexpress.com" target="_blank" class="portal-link">
                                <span class="portal-name">Amex Travel</span>
                                <span class="portal-bonus">5x on flights</span>
                            </a>
                            <a href="https://travel.capitalone.com" target="_blank" class="portal-link">
                                <span class="portal-name">Capital One</span>
                                <span class="portal-bonus">10x on hotels</span>
                            </a>
                            <a href="https://www.costcotravel.com" target="_blank" class="portal-link">
                                <span class="portal-name">Costco Travel</span>
                                <span class="portal-bonus">15-25% savings!</span>
                            </a>
                        </div>
                    </div>

                    <!-- Package Deals -->
                    <div style="background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border-radius:12px;padding:16px;">
                        <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:#92400e;margin-bottom:12px;">
                            <span>ðŸ“¦</span> Package Deals (Flight + Hotel)
                        </div>
                        <div style="display:grid;gap:8px;">
                            <a href="https://www.costcotravel.com/Vacation-Packages/Mexico" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Costco Travel</span>
                                <span style="color:#059669;font-weight:600;">Best Value!</span>
                            </a>
                            <a href="https://www.southwestvacations.com" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Southwest Vacations</span>
                                <span style="color:#64748b;">Free bags/changes</span>
                            </a>
                            <a href="https://www.applevacations.com" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Apple Vacations</span>
                                <span style="color:#64748b;">Charter flights</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Flight Price Widget -->
            <div style="background:white;border-radius:16px;padding:24px;margin-bottom:20px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;color:#1e293b;">
                    <span style="font-size:1.5rem;">âœˆï¸</span> Flight Price Tracker
                </h3>
                <p style="font-size:0.85rem;color:#64748b;margin-bottom:20px;">
                    Estimated prices for May 24-31, 2025 to Cancun (CUN). Click to check current prices.
                </p>
                <div id="flightPriceWidget" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(220px, 1fr));gap:15px;">
                    <!-- Flight prices will be rendered by JS -->
                </div>
                <div style="margin-top:15px;padding:12px;background:#f0f9ff;border-radius:8px;border-left:4px solid #0284c7;">
                    <div style="font-size:0.8rem;color:#0369a1;font-weight:600;">ðŸ’¡ Pro Tips:</div>
                    <ul style="font-size:0.75rem;color:#0369a1;margin:6px 0 0 15px;">
                        <li>Book 6-8 weeks ahead for best prices</li>
                        <li>Southwest has free checked bags + changes</li>
                        <li>Midweek flights (Tue-Wed) are usually cheapest</li>
                        <li>Use Google Flights for price alerts</li>
                    </ul>
                </div>
            </div>

            <!-- Price Alert Signup -->
            <div style="background:linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);border-radius:16px;padding:24px;margin-bottom:20px;box-shadow:0 4px 20px rgba(0,0,0,0.08);border:2px solid #10b981;">
                <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;color:#065f46;">
                    <span style="font-size:1.5rem;">ðŸ””</span> Get Price Drop Alerts
                </h3>
                <p style="font-size:0.9rem;color:#047857;margin-bottom:20px;">
                    Sign up to receive email notifications when prices drop for your favorite resorts.
                </p>
                <div class="price-alert-form" id="priceAlertForm">
                    <div style="display:grid;grid-template-columns:1fr 1fr 120px auto;gap:12px;align-items:end;">
                        <div>
                            <label style="display:block;font-size:0.75rem;font-weight:600;color:#065f46;margin-bottom:4px;">Email Address</label>
                            <input type="email" id="alertEmail" placeholder="your@email.com" style="width:100%;padding:10px 12px;border:2px solid #10b981;border-radius:8px;font-size:0.9rem;">
                        </div>
                        <div>
                            <label style="display:block;font-size:0.75rem;font-weight:600;color:#065f46;margin-bottom:4px;">Resort to Watch</label>
                            <select id="alertResort" style="width:100%;padding:10px 12px;border:2px solid #10b981;border-radius:8px;font-size:0.9rem;background:white;">
                                <option value="">Select Resort...</option>
                            </select>
                        </div>
                        <div>
                            <label style="display:block;font-size:0.75rem;font-weight:600;color:#065f46;margin-bottom:4px;">Price Threshold</label>
                            <input type="number" id="alertThreshold" placeholder="$350" style="width:100%;padding:10px 12px;border:2px solid #10b981;border-radius:8px;font-size:0.9rem;">
                        </div>
                        <button onclick="submitPriceAlert()" style="padding:10px 20px;background:#10b981;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;font-size:0.9rem;white-space:nowrap;">
                            ðŸ”” Set Alert
                        </button>
                    </div>
                    <div id="alertMessage" style="margin-top:12px;padding:10px;border-radius:8px;display:none;"></div>
                </div>
                <div style="margin-top:15px;display:flex;gap:20px;flex-wrap:wrap;">
                    <div style="font-size:0.75rem;color:#065f46;display:flex;align-items:center;gap:6px;">
                        <span style="font-size:1rem;">âœ“</span> Daily price checks
                    </div>
                    <div style="font-size:0.75rem;color:#065f46;display:flex;align-items:center;gap:6px;">
                        <span style="font-size:1rem;">âœ“</span> Instant notifications
                    </div>
                    <div style="font-size:0.75rem;color:#065f46;display:flex;align-items:center;gap:6px;">
                        <span style="font-size:1rem;">âœ“</span> Unsubscribe anytime
                    </div>
                </div>
            </div>

            <!-- Budget Summary -->
            <div class="budget-summary" id="budgetSummary">
                <h3>Trip Budget Summary</h3>
                <p style="opacity:0.8;margin-bottom:20px;">Select a resort above to calculate your total trip cost</p>
            </div>

            <!-- Comparison Panel -->
            <div style="margin-top:20px;background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">âš–ï¸</span> Quick Comparison: Top Picks for Your Group
                </h3>
                <div id="quickComparison" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:15px;">
                </div>
            </div>
            </div><!-- End budgetDetailedView -->
        </div>
    </div>

    <!-- Itinerary View -->
    <div class="view" id="view-itinerary">
        <div class="voting-container" style="max-width:1000px;margin:0 auto;padding:20px;">
            <div class="voting-header" style="margin-bottom:30px;">
                <h2>ðŸ—“ï¸ Trip Itinerary Planner</h2>
                <p>Plan activities for each day of your Cancun vacation</p>
            </div>

            <!-- Day Selector -->
            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:20px;" id="dayTabs">
                <!-- Tabs rendered by JS -->
            </div>

            <!-- Add Activity Form -->
            <div style="background:linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);border-radius:12px;padding:20px;margin-bottom:20px;border:2px solid #14b8a6;">
                <h3 style="margin-bottom:15px;color:#0f766e;">âž• Add Activity</h3>
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                    <div>
                        <label style="display:block;font-size:0.8rem;font-weight:600;color:#0f766e;margin-bottom:4px;">Time</label>
                        <select id="activityTime" style="width:100%;padding:10px;border:2px solid #14b8a6;border-radius:8px;">
                            <option value="morning">ðŸŒ… Morning (7-11am)</option>
                            <option value="midday">â˜€ï¸ Midday (11am-2pm)</option>
                            <option value="afternoon">ðŸŒ¤ï¸ Afternoon (2-5pm)</option>
                            <option value="evening">ðŸŒ™ Evening (5-8pm)</option>
                            <option value="night">ðŸŒƒ Night (8pm+)</option>
                        </select>
                    </div>
                    <div>
                        <label style="display:block;font-size:0.8rem;font-weight:600;color:#0f766e;margin-bottom:4px;">Category</label>
                        <select id="activityCategory" style="width:100%;padding:10px;border:2px solid #14b8a6;border-radius:8px;">
                            <option value="excursion">ðŸ›ï¸ Excursion/Tour</option>
                            <option value="beach">ðŸ–ï¸ Beach Day</option>
                            <option value="pool">ðŸŠ Pool Time</option>
                            <option value="dining">ðŸ½ï¸ Dining</option>
                            <option value="shopping">ðŸ›ï¸ Shopping</option>
                            <option value="spa">ðŸ’† Spa/Relaxation</option>
                            <option value="adventure">ðŸ¤¿ Adventure/Water Sports</option>
                            <option value="family">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Family Activity</option>
                        </select>
                    </div>
                </div>
                <div style="margin-top:15px;">
                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#0f766e;margin-bottom:4px;">Activity Title</label>
                    <input type="text" id="activityTitle" placeholder="e.g., Chichen Itza Tour, Snorkeling at Isla Mujeres..." style="width:100%;padding:10px;border:2px solid #14b8a6;border-radius:8px;box-sizing:border-box;">
                </div>
                <div style="margin-top:15px;">
                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#0f766e;margin-bottom:4px;">Notes (optional)</label>
                    <input type="text" id="activityNotes" placeholder="Booking info, tips, who's participating..." style="width:100%;padding:10px;border:2px solid #14b8a6;border-radius:8px;box-sizing:border-box;">
                </div>
                <div style="display:flex;gap:15px;margin-top:15px;">
                    <div style="flex:1;">
                        <label style="display:block;font-size:0.8rem;font-weight:600;color:#0f766e;margin-bottom:4px;">Est. Cost (total)</label>
                        <input type="number" id="activityCost" placeholder="$0" style="width:100%;padding:10px;border:2px solid #14b8a6;border-radius:8px;box-sizing:border-box;">
                    </div>
                    <button onclick="addItineraryItem()" style="padding:10px 24px;background:linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;align-self:end;">
                        Add Activity
                    </button>
                </div>
            </div>

            <!-- Day Schedule -->
            <div id="daySchedule" style="background:white;border-radius:16px;padding:20px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <!-- Schedule rendered by JS -->
            </div>

            <!-- Trip Summary -->
            <div style="margin-top:20px;background:linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);border-radius:16px;padding:20px;color:white;">
                <h3 style="margin-bottom:15px;">ðŸ“Š Trip Summary</h3>
                <div id="itinerarySummary" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:15px;">
                    <!-- Summary rendered by JS -->
                </div>
            </div>
        </div>
    </div>

    <!-- Group Coordination View -->
    <div class="view" id="view-group">
        <div class="voting-container" style="max-width:1400px;margin:0 auto;padding:20px;">
            <div class="voting-header" style="margin-bottom:30px;">
                <h2>ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Group Coordination</h2>
                <p>Keep everyone organized - flights, rooms, contacts, and expenses</p>
            </div>

            <!-- Quick Stats -->
            <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:15px;margin-bottom:24px;">
                <div style="background:linear-gradient(135deg, #0891b2 0%, #06b6d4 100%);color:white;padding:20px;border-radius:12px;text-align:center;">
                    <div style="font-size:2rem;font-weight:700;">14</div>
                    <div style="font-size:0.85rem;opacity:0.9;">Travelers</div>
                </div>
                <div style="background:linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);color:white;padding:20px;border-radius:12px;text-align:center;">
                    <div style="font-size:2rem;font-weight:700;">4</div>
                    <div style="font-size:0.85rem;opacity:0.9;">Family Groups</div>
                </div>
                <div style="background:linear-gradient(135deg, #10b981 0%, #34d399 100%);color:white;padding:20px;border-radius:12px;text-align:center;">
                    <div style="font-size:2rem;font-weight:700;">7</div>
                    <div style="font-size:0.85rem;opacity:0.9;">Rooms Needed</div>
                </div>
                <div style="background:linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);color:white;padding:20px;border-radius:12px;text-align:center;">
                    <div style="font-size:2rem;font-weight:700;">4</div>
                    <div style="font-size:0.85rem;opacity:0.9;">Departure Cities</div>
                </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                <!-- Left Column -->
                <div>
                    <!-- Flight Tracker -->
                    <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);margin-bottom:24px;">
                        <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                            <span style="font-size:1.5rem;">âœˆï¸</span> Flight Tracker
                            <button onclick="checkAllFlightStatus()" style="margin-left:auto;padding:6px 12px;background:#0891b2;color:white;border:none;border-radius:6px;font-size:0.8rem;cursor:pointer;">Check Status</button>
                        </h3>
                        <div id="flightTracker">
                            <!-- Rendered by JS -->
                        </div>
                        <div style="margin-top:15px;padding:12px;background:#f0f9ff;border-radius:8px;font-size:0.85rem;color:#0369a1;">
                            ðŸ’¡ Click "Check Status" on travel day to see real-time flight info
                        </div>
                    </div>

                    <!-- Room Assignments -->
                    <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                        <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                            <span style="font-size:1.5rem;">ðŸ›ï¸</span> Room Assignments
                        </h3>
                        <div id="roomAssignments">
                            <!-- Rendered by JS -->
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <!-- Contact Cards -->
                    <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);margin-bottom:24px;">
                        <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                            <span style="font-size:1.5rem;">ðŸ“±</span> Family Contacts
                            <button onclick="copyAllContacts()" style="margin-left:auto;padding:6px 12px;background:#10b981;color:white;border:none;border-radius:6px;font-size:0.8rem;cursor:pointer;">Copy All</button>
                        </h3>
                        <div id="contactCards" style="display:grid;gap:10px;">
                            <!-- Rendered by JS -->
                        </div>
                    </div>

                    <!-- Quick Links -->
                    <div style="background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border-radius:16px;padding:24px;border:2px solid #f59e0b;">
                        <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;color:#92400e;">
                            <span style="font-size:1.5rem;">ðŸ”—</span> Group Chat & Sharing
                        </h3>
                        <div style="display:grid;gap:10px;">
                            <a href="#" onclick="createWhatsAppGroup()" style="display:flex;align-items:center;gap:10px;padding:12px;background:white;border-radius:8px;text-decoration:none;color:#1e293b;">
                                <span style="font-size:1.5rem;">ðŸ’¬</span>
                                <div>
                                    <div style="font-weight:600;">WhatsApp Group</div>
                                    <div style="font-size:0.8rem;color:#64748b;">Create group chat link</div>
                                </div>
                            </a>
                            <a href="#" onclick="sharePhotoAlbum()" style="display:flex;align-items:center;gap:10px;padding:12px;background:white;border-radius:8px;text-decoration:none;color:#1e293b;">
                                <span style="font-size:1.5rem;">ðŸ“¸</span>
                                <div>
                                    <div style="font-weight:600;">Shared Photo Album</div>
                                    <div style="font-size:0.8rem;color:#64748b;">Create Google Photos / iCloud album</div>
                                </div>
                            </a>
                            <a href="#" onclick="shareCalendar()" style="display:flex;align-items:center;gap:10px;padding:12px;background:white;border-radius:8px;text-decoration:none;color:#1e293b;">
                                <span style="font-size:1.5rem;">ðŸ“…</span>
                                <div>
                                    <div style="font-weight:600;">Shared Calendar</div>
                                    <div style="font-size:0.8rem;color:#64748b;">Add trip to everyone's calendar</div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Expense Splitter -->
            <div style="margin-top:24px;background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">ðŸ’°</span> Expense Splitter
                    <span style="margin-left:auto;font-size:0.9rem;color:#64748b;">Track shared costs and settle up</span>
                </h3>

                <div style="display:grid;grid-template-columns:2fr 1fr;gap:24px;">
                    <!-- Add Expense Form -->
                    <div>
                        <div style="background:#f8fafc;border-radius:12px;padding:20px;margin-bottom:20px;">
                            <h4 style="margin-bottom:15px;color:#1e293b;">Add Shared Expense</h4>
                            <div style="display:grid;grid-template-columns:2fr 1fr 1fr;gap:12px;">
                                <div>
                                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#64748b;margin-bottom:4px;">Description</label>
                                    <input type="text" id="expenseDesc" placeholder="e.g., Xcaret tickets for everyone" style="width:100%;padding:10px;border:2px solid #e2e8f0;border-radius:8px;">
                                </div>
                                <div>
                                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#64748b;margin-bottom:4px;">Amount ($)</label>
                                    <input type="number" id="expenseAmount" placeholder="500" style="width:100%;padding:10px;border:2px solid #e2e8f0;border-radius:8px;">
                                </div>
                                <div>
                                    <label style="display:block;font-size:0.8rem;font-weight:600;color:#64748b;margin-bottom:4px;">Paid By</label>
                                    <select id="expensePaidBy" style="width:100%;padding:10px;border:2px solid #e2e8f0;border-radius:8px;">
                                        <option value="alex">Alex's Family</option>
                                        <option value="parents">Mom & Dad</option>
                                        <option value="becketts">Becketts</option>
                                        <option value="dann">Dann & Husband</option>
                                    </select>
                                </div>
                            </div>
                            <div style="margin-top:12px;">
                                <label style="display:block;font-size:0.8rem;font-weight:600;color:#64748b;margin-bottom:4px;">Split Between</label>
                                <div style="display:flex;flex-wrap:wrap;gap:8px;">
                                    <label style="display:flex;align-items:center;gap:4px;padding:6px 10px;background:white;border-radius:6px;cursor:pointer;border:1px solid #e2e8f0;">
                                        <input type="checkbox" class="expenseSplit" value="alex" checked> Alex (4)
                                    </label>
                                    <label style="display:flex;align-items:center;gap:4px;padding:6px 10px;background:white;border-radius:6px;cursor:pointer;border:1px solid #e2e8f0;">
                                        <input type="checkbox" class="expenseSplit" value="parents" checked> Parents (3)
                                    </label>
                                    <label style="display:flex;align-items:center;gap:4px;padding:6px 10px;background:white;border-radius:6px;cursor:pointer;border:1px solid #e2e8f0;">
                                        <input type="checkbox" class="expenseSplit" value="becketts" checked> Becketts (5)
                                    </label>
                                    <label style="display:flex;align-items:center;gap:4px;padding:6px 10px;background:white;border-radius:6px;cursor:pointer;border:1px solid #e2e8f0;">
                                        <input type="checkbox" class="expenseSplit" value="dann" checked> Dann (2)
                                    </label>
                                </div>
                            </div>
                            <button onclick="addExpense()" style="margin-top:15px;padding:10px 20px;background:#10b981;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;">
                                + Add Expense
                            </button>
                        </div>

                        <!-- Expense List -->
                        <div id="expenseList">
                            <!-- Rendered by JS -->
                        </div>
                    </div>

                    <!-- Settlement Summary -->
                    <div>
                        <div style="background:linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);border-radius:12px;padding:20px;border:2px solid #10b981;">
                            <h4 style="margin-bottom:15px;color:#065f46;display:flex;align-items:center;gap:8px;">
                                <span>âš–ï¸</span> Settlement Summary
                            </h4>
                            <div id="settlementSummary" style="display:grid;gap:10px;">
                                <!-- Rendered by JS -->
                            </div>
                            <button onclick="copySettlement()" style="margin-top:15px;width:100%;padding:10px;background:#10b981;color:white;border:none;border-radius:8px;font-weight:600;cursor:pointer;">
                                ðŸ“‹ Copy Settlement Details
                            </button>
                        </div>

                        <div style="margin-top:15px;padding:15px;background:#f8fafc;border-radius:12px;">
                            <h4 style="margin-bottom:10px;color:#1e293b;font-size:0.9rem;">Payment Options</h4>
                            <div style="display:grid;gap:8px;font-size:0.85rem;">
                                <a href="https://venmo.com" target="_blank" style="display:flex;align-items:center;gap:8px;color:#0891b2;text-decoration:none;">
                                    ðŸ’³ Venmo
                                </a>
                                <a href="https://paypal.com" target="_blank" style="display:flex;align-items:center;gap:8px;color:#0891b2;text-decoration:none;">
                                    ðŸ’³ PayPal
                                </a>
                                <a href="https://cash.app" target="_blank" style="display:flex;align-items:center;gap:8px;color:#0891b2;text-decoration:none;">
                                    ðŸ’³ Cash App
                                </a>
                                <a href="https://www.zelle.com" target="_blank" style="display:flex;align-items:center;gap:8px;color:#0891b2;text-decoration:none;">
                                    ðŸ’³ Zelle
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Travel Day Section -->
            <div style="margin-top:24px;background:linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);border-radius:16px;padding:24px;border:2px solid #fca5a5;">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;color:#991b1b;">
                    <span style="font-size:1.5rem;">ðŸ›«</span> Travel Day Toolkit
                </h3>

                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:20px;">
                    <!-- TSA Wait Times -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#991b1b;margin-bottom:12px;">â±ï¸ TSA Wait Times</h4>
                        <div style="display:grid;gap:8px;font-size:0.9rem;">
                            <a href="https://www.tsa.gov/travel/passenger-support" target="_blank" style="display:flex;justify-content:space-between;padding:8px;background:#fef2f2;border-radius:6px;text-decoration:none;color:#1e293b;">
                                <span>DSM - Des Moines</span>
                                <span style="color:#0891b2;">Check â†’</span>
                            </a>
                            <a href="https://www.tsa.gov/travel/passenger-support" target="_blank" style="display:flex;justify-content:space-between;padding:8px;background:#fef2f2;border-radius:6px;text-decoration:none;color:#1e293b;">
                                <span>CID - Cedar Rapids</span>
                                <span style="color:#0891b2;">Check â†’</span>
                            </a>
                            <a href="https://www.tsa.gov/travel/passenger-support" target="_blank" style="display:flex;justify-content:space-between;padding:8px;background:#fef2f2;border-radius:6px;text-decoration:none;color:#1e293b;">
                                <span>OMA - Omaha</span>
                                <span style="color:#0891b2;">Check â†’</span>
                            </a>
                            <a href="https://www.tsa.gov/travel/passenger-support" target="_blank" style="display:flex;justify-content:space-between;padding:8px;background:#fef2f2;border-radius:6px;text-decoration:none;color:#1e293b;">
                                <span>MCO - Orlando</span>
                                <span style="color:#0891b2;">Check â†’</span>
                            </a>
                        </div>
                    </div>

                    <!-- Cancun Arrival Guide -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#991b1b;margin-bottom:12px;">ðŸ›¬ Cancun Arrival</h4>
                        <div style="display:grid;gap:8px;font-size:0.85rem;color:#475569;">
                            <div><strong>1. Immigration</strong> - Have passport & tourist card ready (given on plane)</div>
                            <div><strong>2. Baggage</strong> - Claim at Terminal 3 or 4</div>
                            <div><strong>3. Customs</strong> - Press button: Green = go, Red = inspection</div>
                            <div><strong>4. Exit</strong> - Ignore timeshare people! Go straight to transfer</div>
                            <div><strong>5. Transfer</strong> - Look for driver with your name</div>
                        </div>
                    </div>

                    <!-- What to Have Ready -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#991b1b;margin-bottom:12px;">ðŸ“‹ Keep Accessible</h4>
                        <div style="display:grid;gap:6px;font-size:0.85rem;">
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Passport
                            </div>
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Boarding pass (phone OK)
                            </div>
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Hotel confirmation
                            </div>
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Transfer voucher
                            </div>
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Pen (for customs form)
                            </div>
                            <div style="display:flex;align-items:center;gap:8px;">
                                <span style="color:#10b981;">âœ“</span> Small bills for tips
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medical Spanish -->
            <div style="margin-top:24px;background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">ðŸ¥</span> Medical Spanish Phrases
                </h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:15px;font-size:0.9rem;">
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">I need a doctor</div>
                        <div style="color:#1e293b;">Necesito un mÃ©dico</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">I'm allergic to...</div>
                        <div style="color:#1e293b;">Soy alÃ©rgico/a a...</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">It hurts here</div>
                        <div style="color:#1e293b;">Me duele aquÃ­</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">I have a fever</div>
                        <div style="color:#1e293b;">Tengo fiebre</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">Where is the pharmacy?</div>
                        <div style="color:#1e293b;">Â¿DÃ³nde estÃ¡ la farmacia?</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">Call an ambulance</div>
                        <div style="color:#1e293b;">Llame una ambulancia</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">I have diabetes</div>
                        <div style="color:#1e293b;">Tengo diabetes</div>
                    </div>
                    <div style="padding:12px;background:#fef2f2;border-radius:8px;">
                        <div style="color:#991b1b;font-weight:600;">Medicine for pain</div>
                        <div style="color:#1e293b;">Medicina para el dolor</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Prep & Pack View -->
    <div class="view" id="view-prep">
        <div class="voting-container" style="max-width:1200px;margin:0 auto;padding:20px;">
            <div class="voting-header" style="margin-bottom:30px;">
                <h2>ðŸ§³ Trip Preparation & Packing</h2>
                <p>Everything you need to get ready for Cancun</p>
            </div>

            <!-- Progress Overview -->
            <div style="background:linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);border-radius:16px;padding:24px;color:white;margin-bottom:24px;">
                <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px;">
                    <div>
                        <h3 style="margin-bottom:8px;">Trip Countdown</h3>
                        <div id="tripCountdown" style="font-size:2rem;font-weight:700;">Loading...</div>
                    </div>
                    <div style="text-align:right;">
                        <div style="font-size:0.9rem;opacity:0.9;">Preparation Progress</div>
                        <div style="display:flex;align-items:center;gap:10px;margin-top:8px;">
                            <div style="width:200px;height:12px;background:rgba(255,255,255,0.2);border-radius:6px;overflow:hidden;">
                                <div id="prepProgressBar" style="height:100%;background:white;border-radius:6px;transition:width 0.3s;width:0%;"></div>
                            </div>
                            <span id="prepProgressText" style="font-weight:600;">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px;">
                <!-- Left Column: Trip Prep Checklist -->
                <div>
                    <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);margin-bottom:24px;">
                        <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                            <span style="font-size:1.5rem;">ðŸ“‹</span> Trip Preparation Checklist
                        </h3>
                        <div id="prepChecklist">
                            <!-- Rendered by JS -->
                        </div>
                    </div>

                    <!-- Emergency Contacts -->
                    <div style="background:linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);border-radius:16px;padding:24px;border:2px solid #fca5a5;">
                        <h3 style="margin-bottom:15px;color:#991b1b;display:flex;align-items:center;gap:10px;">
                            <span style="font-size:1.5rem;">ðŸ†˜</span> Emergency Contacts
                        </h3>
                        <div style="display:grid;gap:12px;font-size:0.9rem;">
                            <div style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;">
                                <span style="font-weight:600;">US Embassy (Merida)</span>
                                <a href="tel:+529999420500" style="color:#0891b2;">+52 999 942 0500</a>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;">
                                <span style="font-weight:600;">Tourist Police</span>
                                <a href="tel:911" style="color:#0891b2;">911</a>
                            </div>
                            <div style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;">
                                <span style="font-weight:600;">Hospiten Cancun (Hospital)</span>
                                <a href="tel:+529988817777" style="color:#0891b2;">+52 998 881 7777</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Packing List -->
                <div>
                    <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                            <h3 style="display:flex;align-items:center;gap:10px;">
                                <span style="font-size:1.5rem;">ðŸŽ’</span> Packing List
                            </h3>
                            <div style="display:flex;gap:8px;">
                                <button onclick="resetPackingList()" style="padding:6px 12px;border:1px solid #e2e8f0;background:white;border-radius:6px;font-size:0.8rem;cursor:pointer;">Reset</button>
                                <button onclick="printPackingList()" style="padding:6px 12px;border:none;background:#0891b2;color:white;border-radius:6px;font-size:0.8rem;cursor:pointer;">ðŸ–¨ï¸ Print</button>
                            </div>
                        </div>

                        <div id="packingList">
                            <!-- Rendered by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Practical Info Section -->
            <div style="margin-top:24px;display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px;">
                <!-- Currency & Tipping -->
                <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                    <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.5rem;">ðŸ’µ</span> Currency & Tipping
                    </h3>
                    <div style="display:grid;gap:12px;font-size:0.9rem;">
                        <div style="padding:12px;background:#f0fdf4;border-radius:8px;">
                            <div style="font-weight:600;color:#065f46;">Current Exchange Rate</div>
                            <div style="font-size:1.3rem;font-weight:700;color:#059669;">1 USD â‰ˆ 17.2 MXN</div>
                            <div style="font-size:0.75rem;color:#047857;">Most places accept USD</div>
                        </div>
                        <div>
                            <div style="font-weight:600;margin-bottom:8px;">Tipping Guide:</div>
                            <div style="display:grid;gap:6px;color:#475569;">
                                <div>â€¢ Restaurants: 15-20%</div>
                                <div>â€¢ Bellhops: $1-2 per bag</div>
                                <div>â€¢ Housekeeping: $2-5/day</div>
                                <div>â€¢ Tour guides: $5-10/person</div>
                                <div>â€¢ Bartenders: $1-2/drink</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Weather -->
                <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                    <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.5rem;">ðŸŒ¤ï¸</span> May Weather in Cancun
                    </h3>
                    <div style="display:grid;gap:12px;font-size:0.9rem;">
                        <div style="display:flex;justify-content:space-around;text-align:center;">
                            <div>
                                <div style="font-size:2rem;">ðŸŒ¡ï¸</div>
                                <div style="font-weight:600;">82-90Â°F</div>
                                <div style="font-size:0.8rem;color:#64748b;">High</div>
                            </div>
                            <div>
                                <div style="font-size:2rem;">ðŸ’§</div>
                                <div style="font-weight:600;">75-80%</div>
                                <div style="font-size:0.8rem;color:#64748b;">Humidity</div>
                            </div>
                            <div>
                                <div style="font-size:2rem;">ðŸŒ§ï¸</div>
                                <div style="font-weight:600;">8 days</div>
                                <div style="font-size:0.8rem;color:#64748b;">Rainy</div>
                            </div>
                        </div>
                        <div style="padding:12px;background:#fef3c7;border-radius:8px;color:#92400e;font-size:0.85rem;">
                            â˜€ï¸ May is hot & humid. Brief afternoon showers are common. Pack light, breathable clothing!
                        </div>
                    </div>
                </div>

                <!-- Spanish Phrases -->
                <div style="background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                    <h3 style="margin-bottom:15px;display:flex;align-items:center;gap:10px;">
                        <span style="font-size:1.5rem;">ðŸ—£ï¸</span> Helpful Spanish
                    </h3>
                    <div style="display:grid;gap:8px;font-size:0.85rem;">
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>Hello</span><span style="font-weight:600;">Hola</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>Thank you</span><span style="font-weight:600;">Gracias</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>Please</span><span style="font-weight:600;">Por favor</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>How much?</span><span style="font-weight:600;">Â¿CuÃ¡nto cuesta?</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>Where is...?</span><span style="font-weight:600;">Â¿DÃ³nde estÃ¡...?</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>The bill, please</span><span style="font-weight:600;">La cuenta, por favor</span>
                        </div>
                        <div style="display:flex;justify-content:space-between;padding:8px;background:#f1f5f9;border-radius:6px;">
                            <span>Cheers!</span><span style="font-weight:600;">Â¡Salud!</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Travel Insurance Section -->
            <div style="margin-top:24px;background:linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);border-radius:16px;padding:24px;border:2px solid #3b82f6;">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;color:#1e40af;">
                    <span style="font-size:1.5rem;">ðŸ›¡ï¸</span> Travel Insurance Guide
                </h3>

                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));gap:20px;">
                    <!-- Why You Need It -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#1e40af;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
                            <span>â“</span> Why Get Travel Insurance?
                        </h4>
                        <ul style="display:grid;gap:8px;font-size:0.9rem;color:#475569;padding-left:20px;">
                            <li><strong>Medical emergencies abroad</strong> - US health insurance often doesn't cover Mexico</li>
                            <li><strong>Trip cancellation</strong> - Get refunded if you can't go</li>
                            <li><strong>Lost/delayed luggage</strong> - Coverage for essentials</li>
                            <li><strong>Flight delays</strong> - Hotel/meal reimbursement</li>
                            <li><strong>Emergency evacuation</strong> - Can cost $50,000+ without insurance</li>
                        </ul>
                    </div>

                    <!-- Recommendations -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#1e40af;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
                            <span>â­</span> Top Recommendations
                        </h4>
                        <div style="display:grid;gap:10px;font-size:0.9rem;">
                            <a href="https://www.travelinsurance.com" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f0f9ff;border-radius:8px;text-decoration:none;color:#1e40af;border:1px solid #bfdbfe;">
                                <span style="font-weight:600;">World Nomads</span>
                                <span style="font-size:0.8rem;color:#64748b;">Good for activities</span>
                            </a>
                            <a href="https://www.allianztravel.com" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f0f9ff;border-radius:8px;text-decoration:none;color:#1e40af;border:1px solid #bfdbfe;">
                                <span style="font-weight:600;">Allianz Travel</span>
                                <span style="font-size:0.8rem;color:#64748b;">Comprehensive plans</span>
                            </a>
                            <a href="https://www.squaremouth.com" target="_blank" style="display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f0f9ff;border-radius:8px;text-decoration:none;color:#1e40af;border:1px solid #bfdbfe;">
                                <span style="font-weight:600;">SquareMouth</span>
                                <span style="font-size:0.8rem;color:#64748b;">Compare policies</span>
                            </a>
                        </div>
                    </div>

                    <!-- Best Practices -->
                    <div style="background:white;border-radius:12px;padding:20px;">
                        <h4 style="color:#1e40af;margin-bottom:12px;display:flex;align-items:center;gap:8px;">
                            <span>âœ…</span> Best Practices
                        </h4>
                        <div style="display:grid;gap:8px;font-size:0.9rem;color:#475569;">
                            <div style="display:flex;gap:8px;align-items:start;">
                                <span style="color:#10b981;">âœ“</span>
                                <span><strong>Buy within 14 days of booking</strong> to get pre-existing condition coverage</span>
                            </div>
                            <div style="display:flex;gap:8px;align-items:start;">
                                <span style="color:#10b981;">âœ“</span>
                                <span><strong>Check credit card benefits</strong> - some cards include travel insurance</span>
                            </div>
                            <div style="display:flex;gap:8px;align-items:start;">
                                <span style="color:#10b981;">âœ“</span>
                                <span><strong>Get "Cancel for Any Reason"</strong> for maximum flexibility (costs more)</span>
                            </div>
                            <div style="display:flex;gap:8px;align-items:start;">
                                <span style="color:#10b981;">âœ“</span>
                                <span><strong>Keep receipts</strong> for any expenses you may need to claim</span>
                            </div>
                            <div style="display:flex;gap:8px;align-items:start;">
                                <span style="color:#f59e0b;">âš ï¸</span>
                                <span><strong>Skip airline insurance</strong> - it's usually overpriced and limited</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top:16px;padding:12px;background:white;border-radius:8px;font-size:0.85rem;color:#1e40af;">
                    ðŸ’¡ <strong>Pro tip:</strong> For a family of 14, expect to pay roughly $50-150 per person for comprehensive coverage. That's about $700-2,100 total for peace of mind on a $22K+ trip.
                </div>
            </div>

            <!-- Resort Amenities Comparison -->
            <div style="margin-top:24px;background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">ðŸ¨</span> Resort Amenities Comparison
                </h3>
                <p style="color:#64748b;margin-bottom:20px;font-size:0.9rem;">Compare what's included at each resort so you know what to pack and what to expect.</p>
                <div style="overflow-x:auto;">
                    <table id="amenitiesTable" style="width:100%;border-collapse:collapse;font-size:0.85rem;">
                        <thead>
                            <tr style="background:#f8fafc;">
                                <th style="padding:12px;text-align:left;border-bottom:2px solid #e2e8f0;">Resort</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Kids Club</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Water Park</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Spa</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Beach</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Pool(s)</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Restaurants</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">Wheelchair</th>
                                <th style="padding:12px;text-align:center;border-bottom:2px solid #e2e8f0;">WiFi</th>
                            </tr>
                        </thead>
                        <tbody id="amenitiesBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Side-by-Side Comparison Panel -->
    <div class="comparison-panel" id="comparisonPanel">
        <div class="comparison-header">
            <h3>Comparing <span id="compareCount">0</span> Resorts</h3>
            <button onclick="clearComparison()" style="background:rgba(255,255,255,0.2);border:none;color:white;padding:8px 16px;border-radius:6px;cursor:pointer;">Clear All</button>
        </div>
        <div class="comparison-grid" id="comparisonGrid"></div>
        <div class="comparison-actions" id="comparisonActions" style="display:none;">
            <button class="share-btn" onclick="shareComparison()">ðŸ“¤ Share Link</button>
            <button class="copy-btn" onclick="copyComparisonText()">ðŸ“‹ Copy Summary</button>
        </div>
    </div>
    <div class="share-toast" id="shareToast">Link copied to clipboard!</div>

    <!-- Attraction Detail Modal -->
    <div class="attraction-modal" id="attractionModal">
        <div class="attraction-modal-content">
            <div class="attraction-modal-header" id="attractionModalHeader">
                <button class="modal-close-btn" onclick="closeAttractionModal()">&times;</button>
                <div style="font-size:2.5rem;margin-bottom:10px;" id="modalAttractionIcon"></div>
                <h2 id="modalAttractionName"></h2>
                <div style="opacity:0.9;font-size:0.9rem;" id="modalAttractionType"></div>
            </div>
            <div class="attraction-modal-body">
                <div class="attraction-detail-section">
                    <div style="display:flex;gap:20px;flex-wrap:wrap;margin-bottom:15px;">
                        <div style="display:flex;align-items:center;gap:6px;">
                            <span style="color:#f59e0b;font-size:1.2rem;">â˜…</span>
                            <span id="modalRating" style="font-weight:700;"></span>
                            <span id="modalReviewCount" style="color:#64748b;font-size:0.85rem;"></span>
                        </div>
                        <div id="modalPriceRange" style="font-weight:600;color:#059669;"></div>
                        <div id="modalDuration" style="color:#64748b;"></div>
                    </div>
                    <p id="modalDescription" style="color:#475569;line-height:1.6;"></p>
                </div>

                <div class="attraction-detail-section">
                    <h4><span>âœ¨</span> Highlights</h4>
                    <div class="attraction-highlights" id="modalHighlights"></div>
                </div>

                <div class="attraction-detail-section" id="modalIncludedSection">
                    <h4><span>âœ…</span> What's Included</h4>
                    <div id="modalIncluded" style="color:#475569;font-size:0.9rem;"></div>
                </div>

                <div class="attraction-detail-section" id="modalNotIncludedSection">
                    <h4><span>âŒ</span> Not Included</h4>
                    <div id="modalNotIncluded" style="color:#475569;font-size:0.9rem;"></div>
                </div>

                <div class="attraction-detail-section">
                    <h4><span>ðŸ’¡</span> Tips</h4>
                    <p id="modalTips" style="color:#475569;font-size:0.9rem;background:#fef3c7;padding:12px;border-radius:8px;"></p>
                </div>

                <div class="attraction-detail-section">
                    <h4><span>ðŸ“</span> Location & Hours</h4>
                    <div style="display:grid;gap:8px;font-size:0.9rem;color:#475569;">
                        <div><strong>Area:</strong> <span id="modalArea"></span></div>
                        <div><strong>Hours:</strong> <span id="modalHours"></span></div>
                        <div id="modalAccessibility"></div>
                        <div id="modalKidFriendly"></div>
                    </div>
                </div>

                <div class="attraction-detail-section">
                    <h4><span>ðŸ“‹</span> Source & Verification</h4>
                    <div class="attraction-source" id="modalSource"></div>
                </div>

                <div class="attraction-actions">
                    <a id="modalBookingBtn" href="#" target="_blank" class="attraction-btn attraction-btn-primary">
                        Book Now / Official Site
                    </a>
                    <a id="modalSourceBtn" href="#" target="_blank" class="attraction-btn attraction-btn-secondary">
                        View Reviews
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Attraction Modal -->
    <div class="attraction-modal" id="addAttractionModal">
        <div class="attraction-modal-content">
            <div class="attraction-modal-header" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%);">
                <button class="modal-close-btn" onclick="closeAddAttractionModal()">&times;</button>
                <div style="font-size:2rem;margin-bottom:10px;">âž•</div>
                <h2>Suggest a Place</h2>
                <div style="opacity:0.9;font-size:0.9rem;">Add a restaurant, activity, or attraction for the family</div>
            </div>
            <div class="add-modal-form">
                <div class="form-row">
                    <label>Name *</label>
                    <input type="text" id="addAttractionName" placeholder="e.g., Tacos Rigo" required>
                </div>
                <div class="form-row-inline">
                    <div class="form-row">
                        <label>Category *</label>
                        <select id="addAttractionCategory">
                            <option value="restaurant">ðŸ½ï¸ Restaurant</option>
                            <option value="eco-park">ðŸŒ¿ Eco-Park</option>
                            <option value="ruins">ðŸ›ï¸ Ruins</option>
                            <option value="cenote">ðŸ’§ Cenote</option>
                            <option value="island">ðŸï¸ Island</option>
                            <option value="water-activity">ðŸ¤¿ Water Activity</option>
                            <option value="shopping">ðŸ›ï¸ Shopping</option>
                            <option value="family">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Family Fun</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Area *</label>
                        <select id="addAttractionArea">
                            <option value="cancun">Cancun</option>
                            <option value="riviera">Riviera Maya</option>
                            <option value="tulum">Tulum</option>
                            <option value="costa">Costa Mujeres</option>
                            <option value="inland">Inland</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <label>Description</label>
                    <textarea id="addAttractionDescription" rows="3" placeholder="What makes this place special?"></textarea>
                </div>
                <div class="form-row-inline">
                    <div class="form-row">
                        <label>Estimated Price (per person)</label>
                        <input type="number" id="addAttractionPrice" placeholder="e.g., 50">
                    </div>
                    <div class="form-row">
                        <label>Website / Link</label>
                        <input type="url" id="addAttractionWebsite" placeholder="https://...">
                    </div>
                </div>
                <div class="form-row">
                    <label>Why are you recommending this?</label>
                    <input type="text" id="addAttractionReason" placeholder="e.g., Best tacos in Cancun!">
                </div>
                <div class="form-row">
                    <label>
                        <input type="checkbox" id="addAttractionKidFriendly" checked> Kid-friendly
                    </label>
                </div>
                <div class="attraction-actions">
                    <button onclick="closeAddAttractionModal()" class="attraction-btn attraction-btn-secondary">Cancel</button>
                    <button onclick="submitNewAttraction()" class="attraction-btn attraction-btn-primary" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        Add Suggestion
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Comprehensive Resort Database
        const resorts = [
            // CANCUN HOTEL ZONE
            {
                id: 1,
                name: "Hyatt Ziva Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0892,
                lng: -86.7720,
                airportDist: "25 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 12500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hyatt",
                pointsCost: "25,000-50,000/night",
                website: "https://www.hyatt.com/en-US/hotel/mexico/hyatt-ziva-cancun/cunif",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d152887-Reviews-Hyatt_Ziva_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Turquoize adults tower", "Kids club", "Swim-up suites", "World of Hyatt"],
                notes: "Has adults-only Turquoize tower within resort - great for grandparents wanting quiet",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2023 (partial)",
                serviceRating: "Excellent",
                insiderTip: "CAUTION: Main building renovation ongoing - no main buffet currently. Reddit users report food quality dropped. Turquoize tower is adults-only oasis WITHIN resort - perfect split for your group! Points value ~$425/night = good redemption at 25k points.",
                crowdLevel: "Medium-High"
            },
            {
                id: 2,
                name: "Hard Rock Hotel Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0998,
                lng: -86.7634,
                airportDist: "20 min",
                priceMay24: 320,
                priceMay31: 360,
                rating: 4.4,
                reviews: 9800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.hardrockhotels.com/cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d1022636-Reviews-Hard_Rock_Hotel_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Best accessibility", "Ramps everywhere", "Rock Star suites", "Water park"],
                notes: "HIGHLY recommended for mobility - ramps to beach and pool, wheelchair accessible throughout",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "TOP PICK FOR YOUR GROUP! Reddit unanimously recommends for wheelchair users - ramps to beach AND pool, golf carts available. Staff very accommodating with mobility needs. Great value at $320/night. Water park keeps kids busy while grandparents relax.",
                crowdLevel: "Medium"
            },
            {
                id: 3,
                name: "Moon Palace Cancun",
                area: "cancun",
                areaName: "Cancun (South)",
                lat: 20.9847,
                lng: -86.8318,
                airportDist: "15 min",
                priceMay24: 350,
                priceMay31: 400,
                rating: 4.5,
                reviews: 28000,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.moonpalacecancun.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155263-Reviews-Moon_Palace_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Massive resort", "FlowRider", "Waterpark", "Golf", "Resort credits"],
                notes: "Huge property - lots of walking. Great for active families, may be tiring for elderly",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2018",
                serviceRating: "Mixed",
                insiderTip: "WARNING: Reddit reviews are VERY mixed. 'Not worth the price' is common complaint. High season = overcrowded, buffet lines long. Beach is reportedly 'non-usable'. Great waterpark but NOT recommended for honeymoons or quiet getaways. Consider Grand for better experience.",
                crowdLevel: "Very High"
            },
            {
                id: 4,
                name: "Grand Fiesta Americana Coral Beach",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.1303,
                lng: -86.7462,
                airportDist: "30 min",
                priceMay24: 480,
                priceMay31: 520,
                rating: 4.7,
                reviews: 6200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.fiestamericanagrand.com/en/coral-beach-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d154435-Reviews-Grand_Fiesta_Americana_Coral_Beach_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["AAA Five Diamond", "Gem Spa", "Butler service", "Premium location"],
                notes: "Luxury option with excellent service. Good accessibility.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2022",
                serviceRating: "Outstanding",
                insiderTip: "REDDIT FAVORITE! 97 upvotes on review saying 'we loved it'. Staff know guests by name. Spacious layout means less crowded than neighbors. Perfect for families who want quality over activities. Frequent travelers' go-to at $500-600/night. Live music excellent!",
                crowdLevel: "Low-Medium"
            },
            {
                id: 5,
                name: "Club Med Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0736,
                lng: -86.7832,
                airportDist: "25 min",
                priceMay24: 400,
                priceMay31: 450,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.clubmed.us/r/cancun/y",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d154474-Reviews-Club_Med_Cancun_Yucatan-Cancun_Yucatan_Peninsula.html",
                features: ["Kids clubs 0-17", "Circus school", "Trapeze", "All activities included"],
                notes: "Excellent for multigenerational - dedicated kids clubs for all ages",
                valueScore: 7,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "Unique all-inclusive concept with circus school & trapeze! Kids LOVE it. However, showing age in some areas. All activities truly included (sailing, water sports). French influence means excellent food variety.",
                crowdLevel: "Medium"
            },
            {
                id: 6,
                name: "Paradisus Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0654,
                lng: -86.7878,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 7800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "melia",
                pointsCost: "Melia Rewards",
                website: "https://www.melia.com/en/hotels/mexico/cancun/paradisus-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155685-Reviews-Paradisus_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Family Concierge", "YHI Spa", "Royal Service option"],
                notes: "Good value luxury with family concierge service",
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "Family Concierge level is worth the upgrade - dedicated check-in, lounge access, kid amenities. Good value compared to luxury competitors. Melia Rewards members get perks. Beach can get seaweed in summer.",
                crowdLevel: "Medium"
            },
            {
                id: 7,
                name: "Hilton Cancun",
                area: "cancun",
                areaName: "Cancun (South)",
                lat: 20.9764,
                lng: -86.8342,
                airportDist: "12 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.5,
                reviews: 3200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hilton",
                pointsCost: "80,000-120,000/night",
                website: "https://www.hilton.com/en/hotels/cunhihi-hilton-cancun-an-all-inclusive-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d23462107-Reviews-Hilton_Cancun_an_All_Inclusive_Resort-Cancun_Yucatan_Peninsula.html",
                features: ["Newer property (2021)", "Hilton Honors", "Multiple pools", "Golf access"],
                notes: "Newer resort, Hilton points eligible, good for families",
                valueScore: 8,
                renovated: "2021 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BRAND NEW (2021)! One of the newest all-inclusives in Cancun. Hilton Honors points work here - 80-120k/night is decent value. Closest resort to airport (12 min). Modern rooms, great pools. Still working out kinks but improving fast.",
                crowdLevel: "Medium"
            },
            {
                id: 8,
                name: "Dreams Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2547,
                lng: -86.8012,
                airportDist: "30 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.6,
                reviews: 8500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.dreamsresorts.com/playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d8082143-Reviews-Dreams_Playa_Mujeres_Golf_Spa_Resort-Cancun_Yucatan_Peninsula.html",
                features: ["Quieter area", "Golf course", "Explorer's Club kids", "Core Zone teens"],
                notes: "Quieter than Hotel Zone, great kids programs, Marriott Bonvoy",
                valueScore: 8,
                renovated: "2018",
                serviceRating: "Very Good",
                insiderTip: "GREAT FOR YOUR GROUP! Quieter Costa Mujeres area perfect for elderly. Marriott Bonvoy points work. Explorer's Club for kids 3-12 is excellent. Golf course on-site. Less party atmosphere than Hotel Zone. Reddit recommends over Finest for families.",
                crowdLevel: "Low"
            },
            {
                id: 9,
                name: "Finest Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2612,
                lng: -86.7987,
                airportDist: "35 min",
                priceMay24: 520,
                priceMay31: 580,
                rating: 4.7,
                reviews: 4800,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.theexcellencecollection.com/finest-playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d8546989-Reviews-Finest_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Luxury family", "Suite hotel", "Imagine kids club", "Rooftop pools"],
                notes: "Premium family resort, all suites, excellent for multigenerational",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2016 (Original)",
                serviceRating: "Top Notch",
                insiderTip: "Reddit rates 8.5/10. 'Service is absolutely top notch, food outstanding'. Kids club takes ages 3+ without parent! Small resort = you'll see kids regularly. ISSUE: Max 5 people/family suite, max 3 adults (13+) per room - may need creative booking for your 14. Some wear showing in 2024 reviews.",
                crowdLevel: "Low"
            },
            {
                id: 10,
                name: "Majestic Elegance Costa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2498,
                lng: -86.8045,
                airportDist: "30 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 5600,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.majestic-resorts.com/en/hotel/majestic-elegance-costa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d17448876-Reviews-Majestic_Elegance_Costa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Elegance Club upgrade", "Water park", "Family suites"],
                notes: "Good value in quieter Costa Mujeres area",
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "Elegance Club upgrade worth considering for better beach/pool area. Water park keeps kids busy. Good value vs neighbors. Costa Mujeres area is quieter. Some rooms show wear - request renovated building.",
                crowdLevel: "Medium"
            },
            // RIVIERA MAYA
            {
                id: 11,
                name: "Generations Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6523,
                lng: -87.0587,
                airportDist: "45 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.7,
                reviews: 3200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.genrivieramaya.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d4083498-Reviews-Generations_Riviera_Maya_Family_Resort-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["BUILT for multigenerational", "All oceanfront suites", "Baby to boomers", "Gourmet dining"],
                notes: "TOP PICK - Specifically designed for multigenerational families. All suites oceanfront.",
                valueScore: 10,
                renovated: "2017",
                serviceRating: "Outstanding",
                insiderTip: "IDEAL FOR YOUR GROUP! Literally DESIGNED for multigenerational travel! All suites face ocean. Baby concierge, kids club, teen lounge, adult wellness - everyone covered. Gourmet Inclusive dining. Staff trained specifically for multi-gen groups. Higher price but WORTH IT for your mix of ages.",
                crowdLevel: "Low"
            },
            {
                id: 12,
                name: "Grand Velas Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6891,
                lng: -87.0312,
                airportDist: "40 min",
                priceMay24: 550,
                priceMay31: 620,
                rating: 4.8,
                reviews: 9500,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://rivieramaya.grandvelas.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d1204526-Reviews-Grand_Velas_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["AAA Five Diamond", "8 restaurants", "SE Spa", "Kids/Teen clubs", "3 ambiances"],
                notes: "Luxury option - most expensive but highest rated. Amazing food.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2022",
                serviceRating: "Outstanding",
                insiderTip: "SPLURGE PICK! Consistently rated best all-inclusive in Mexico. Three ambiances (Zen, Ambassador, Grand Class) let you choose vibe. Food is genuinely gourmet - not typical buffet fare. Reddit says 'worth every penny'. If budget allows, this delivers true luxury experience.",
                crowdLevel: "Low-Medium"
            },
            {
                id: 13,
                name: "Sensira Resort & Spa",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7234,
                lng: -87.0123,
                airportDist: "35 min",
                priceMay24: 380,
                priceMay31: 430,
                rating: 4.5,
                reviews: 1800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://sensiraresorts.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d23557162-Reviews-Sensira_Resort_Spa_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Family union concept", "Rooms up to 7 guests", "Aqua park", "Wellness focus"],
                notes: "Newer property built around family bonding. $300 resort credit booking direct.",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2021 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "HIDDEN GEM! Newer resort specifically designed for multi-gen families. Rooms fit up to 7 people - perfect for your group! $300 resort credit when booking direct is real value. Wellness focus great for elderly. Less crowded than mega-resorts.",
                crowdLevel: "Low"
            },
            {
                id: 14,
                name: "Royalton Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7612,
                lng: -86.9876,
                airportDist: "25 min",
                priceMay24: 320,
                priceMay31: 360,
                rating: 4.3,
                reviews: 14200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "60,000-80,000/night",
                website: "https://www.royaltonresorts.com/royalton-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d7019593-Reviews-Royalton_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Sports Event Guarantee", "Clubhouse kids", "Water park"],
                notes: "Good value, Marriott points eligible, large property",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "POINTS VALUE! Marriott Bonvoy at 60-80k/night is decent redemption. Large property - lots of walking. Water park great for kids 9-11. Diamond Club upgrade worth it for better service. Some reviews mention dated rooms - request renovated building.",
                crowdLevel: "Medium-High"
            },
            {
                id: 15,
                name: "Iberostar Selection Paraiso Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7156,
                lng: -87.0089,
                airportDist: "30 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 11000,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.iberostar.com/en/hotels/riviera-maya/iberostar-selection-paraiso-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d592583-Reviews-Iberostar_Selection_Paraiso_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Part of 5-resort complex", "Marriott Bonvoy", "Water park", "Star Camp kids"],
                notes: "Good family resort, part of larger Paraiso complex",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "Great for kids 7-9! Part of 5-resort complex so tons to explore. WATCH OUT: Pushy timeshare sales, slow elevators, buffet closed 11am-1pm (only burgers/hot dogs). Good golf course. If traveling with kids & OK with buffet most nights, solid choice.",
                crowdLevel: "Medium"
            },
            {
                id: 16,
                name: "Hotel Xcaret Mexico",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.5812,
                lng: -87.1187,
                airportDist: "55 min",
                priceMay24: 480,
                priceMay31: 540,
                rating: 4.7,
                reviews: 7200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.hotelxcaret.com/en/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d12149498-Reviews-Hotel_Xcaret_Mexico-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Includes ALL Xcaret parks", "Unique eco-design", "Underground rivers", "Mexican culture"],
                notes: "All Xcaret parks included - incredible value if you want park access. Very unique.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2017 (Original)",
                serviceRating: "Excellent",
                insiderTip: "BEST VALUE FOR ACTIVITIES! All 10+ Xcaret parks included ($1200+ value). Underground river rooms are magical. Mexican culture focus educational for kids. CAUTION: 55min from airport, can feel remote. If your group wants parks anyway, this is unbeatable value.",
                crowdLevel: "Medium"
            },
            {
                id: 17,
                name: "Barcelo Maya Palace",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.4534,
                lng: -87.2234,
                airportDist: "70 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.3,
                reviews: 16500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.barcelo.com/en-us/barcelo-maya-palace/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d500888-Reviews-Barcelo_Maya_Palace-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Huge complex", "Multiple hotels", "Pirates island water park", "Good value"],
                notes: "Budget-friendly option, part of massive Barcelo Maya complex",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Mixed",
                insiderTip: "BUDGET PICK! Cheapest family option at $280/night. Part of massive 5-hotel complex = lots to explore but can feel crowded. Pirates waterpark is huge hit with kids. 70min from airport is long drive. Good if budget is priority over luxury.",
                crowdLevel: "High"
            },
            {
                id: 18,
                name: "Hyatt Vivid Playa del Carmen",
                area: "riviera",
                areaName: "Playa del Carmen",
                lat: 20.6298,
                lng: -87.0712,
                airportDist: "50 min",
                priceMay24: 350,
                priceMay31: 390,
                rating: 4.5,
                reviews: 2100,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: "hyatt",
                pointsCost: "25,000-40,000/night",
                website: "https://www.hyatt.com/en-US/hotel/mexico/hyatt-vivid-playa-del-carmen/cunpd",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d25246619-Reviews-Hyatt_Vivid_Playa_del_Carmen-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Hyatt points", "Newer property", "Fifth Avenue nearby"],
                notes: "Adults only - good for Dann & husband or grandparents if wanting separate stay",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2023 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "NEWEST HYATT in area! Adults-only so perfect for Dann & husband. Fifth Avenue walkable = nightlife/shopping access. Hyatt points at 25-40k/night is solid value. Modern rooms, rooftop pool. Trendy vibe may appeal to younger adults in group.",
                crowdLevel: "Medium"
            },
            {
                id: 19,
                name: "Planet Hollywood Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7534,
                lng: -86.9923,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "60,000-80,000/night",
                website: "https://www.planethollywoodhotels.com/cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d15092376-Reviews-Planet_Hollywood_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Movie memorabilia", "PH Spa", "Stars kids club"],
                notes: "Fun theme, Marriott points, good for families",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "FUN THEME! Kids will love the movie memorabilia. Marriott Bonvoy points work here. Stars Kids Club keeps children entertained. Not as upscale as name suggests but solid mid-range option. Good value if you want brand recognition + points.",
                crowdLevel: "Medium"
            },
            {
                id: 20,
                name: "Secrets Akumal",
                area: "riviera",
                areaName: "Akumal",
                lat: 20.3956,
                lng: -87.3112,
                airportDist: "75 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.6,
                reviews: 8900,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/akumal-riviera-maya",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g499447-d8518695-Reviews-Secrets_Akumal_Riviera_Maya-Akumal_Yucatan_Peninsula.html",
                features: ["Adults only", "AAA Four Diamond", "Sea turtle area", "Unlimited luxury"],
                notes: "Adults only - good for couples in family wanting romantic escape",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "BEST FOR COUPLES! Adults-only with Marriott Bonvoy. Sea turtles nest on beach - magical experience. Akumal = quieter area. Good for Dann & husband or grandparents wanting peace. AAA Four Diamond quality. Long drive from airport (75min) but worth it for serenity.",
                crowdLevel: "Low"
            },
            // TULUM AREA
            {
                id: 21,
                name: "Hilton Tulum Riviera Maya",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2712,
                lng: -87.4234,
                airportDist: "90 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.6,
                reviews: 2800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hilton",
                pointsCost: "80,000-120,000/night",
                website: "https://www.hilton.com/en/hotels/tulaihh-hilton-tulum-riviera-maya-all-inclusive-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d23461797-Reviews-Hilton_Tulum_Riviera_Maya_All_Inclusive_Resort-Tulum_Yucatan_Peninsula.html",
                features: ["Hilton Honors", "World-class fitness", "Near ruins", "Newer property"],
                notes: "Best Tulum option for families, Hilton points",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2022 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BEST TULUM FOR FAMILIES! Newest resort in Tulum area. Hilton Honors points at 80-120k/night. World-class gym. Near Tulum ruins = easy excursion. CAUTION: 90min from airport is long with kids. Worth it if you want Tulum vibe + family amenities.",
                crowdLevel: "Medium"
            },
            {
                id: 22,
                name: "Dreams Tulum Resort & Spa",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2634,
                lng: -87.4312,
                airportDist: "90 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 12300,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.dreamsresorts.com/tulum",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d152897-Reviews-Dreams_Tulum_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Explorer's Club kids", "Near Tulum ruins"],
                notes: "Good family option in Tulum, longer drive from airport",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "SOLID TULUM OPTION! Marriott Bonvoy compatible. Explorer's Club great for kids 3-12. Near ruins and cenotes. More established than newer competitors. Some rooms dated - request ocean view for best experience. 90min drive manageable if you want authentic Tulum feel.",
                crowdLevel: "Medium"
            },
            {
                id: 23,
                name: "Grand Bahia Principe Tulum",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2478,
                lng: -87.4456,
                airportDist: "95 min",
                priceMay24: 260,
                priceMay31: 300,
                rating: 4.3,
                reviews: 9800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.bahia-principe.com/en/resorts-mexico/resort-grand-tulum/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d500894-Reviews-Grand_Bahia_Principe_Tulum-Tulum_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Part of complex", "Water park", "Good for value"],
                notes: "Most affordable Tulum option, good for budget-conscious",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2017",
                serviceRating: "Mixed",
                insiderTip: "BUDGET TULUM! Cheapest way to get Tulum at $260/night. Part of larger complex = more options. Water park keeps kids happy. Service can be inconsistent. 95min drive is longest. Good if you want Tulum on a budget but manage expectations.",
                crowdLevel: "High"
            },
            {
                id: 24,
                name: "Kore Tulum Retreat",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2156,
                lng: -87.4623,
                airportDist: "100 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 3200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://koretulum.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d1493827-Reviews-Kore_Tulum_Retreat_Wellness_Resort-Tulum_Yucatan_Peninsula.html",
                features: ["Adults only", "Wellness focus", "Boutique", "Spa focused"],
                notes: "Adults only - boutique wellness option",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "WELLNESS RETREAT! Adults-only boutique for those wanting spa/wellness focus. Great for grandparents wanting tranquility. Smaller = more intimate service. Real Tulum bohemian vibe. 100min from airport is far but you're here to disconnect.",
                crowdLevel: "Very Low"
            },
            {
                id: 25,
                name: "Grand Palladium White Sand",
                area: "riviera",
                areaName: "Riviera Maya (near Tulum)",
                lat: 20.3534,
                lng: -87.3423,
                airportDist: "80 min",
                priceMay24: 300,
                priceMay31: 340,
                rating: 4.3,
                reviews: 11200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.palladiumhotelgroup.com/en/hotels/mexico/rivieramaya/grand-palladium-white-sand-resort-spa",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g1229481-d292294-Reviews-Grand_Palladium_White_Sand_Resort_Spa-Xpu_Ha_Yucatan_Peninsula.html",
                features: ["Part of complex", "Baby club", "Good beach", "Zentropia spa"],
                notes: "Good value option between Playa del Carmen and Tulum",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "MID-RANGE VALUE! Good balance of price/quality. Baby club rare - great if traveling with infants. Part of 4-resort complex. Zentropia spa excellent. Beach is wide and nice. 80min from airport is moderate. Solid choice for families on budget.",
                crowdLevel: "Medium-High"
            },
            // More Costa Mujeres
            {
                id: 26,
                name: "Atelier Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2634,
                lng: -86.7945,
                airportDist: "35 min",
                priceMay24: 480,
                priceMay31: 540,
                rating: 4.7,
                reviews: 4500,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.atelierdehoteles.com/playa-mujeres/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d15071178-Reviews-Atelier_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Luxury", "Artistic design", "Rooftop pools"],
                notes: "Adults only luxury - good option for couple wanting premium experience",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Outstanding",
                insiderTip: "LUXURY ADULTS-ONLY! Art-focused design is stunning. Rooftop pools with views. High-end service. Great for Dann & husband or if grandparents want separate luxury stay. Costa Mujeres = quieter than Hotel Zone. Worth splurge for special occasions.",
                crowdLevel: "Low"
            },
            {
                id: 27,
                name: "Haven Riviera Cancun",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2512,
                lng: -86.8078,
                airportDist: "30 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 5800,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.havenresorts.com/haven-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d13398982-Reviews-Haven_Riviera_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Serenity suite upgrade", "Good spa"],
                notes: "Adults only - nice option for couples",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "GOOD VALUE ADULTS-ONLY! Serenity suite upgrade worth it for better room. Good spa. Less expensive than Atelier but still quality adults-only experience. Costa Mujeres location is peaceful. 30min from airport is reasonable.",
                crowdLevel: "Low-Medium"
            },
            // Additional family resorts
            {
                id: 28,
                name: "Ocean Riviera Paradise",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7234,
                lng: -86.9987,
                airportDist: "30 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.2,
                reviews: 8900,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.oceanhotels.net/en/hotels/ocean-riviera-paradise",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d10169936-Reviews-Ocean_Riviera_Paradise-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Privilege upgrade", "Near Playa"],
                notes: "Good budget option with Privilege upgrade available",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2017",
                serviceRating: "Mixed",
                insiderTip: "BUDGET OPTION! Cheapest in Riviera Maya at $280/night. Privilege upgrade essential for better experience. Near Playa del Carmen for shopping/nightlife. Service reviews mixed. Good if budget is tight but expect basics. 30min from airport.",
                crowdLevel: "High"
            },
            {
                id: 29,
                name: "Riu Palace Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7012,
                lng: -87.0145,
                airportDist: "35 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.5,
                reviews: 6700,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.riu.com/en/hotel/mexico/playa-del-carmen/hotel-riu-palace-riviera-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d152937-Reviews-Hotel_Riu_Palace_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["24hr all-inclusive", "Good beach", "RiuLand kids"],
                notes: "Solid Riu property with good kids program",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "SOLID FAMILY CHOICE! 24-hour all-inclusive = late night snacks available. RiuLand kids club well-reviewed. Good beach area. Reliable Riu brand quality. Not fancy but delivers consistent experience. 35min from airport is moderate.",
                crowdLevel: "Medium"
            },
            {
                id: 30,
                name: "The Royal Sands",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0912,
                lng: -86.7712,
                airportDist: "25 min",
                priceMay24: 300,
                priceMay31: 340,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.royalresorts.com/the-royal-sands",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155678-Reviews-The_Royal_Sands-Cancun_Yucatan_Peninsula.html",
                features: ["Suite hotel", "Kitchen in rooms", "Good for families"],
                notes: "All suite property with kitchens - good for families",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2016",
                serviceRating: "Good",
                insiderTip: "KITCHEN SUITES! All rooms have kitchens = save money on snacks/breakfast. Good for families with picky eaters. Hotel Zone location is walkable to shops. Older property but well-maintained. 25min from airport. Good value for suite-style accommodations.",
                crowdLevel: "Medium"
            },
            {
                id: 31,
                name: "Le Blanc Spa Resort",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.1234,
                lng: -86.7523,
                airportDist: "28 min",
                priceMay24: 650,
                priceMay31: 720,
                rating: 4.8,
                reviews: 7800,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.leblancsparesort.com/cancun/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d601051-Reviews-Le_Blanc_Spa_Resort_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "AAA Five Diamond", "Premium luxury", "Butler service"],
                notes: "Most luxurious adults-only option - for couples wanting ultra-premium",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "World-Class",
                insiderTip: "ULTIMATE LUXURY! AAA Five Diamond = highest rating possible. Butler service is exceptional. Most expensive but truly delivers premium experience. Perfect for honeymoon or special anniversary. If grandparents or Dann & husband want to splurge, this is THE choice.",
                crowdLevel: "Low"
            },
            {
                id: 32,
                name: "Secrets The Vine Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0845,
                lng: -86.7756,
                airportDist: "22 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.6,
                reviews: 11200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/the-vine-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d2312009-Reviews-Secrets_The_Vine_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Marriott Bonvoy", "Wine theme", "Unlimited luxury"],
                notes: "Adults only, Marriott points - wine-themed luxury",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "POINTS + LUXURY! Marriott Bonvoy works here. Wine theme = excellent wine selection included. Unlimited luxury concept. Great for wine-loving couples. Hotel Zone location = close to everything. Solid choice for adults wanting Marriott points + quality.",
                crowdLevel: "Medium"
            },
            // More Tulum
            {
                id: 33,
                name: "Secrets Tulum Resort",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2289,
                lng: -87.4534,
                airportDist: "95 min",
                priceMay24: 400,
                priceMay31: 450,
                rating: 4.5,
                reviews: 1200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/tulum",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d25113654-Reviews-Secrets_Tulum_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Adults only", "Marriott Bonvoy", "Newer 2024", "Near ruins"],
                notes: "New 2024 adults-only Secrets in Tulum",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2024 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BRAND NEW 2024! Newest Secrets resort. Marriott Bonvoy compatible. Near Tulum ruins. Adults-only luxury in authentic Tulum setting. Still working out kinks as new property. 95min from airport is long but worth it for newest Secrets experience.",
                crowdLevel: "Low"
            },
            // Additional resorts
            {
                id: 34,
                name: "Sandos Caracol Eco Resort",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6712,
                lng: -87.0456,
                airportDist: "45 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.2,
                reviews: 14500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.sandos.com/hotels/riviera-maya/sandos-caracol-eco-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d219619-Reviews-Sandos_Caracol_Eco_Resort-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Eco-resort", "Cenote on property", "Budget friendly", "Nature focus"],
                notes: "Eco-focused budget option with cenote on-site",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "ECO BUDGET PICK! Cenote on property = unique experience. Nature focus great for educational family trips. Budget-friendly at $280/night. Not luxury but delivers authentic eco-experience. 45min from airport. Good for nature-loving families on budget.",
                crowdLevel: "High"
            },
            {
                id: 35,
                name: "Xcaret Arte",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.5789,
                lng: -87.1212,
                airportDist: "55 min",
                priceMay24: 580,
                priceMay31: 650,
                rating: 4.8,
                reviews: 3200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.hotelxcaretarte.com/en/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d21018987-Reviews-Hotel_Xcaret_Arte-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Art focused", "All Xcaret parks", "Premium luxury"],
                notes: "Adults only sister to Hotel Xcaret - all parks included, art theme",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "Outstanding",
                insiderTip: "ADULTS XCARET! All Xcaret parks included + art workshops. Unique artist residency program. Premium adults-only luxury. Great for creative couples. If parents/grandparents want parks + sophistication, this is perfect. 55min from airport.",
                crowdLevel: "Low"
            },
            {
                id: 36,
                name: "Breathless Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7612,
                lng: -86.9812,
                airportDist: "25 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.4,
                reviews: 7800,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.breathlessresorts.com/riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d8545775-Reviews-Breathless_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Party vibe", "Marriott Bonvoy", "Xhale Club upgrade"],
                notes: "Adults only with party vibe - good for younger adults",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "PARTY ATMOSPHERE! For younger adults who want energy. Marriott Bonvoy eligible. Xhale Club upgrade worth it for quieter area. May not suit grandparents. Good for college-age kids in your group who want nightlife. 25min from airport.",
                crowdLevel: "High"
            },
            {
                id: 37,
                name: "Now Sapphire Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7512,
                lng: -86.9912,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.3,
                reviews: 9200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.nowresorts.com/sapphire-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d500896-Reviews-Now_Sapphire_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Explorer's Club kids", "Spa", "Good beach"],
                notes: "Good family option with Marriott points",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "SOLID FAMILY CHOICE! Marriott Bonvoy = points value. Explorer's Club keeps kids 3-12 happy. Good beach area. Reliable mid-range family option. 25min from airport is convenient. Not exciting but consistently delivers for families.",
                crowdLevel: "Medium"
            },
            {
                id: 38,
                name: "Valentin Imperial Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7134,
                lng: -87.0023,
                airportDist: "35 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 8100,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.valentinhotelgroup.com/en/valentin-imperial-maya",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d592582-Reviews-Valentin_Imperial_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Premium rooms", "10 restaurants", "Good spa"],
                notes: "Adults only - solid luxury option for couples",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "GREAT VALUE LUXURY! 10 restaurants = no dining boredom. Adults-only with quality service. Good spa. Less expensive than Le Blanc but still upscale. 35min from airport. Strong choice for couples wanting luxury without extreme prices.",
                crowdLevel: "Medium"
            },
            {
                id: 39,
                name: "Excellence Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2689,
                lng: -86.7923,
                airportDist: "35 min",
                priceMay24: 450,
                priceMay31: 500,
                rating: 4.7,
                reviews: 14500,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.theexcellencecollection.com/excellence-playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d1936990-Reviews-Excellence_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Excellence Club upgrade", "All suites", "Private pools available"],
                notes: "Top-rated adults only - sister to Finest (family version)",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2020",
                serviceRating: "Excellent",
                insiderTip: "TOP ADULTS-ONLY PICK! Sister to Finest (your family option). Excellence Club upgrade worth it. All suites = spacious. Private pools available. Same quality as family version. Perfect if splitting group - adults here, families at Finest. 35min from airport.",
                crowdLevel: "Low"
            },
            {
                id: 40,
                name: "Grand Sirenis Riviera Maya",
                area: "tulum",
                areaName: "Near Tulum",
                lat: 20.2856,
                lng: -87.4123,
                airportDist: "85 min",
                priceMay24: 240,
                priceMay31: 280,
                rating: 4.1,
                reviews: 10200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.sirenishotels.com/en/hotels/riviera-maya/grand-sirenis-riviera-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d625506-Reviews-Grand_Sirenis_Riviera_Maya_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Cenote on site", "Large property"],
                notes: "Budget option near Tulum with cenote",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2016",
                serviceRating: "Mixed",
                insiderTip: "CHEAPEST OPTION! At $240/night, this is budget king. Cenote on-site is unique. Large property = lots of walking. Service inconsistent per reviews. 85min from airport. Good if you want Tulum area on tight budget but temper expectations.",
                crowdLevel: "High"
            },

            // LUXURY VILLA RENTALS - Great for large groups
            {
                id: 41,
                name: "Hacienda Magica (Villa)",
                area: "riviera",
                areaName: "Puerto Aventuras",
                lat: 20.4983,
                lng: -87.2350,
                airportDist: "45 min",
                priceMay24: 2860,
                priceMay31: 3200,
                rating: 5.0,
                reviews: 89,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 14,
                sleeps: 36,
                points: null,
                pointsCost: null,
                website: "https://hauteretreats.com/luxury-rentals/hacienda-magica-14-br/",
                tripadvisor: "https://www.tripadvisor.com/VacationRentalReview-g153510-d2350771-Hacienda_Magica-Puerto_Aventuras.html",
                features: ["14 bedrooms", "Beachfront", "Full staff", "Private chef", "Tennis court", "Pool"],
                notes: "VILLA: Palatial beachfront villa with full staff, chef, and butler. Price is for entire villa/night. Perfect for our group of 14!",
                // INSIDER INTEL
                valueScore: 10,
                renovated: "2020",
                serviceRating: "Outstanding",
                insiderTip: "ULTIMATE PRIVACY PICK! 14 bedrooms fits your ENTIRE group of 14 under one roof! Full staff handles everything. Private chef = custom menus for all ages. Beachfront. At $2860/night for entire villa = ~$204/person/night. INCREDIBLE value for private experience!",
                crowdLevel: "Private"
            },
            {
                id: 42,
                name: "Villa Esmeralda (Villa)",
                area: "riviera",
                areaName: "Playa del Carmen",
                lat: 20.6296,
                lng: -87.0739,
                airportDist: "55 min",
                priceMay24: 1800,
                priceMay31: 2100,
                rating: 4.9,
                reviews: 42,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 8,
                sleeps: 16,
                points: null,
                pointsCost: null,
                website: "https://www.mayaluxe.com/luxury-villas/",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150812-Reviews-Playa_del_Carmen_Yucatan_Peninsula-Villas.html",
                features: ["8 bedrooms", "Private pool", "Chef available", "Oceanfront", "Concierge"],
                notes: "VILLA: Luxury beachfront villa. Chef and concierge available. Price is per night for entire villa.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "GREAT VILLA VALUE! 8 bedrooms at $1800/night = ~$129/person/night. Private pool + oceanfront. Chef available. Near Playa del Carmen = restaurants/shopping. Smaller than Hacienda Magica but may need 2+ villas for your 14 people.",
                crowdLevel: "Private"
            },
            {
                id: 43,
                name: "Hacienda del Mar (Villa)",
                area: "cancun",
                areaName: "Puerto Cancun",
                lat: 21.1456,
                lng: -86.8123,
                airportDist: "25 min",
                priceMay24: 2200,
                priceMay31: 2500,
                rating: 4.8,
                reviews: 56,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 7,
                sleeps: 14,
                points: null,
                pointsCost: null,
                website: "https://www.rentalescapes.com/rentals/luxury-vacation-rentals-mexico/riviera-maya/cancun",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150807-Reviews-Cancun_Yucatan_Peninsula-Villas.html",
                features: ["7 bedrooms", "Private beach", "Full staff", "Golf nearby", "Marina access"],
                notes: "VILLA: Perfect for our 14 people - 7 rooms exactly. Full staff included. Gated community with marina.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "Excellent",
                insiderTip: "PERFECT FIT! 7 bedrooms = exactly 7 rooms your group needs. Full staff included. Gated Puerto Cancun community is safe and upscale. Marina access for boat trips. Golf nearby. 25min from airport. At $2200/night = ~$157/person. Great for group wanting resort feel with privacy.",
                crowdLevel: "Private"
            },
            {
                id: 44,
                name: "Villa Quinta Clara (Villa)",
                area: "riviera",
                areaName: "Akumal",
                lat: 20.3961,
                lng: -87.3120,
                airportDist: "70 min",
                priceMay24: 1650,
                priceMay31: 1900,
                rating: 4.9,
                reviews: 34,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 8,
                sleeps: 18,
                points: null,
                pointsCost: null,
                website: "https://isleblue.co/mayan-riviera/villas",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g499445-Reviews-Akumal_Yucatan_Peninsula-Villas.html",
                features: ["8 bedrooms", "Sea turtle beach", "Snorkeling", "Cook included", "Pool"],
                notes: "VILLA: Located in Akumal - famous for sea turtles! Cook and housekeeper included. Great for kids.",
                // INSIDER INTEL
                valueScore: 10,
                renovated: "2018",
                serviceRating: "Excellent",
                insiderTip: "BEST FOR KIDS! Akumal = sea turtle snorkeling RIGHT ON BEACH! Kids will love it. Cook + housekeeper included. 8 bedrooms sleeps 18 = fits your 14 with room to spare. At $1650/night = ~$118/person = INCREDIBLE value! Magical for multigenerational memories.",
                crowdLevel: "Private"
            },
            {
                id: 45,
                name: "Casa de los Suenos (Villa)",
                area: "tulum",
                areaName: "Tulum Beach",
                lat: 20.2145,
                lng: -87.4298,
                airportDist: "90 min",
                priceMay24: 2400,
                priceMay31: 2800,
                rating: 4.8,
                reviews: 28,
                family: true,
                accessible: false,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 9,
                sleeps: 20,
                points: null,
                pointsCost: null,
                website: "https://www.mayaluxe.com/luxury-villas/?filter_region=tulum",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150813-Reviews-Tulum_Yucatan_Peninsula-Villas.html",
                features: ["9 bedrooms", "Beachfront Tulum", "Cenote nearby", "Chef available", "Bohemian luxury"],
                notes: "VILLA: Stunning Tulum beachfront. Note: Tulum beach is less accessible (stairs to beach). Great for those wanting authentic Tulum vibe.",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2020",
                serviceRating: "Very Good",
                insiderTip: "TULUM BOHEMIAN LUXURY! 9 bedrooms on Tulum beach = Instagram-worthy. Cenote nearby for swimming. Chef available. CAUTION: Tulum beach has stairs = NOT ideal for mobility-challenged grandparents. 90min from airport. Perfect if everyone mobile and wants authentic Tulum.",
                crowdLevel: "Private"
            }
        ];

        // Excursions, Restaurants & Activities Database
        // Each entry includes provenance (source, URL, last verified date)
        const attractions = [
            // ECO-PARKS
            {
                id: 'xcaret',
                name: 'Xcaret Park',
                category: 'eco-park',
                type: 'Theme Park',
                area: 'riviera',
                areaName: 'Riviera Maya',
                lat: 20.5808,
                lng: -87.1180,
                rating: 4.7,
                reviewCount: 45234,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$',
                priceAdult: 130,
                priceChild: 65,
                duration: 'Full day (8-10 hours)',
                hours: '8:30 AM - 10:30 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://www.xcaret.com',
                bookingUrl: 'https://www.xcaret.com/en/parks-and-tours/xcaret/',
                description: 'Eco-archaeological park with underground rivers, snorkeling, wildlife, and spectacular night show.',
                highlights: ['Underground rivers', 'Snorkeling', 'Butterfly pavilion', 'Night show', 'Mexican village'],
                included: ['All activities', 'Snorkel equipment', 'Locker', 'Night show'],
                notIncluded: ['Food (unless plus package)', 'Photos', 'Towels'],
                tips: 'Book "Plus" package for buffet meals. Arrive early to maximize time. Night show is a must-see!',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150812-d155544-Reviews-Xcaret_Park-Playa_del_Carmen_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'xelha',
                name: 'Xel-HÃ¡ Park',
                category: 'eco-park',
                type: 'Water Park',
                area: 'riviera',
                areaName: 'Riviera Maya',
                lat: 20.3180,
                lng: -87.3575,
                rating: 4.6,
                reviewCount: 28456,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$',
                priceAdult: 120,
                priceChild: 60,
                duration: 'Full day (6-8 hours)',
                hours: '8:30 AM - 6:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://www.xelha.com',
                bookingUrl: 'https://www.xcaret.com/en/parks-and-tours/xel-ha/',
                description: 'All-inclusive natural aquarium and water park. Snorkel with tropical fish in a natural inlet.',
                highlights: ['All-inclusive food & drinks', 'Unlimited snorkeling', 'Cliff jumping', 'Zip-line over water', 'Lazy river'],
                included: ['Food & drinks (all-inclusive)', 'Snorkel gear', 'Locker', 'Towel', 'Inner tubes'],
                notIncluded: ['Photos', 'Spa services'],
                tips: 'Best value eco-park since food/drinks included. Great for families - calm waters perfect for kids.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g668145-d155555-Reviews-Xel_Ha_Park-Xel_Ha_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'xplor',
                name: 'Xplor Adventure Park',
                category: 'eco-park',
                type: 'Adventure Park',
                area: 'riviera',
                areaName: 'Riviera Maya',
                lat: 20.5794,
                lng: -87.1200,
                rating: 4.8,
                reviewCount: 19876,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$',
                priceAdult: 145,
                priceChild: 72,
                duration: 'Full day (5-7 hours)',
                hours: '9:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 5,
                wheelchairAccessible: false,
                website: 'https://www.xplor.travel',
                bookingUrl: 'https://www.xcaret.com/en/parks-and-tours/xplor/',
                description: 'Adventure park with zip-lines, amphibious vehicles, underground rivers, and rafting.',
                highlights: ['14 zip-lines', 'Amphibious vehicles', 'Underground rafting', 'Stalactite rivers', 'Unlimited buffet'],
                included: ['All activities', 'Buffet lunch', 'Drinks', 'Locker', 'Equipment'],
                notIncluded: ['Photos', 'Souvenirs'],
                tips: 'Height/weight restrictions apply. Not ideal for those afraid of heights. Most adventurous of Xcaret parks.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150812-d1547653-Reviews-Xplor-Playa_del_Carmen_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // RUINS & HISTORY
            {
                id: 'chichen',
                name: 'ChichÃ©n ItzÃ¡',
                category: 'ruins',
                type: 'Archaeological Site',
                area: 'inland',
                areaName: 'Yucatan Interior',
                lat: 20.6843,
                lng: -88.5678,
                rating: 4.7,
                reviewCount: 32156,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 80,
                priceChild: 40,
                duration: '8-10 hours (with transport)',
                hours: '8:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: 'partial',
                website: 'https://www.inah.gob.mx/zonas/146-zona-arqueologica-de-chichen-itza',
                bookingUrl: 'https://www.viator.com/Cancun-attractions/Chichen-Itza/d631-a852',
                description: 'One of the New Seven Wonders of the World. Ancient Mayan city featuring the iconic El Castillo pyramid.',
                highlights: ['El Castillo pyramid', 'Ball court', 'Temple of Warriors', 'Sacred cenote', 'Observatory'],
                included: ['Entrance fee', 'Guide (if tour)', 'Transport (if tour)'],
                notIncluded: ['Food', 'Souvenirs', 'Tips'],
                tips: 'Book early morning tour to beat crowds and heat. Bring water, hat, sunscreen. 2.5 hours from Cancun. Visit cenote Ik Kil nearby.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150810-d153327-Reviews-Chichen_Itza-Chichen_Itza_Yucatan_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'tulum-ruins',
                name: 'Tulum Archaeological Zone',
                category: 'ruins',
                type: 'Archaeological Site',
                area: 'tulum',
                areaName: 'Tulum',
                lat: 20.2148,
                lng: -87.4291,
                rating: 4.5,
                reviewCount: 28743,
                ratingSource: 'TripAdvisor',
                priceRange: '$',
                priceAdult: 25,
                priceChild: 0,
                duration: '2-3 hours',
                hours: '9:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: 'partial',
                website: 'https://www.inah.gob.mx/zonas/zona-arqueologica-de-tulum',
                bookingUrl: 'https://www.viator.com/Cancun-attractions/Tulum-Ruins/d631-a29959',
                description: 'Only Mayan ruins overlooking the Caribbean Sea. Stunning clifftop setting with beach access.',
                highlights: ['Clifftop views', 'El Castillo', 'Temple of Frescoes', 'Beach access', 'Ocean views'],
                included: ['Entrance fee'],
                notIncluded: ['Guide', 'Transport', 'Food'],
                tips: 'Arrive at 9 AM opening to avoid crowds. Bring swimsuit for beach below. Combine with cenote visit. ~2 hours from Cancun.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150813-d153434-Reviews-Tulum_Archaeological_Site-Tulum_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'coba',
                name: 'CobÃ¡ Archaeological Zone',
                category: 'ruins',
                type: 'Archaeological Site',
                area: 'riviera',
                areaName: 'Riviera Maya',
                lat: 20.4943,
                lng: -87.7361,
                rating: 4.6,
                reviewCount: 12456,
                ratingSource: 'TripAdvisor',
                priceRange: '$',
                priceAdult: 20,
                priceChild: 0,
                duration: '3-4 hours',
                hours: '8:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 5,
                wheelchairAccessible: false,
                website: 'https://www.inah.gob.mx/zonas/zona-arqueologica-de-coba',
                bookingUrl: 'https://www.viator.com/Cancun-attractions/Coba-Ruins/d631-a16632',
                description: 'One of the tallest Mayan pyramids you can still climb. Jungle setting with bike rentals available.',
                highlights: ['Climbable pyramid', 'Jungle setting', 'Bike rentals', 'Less crowded', 'Authentic experience'],
                included: ['Entrance fee'],
                notIncluded: ['Bike rental ($3-5)', 'Guide', 'Transport'],
                tips: 'You can STILL CLIMB this pyramid! Rent bikes to cover the large site. Very hot - bring lots of water.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g675444-d155477-Reviews-Coba_Ruins-Coba_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // CENOTES
            {
                id: 'cenote-ikkil',
                name: 'Cenote Ik Kil',
                category: 'cenote',
                type: 'Natural Wonder',
                area: 'inland',
                areaName: 'Yucatan Interior',
                lat: 20.6608,
                lng: -88.5507,
                rating: 4.5,
                reviewCount: 15678,
                ratingSource: 'TripAdvisor',
                priceRange: '$',
                priceAdult: 15,
                priceChild: 10,
                duration: '1-2 hours',
                hours: '8:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: false,
                website: 'https://cenoteikkil.com',
                bookingUrl: 'https://cenoteikkil.com',
                description: 'Famous cenote near ChichÃ©n ItzÃ¡. Stunning open-air sinkhole with hanging vines.',
                highlights: ['Swimming', 'Cliff jumping', 'Vines hanging to water', 'Restaurant on-site', 'Changing rooms'],
                included: ['Swimming access', 'Life jacket'],
                notIncluded: ['Towel rental', 'Locker rental ($2)', 'Food'],
                tips: 'Combine with ChichÃ©n ItzÃ¡ (3km away). Very popular - go early or late. Water is cold but refreshing!',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150810-d2283180-Reviews-Cenote_Ik_kil-Chichen_Itza_Yucatan_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'gran-cenote',
                name: 'Gran Cenote',
                category: 'cenote',
                type: 'Natural Wonder',
                area: 'tulum',
                areaName: 'Tulum',
                lat: 20.2463,
                lng: -87.4649,
                rating: 4.6,
                reviewCount: 8934,
                ratingSource: 'TripAdvisor',
                priceRange: '$',
                priceAdult: 20,
                priceChild: 10,
                duration: '1-2 hours',
                hours: '8:10 AM - 4:45 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: false,
                website: null,
                bookingUrl: null,
                description: 'Crystal clear cenote with caves, turtles, and incredible visibility. Perfect for snorkeling.',
                highlights: ['Crystal clear water', 'Cave swimming', 'Sea turtles', 'Snorkeling', 'Beautiful rock formations'],
                included: ['Entrance', 'Life jacket'],
                notIncluded: ['Snorkel gear rental ($5)', 'Locker ($2)', 'Towels'],
                tips: 'Arrive at 8 AM opening for best experience. Look for turtles in the caves! No sunscreen allowed (biodegradable only).',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150813-d1520301-Reviews-Gran_Cenote-Tulum_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // WATER ACTIVITIES
            {
                id: 'isla-mujeres',
                name: 'Isla Mujeres',
                category: 'island',
                type: 'Day Trip',
                area: 'cancun',
                areaName: 'Cancun',
                lat: 21.2320,
                lng: -86.7330,
                rating: 4.7,
                reviewCount: 25678,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 50,
                priceChild: 25,
                duration: 'Full day (6-8 hours)',
                hours: 'Ferry runs 7:00 AM - 9:30 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://islamujeres.gob.mx',
                bookingUrl: 'https://www.ultramarferry.com',
                description: 'Charming island 20 minutes from Cancun. Beautiful beaches, golf cart rentals, snorkeling, and laid-back vibe.',
                highlights: ['Playa Norte beach', 'Golf cart island tour', 'Snorkeling', 'Garrafon Park', 'Downtown shopping'],
                included: ['Ferry ticket (if booked as tour)'],
                notIncluded: ['Golf cart rental ($40-60)', 'Food', 'Activities'],
                tips: 'Rent golf cart to explore island. Playa Norte is one of best beaches in Mexico. Take early ferry to maximize time.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150809-d150708-Reviews-Isla_Mujeres-Isla_Mujeres_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'cozumel',
                name: 'Cozumel Island',
                category: 'island',
                type: 'Day Trip',
                area: 'riviera',
                areaName: 'Riviera Maya',
                lat: 20.4318,
                lng: -86.9203,
                rating: 4.8,
                reviewCount: 18456,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 55,
                priceChild: 30,
                duration: 'Full day (6-10 hours)',
                hours: 'Ferry from Playa del Carmen every 1-2 hours',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://cozumel.travel',
                bookingUrl: 'https://www.winjet.mx',
                description: 'World-famous diving and snorkeling. Crystal clear waters, coral reefs, and relaxed island atmosphere.',
                highlights: ['World-class snorkeling', 'Coral reefs', 'Chankanaab Park', 'Punta Sur', 'Mexican cuisine'],
                included: ['Ferry ticket (if booked as tour)'],
                notIncluded: ['Snorkel/dive equipment', 'Food', 'Transport on island'],
                tips: 'Ferry from Playa del Carmen (45 min). Best snorkeling in the area. Rent a car or scooter to explore.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150811-d153619-Reviews-Cozumel-Cozumel_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'musa',
                name: 'MUSA Underwater Museum',
                category: 'water-activity',
                type: 'Snorkeling/Diving',
                area: 'cancun',
                areaName: 'Cancun',
                lat: 21.1985,
                lng: -86.7427,
                rating: 4.4,
                reviewCount: 5678,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 65,
                priceChild: 45,
                duration: '2-3 hours',
                hours: 'Tours depart 9 AM, 11 AM, 1 PM',
                kidFriendly: true,
                kidAgeMin: 4,
                wheelchairAccessible: false,
                website: 'https://musamexico.org',
                bookingUrl: 'https://musamexico.org/en/tours/',
                description: 'Underwater sculpture museum with 500+ life-sized statues. Snorkel or dive experience.',
                highlights: ['500+ underwater statues', 'Snorkeling option', 'Diving option', 'Glass-bottom boat option', 'Art and nature'],
                included: ['Snorkel/dive equipment', 'Guide', 'Boat transport'],
                notIncluded: ['Photos', 'Tips'],
                tips: 'Snorkeling sees shallower statues. Diving sees more. Glass-bottom boat available for non-swimmers.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150807-d2059407-Reviews-MUSA_Museo_Subacuatico_de_Arte-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // RESTAURANTS - OFF RESORT
            {
                id: 'puerto-madero',
                name: 'Puerto Madero CancÃºn',
                category: 'restaurant',
                type: 'Seafood/Steakhouse',
                area: 'cancun',
                areaName: 'Cancun Hotel Zone',
                lat: 21.1324,
                lng: -86.7514,
                rating: 4.5,
                reviewCount: 8765,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$$',
                priceAdult: 75,
                priceChild: 30,
                duration: '2-3 hours',
                hours: '1:00 PM - 12:00 AM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://www.puertomaderocancun.com',
                bookingUrl: 'https://www.opentable.com/puerto-madero-cancun',
                description: 'Upscale Argentine steakhouse and seafood with stunning lagoon views. Special occasion worthy.',
                highlights: ['Lagoon views', 'Premium steaks', 'Fresh seafood', 'Extensive wine list', 'Live music'],
                included: null,
                notIncluded: null,
                tips: 'Reservations recommended. Sunset dining is spectacular. Great for special celebrations.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Restaurant_Review-g150807-d1021178-Reviews-Puerto_Madero_Cancun-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'la-habichuela',
                name: 'La Habichuela Sunset',
                category: 'restaurant',
                type: 'Mexican/Mayan Cuisine',
                area: 'cancun',
                areaName: 'Cancun Hotel Zone',
                lat: 21.1352,
                lng: -86.7534,
                rating: 4.6,
                reviewCount: 5432,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$',
                priceAdult: 55,
                priceChild: 25,
                duration: '2 hours',
                hours: '1:00 PM - 11:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://www.lahabichuela.com',
                bookingUrl: 'https://www.lahabichuela.com/reservaciones',
                description: 'Award-winning Mayan-Mexican cuisine in romantic garden setting. Famous for Cochinita Pibil.',
                highlights: ['Mayan cuisine', 'Garden setting', 'Cochinita Pibil', 'Seafood', 'Romantic atmosphere'],
                included: null,
                notIncluded: null,
                tips: 'Try the signature Cochinita Pibil and Xtabentun cocktails. Reservations essential for dinner.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Restaurant_Review-g150807-d1554462-Reviews-La_Habichuela_Sunset-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'lorenzillos',
                name: "Lorenzillo's",
                category: 'restaurant',
                type: 'Seafood/Lobster',
                area: 'cancun',
                areaName: 'Cancun Hotel Zone',
                lat: 21.0876,
                lng: -86.7699,
                rating: 4.4,
                reviewCount: 6789,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$$',
                priceAdult: 80,
                priceChild: 35,
                duration: '2 hours',
                hours: '12:00 PM - 11:30 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://www.lorenzillos.com.mx',
                bookingUrl: 'https://www.opentable.com/r/lorenzillos-cancun',
                description: 'Legendary lobster house on the lagoon since 1983. Pick your lobster from the tank!',
                highlights: ['Live lobster selection', 'Lagoon views', 'Sunset dining', 'Premium seafood', 'Iconic Cancun spot'],
                included: null,
                notIncluded: null,
                tips: 'Lobster priced by weight - can get expensive! Lagoon-side tables are best. Institution since 1983.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Restaurant_Review-g150807-d1047011-Reviews-Lorenzillo_s-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // SHOPPING & ENTERTAINMENT
            {
                id: 'la-isla',
                name: 'La Isla Shopping Village',
                category: 'shopping',
                type: 'Shopping Center',
                area: 'cancun',
                areaName: 'Cancun Hotel Zone',
                lat: 21.0876,
                lng: -86.7621,
                rating: 4.3,
                reviewCount: 4567,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 0,
                priceChild: 0,
                duration: '2-4 hours',
                hours: '10:00 AM - 10:00 PM',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: 'https://laislacancun.mx',
                bookingUrl: null,
                description: 'Open-air shopping center with canals, restaurants, aquarium, and entertainment.',
                highlights: ['Interactive Aquarium', 'Canals with boat rides', 'Restaurants', 'Shops', 'Movie theater'],
                included: null,
                notIncluded: null,
                tips: 'Interactive Aquarium is fun for kids. Free to walk around. Good rainy day option.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150807-d155476-Reviews-La_Isla_Shopping_Village-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'quinta-avenida',
                name: '5th Avenue (Quinta Avenida)',
                category: 'shopping',
                type: 'Pedestrian Street',
                area: 'riviera',
                areaName: 'Playa del Carmen',
                lat: 20.6274,
                lng: -87.0739,
                rating: 4.4,
                reviewCount: 12345,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 0,
                priceChild: 0,
                duration: '2-4 hours',
                hours: 'Open 24 hours (shops 10 AM - 11 PM)',
                kidFriendly: true,
                kidAgeMin: 0,
                wheelchairAccessible: true,
                website: null,
                bookingUrl: null,
                description: 'Vibrant pedestrian street with shops, restaurants, street performers, and nightlife.',
                highlights: ['Street performers', 'Restaurants', 'Bars', 'Shopping', 'People watching'],
                included: null,
                notIncluded: null,
                tips: 'Haggling expected in shops. Gets lively at night. Many restaurants with street-side seating.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150812-d155509-Reviews-Quinta_Avenida-Playa_del_Carmen_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            // FAMILY ACTIVITIES
            {
                id: 'crococun',
                name: 'Crococun Zoo',
                category: 'family',
                type: 'Zoo/Wildlife',
                area: 'costa',
                areaName: 'Costa Mujeres',
                lat: 21.1502,
                lng: -86.8159,
                rating: 4.6,
                reviewCount: 3456,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 35,
                priceChild: 25,
                duration: '2-3 hours',
                hours: '9:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 2,
                wheelchairAccessible: 'partial',
                website: 'https://www.crococunzoo.com',
                bookingUrl: 'https://www.crococunzoo.com/tours',
                description: 'Interactive zoo where you can hold crocodiles, feed monkeys, and touch spider monkeys.',
                highlights: ['Hold baby crocodiles', 'Feed spider monkeys', 'See deer', 'Interactive experience', 'Guided tour'],
                included: ['Guided tour', 'All animal interactions'],
                notIncluded: ['Photos', 'Tips'],
                tips: 'Kids love holding baby crocs! All tours are guided. Great for animal-loving kids.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150807-d155554-Reviews-Crococun_Zoo-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'ventura-park',
                name: 'Ventura Park',
                category: 'family',
                type: 'Water/Theme Park',
                area: 'cancun',
                areaName: 'Cancun Hotel Zone',
                lat: 21.0996,
                lng: -86.7648,
                rating: 4.2,
                reviewCount: 2345,
                ratingSource: 'TripAdvisor',
                priceRange: '$$',
                priceAdult: 45,
                priceChild: 35,
                duration: '4-6 hours',
                hours: '10:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 3,
                wheelchairAccessible: 'partial',
                website: 'https://www.venturapark.com',
                bookingUrl: 'https://www.venturapark.com/tickets',
                description: 'Water park, zip-lines, go-karts, and attractions all in one. Good for teens and tweens.',
                highlights: ['Water slides', 'Zip-lines', 'Go-karts', 'Bungee', 'Dolphin encounter'],
                included: ['Selected package activities'],
                notIncluded: ['Premium activities', 'Food', 'Dolphin experience (extra)'],
                tips: 'Multiple packages available - check what you want. Good option for teens who want thrills.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150807-d155556-Reviews-Ventura_Park-Cancun_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            },
            {
                id: 'dolphin-discovery',
                name: 'Dolphin Discovery',
                category: 'family',
                type: 'Animal Encounter',
                area: 'cancun',
                areaName: 'Cancun (Isla Mujeres)',
                lat: 21.2428,
                lng: -86.7302,
                rating: 4.5,
                reviewCount: 8765,
                ratingSource: 'TripAdvisor',
                priceRange: '$$$',
                priceAdult: 129,
                priceChild: 99,
                duration: '3-4 hours',
                hours: '9:00 AM - 5:00 PM',
                kidFriendly: true,
                kidAgeMin: 1,
                wheelchairAccessible: true,
                website: 'https://www.dolphindiscovery.com',
                bookingUrl: 'https://www.dolphindiscovery.com/cancun-isla-mujeres/',
                description: 'Swim with dolphins at multiple locations. Various programs from encounter to swim.',
                highlights: ['Dolphin swim', 'Dolphin encounter', 'Photo packages', 'Royal swim option', 'Multiple locations'],
                included: ['Dolphin program', 'Locker', 'Wetsuit if needed'],
                notIncluded: ['Photos ($$$)', 'Transportation', 'Food'],
                tips: 'Photos are expensive - consider bringing underwater camera. Multiple locations in area. Book in advance.',
                source: {
                    name: 'TripAdvisor',
                    url: 'https://www.tripadvisor.com/Attraction_Review-g150809-d155489-Reviews-Dolphin_Discovery_Isla_Mujeres-Isla_Mujeres_Yucatan_Peninsula.html',
                    lastVerified: '2025-01-15'
                },
                addedBy: 'system',
                verified: true
            }
        ];

        // User-contributed attractions (stored in localStorage)
        const USER_ATTRACTIONS_KEY = 'cancunUserAttractions';
        function getUserAttractions() {
            const stored = localStorage.getItem(USER_ATTRACTIONS_KEY);
            return stored ? JSON.parse(stored) : [];
        }
        function saveUserAttraction(attraction) {
            const userAttractions = getUserAttractions();
            attraction.id = 'user-' + Date.now();
            attraction.addedBy = 'family';
            attraction.verified = false;
            attraction.source = {
                name: 'Family Suggestion',
                url: null,
                lastVerified: new Date().toISOString().split('T')[0]
            };
            userAttractions.push(attraction);
            localStorage.setItem(USER_ATTRACTIONS_KEY, JSON.stringify(userAttractions));
            return attraction;
        }
        function getAllAttractions() {
            return [...attractions, ...getUserAttractions()];
        }

        // Category configuration for icons and colors
        const categoryConfig = {
            'eco-park': { icon: 'ðŸŒ¿', color: '#10b981', label: 'Eco-Parks' },
            'ruins': { icon: 'ðŸ›ï¸', color: '#8b5cf6', label: 'Ruins & History' },
            'cenote': { icon: 'ðŸ’§', color: '#06b6d4', label: 'Cenotes' },
            'island': { icon: 'ðŸï¸', color: '#f59e0b', label: 'Islands' },
            'water-activity': { icon: 'ðŸ¤¿', color: '#0284c7', label: 'Water Activities' },
            'restaurant': { icon: 'ðŸ½ï¸', color: '#ef4444', label: 'Restaurants' },
            'shopping': { icon: 'ðŸ›ï¸', color: '#ec4899', label: 'Shopping' },
            'family': { icon: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', color: '#f97316', label: 'Family Fun' }
        };

        // Family members for voting
        const familyMembers = [
            "Alex", "Andrew", "Cindy", "Mom", "Dad", "Aunt",
            "Dann", "Dann's Husband", "Beckett 1", "Beckett 2"
        ];

        // Initialize map
        let map;
        let markers = [];
        let selectedResort = null;

        function initMap() {
            map = L.map('map').setView([20.8, -87.1], 9);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                maxZoom: 19
            }).addTo(map);

            // Add airport marker
            const airportIcon = L.divIcon({
                className: 'custom-marker',
                html: '<div style="background:#1e40af;color:white;padding:6px 10px;border-radius:6px;font-weight:bold;font-size:11px;white-space:nowrap;">CUN Airport</div>',
                iconSize: [80, 30]
            });
            L.marker([21.0365, -86.8770], {icon: airportIcon}).addTo(map);

            renderMarkers();
        }

        // =====================
        // EXPLORE MODE
        // =====================
        let mapMode = 'resorts'; // 'resorts' or 'explore'
        let attractionMarkers = [];
        let selectedAttraction = null;
        let exploreFilters = {
            category: 'all',
            area: 'all',
            kidFriendlyOnly: false
        };

        function setMapMode(mode) {
            mapMode = mode;

            // Update toggle buttons
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.mode === mode);
            });

            // Show/hide filter panels
            document.getElementById('resortFilters').style.display = mode === 'resorts' ? 'block' : 'none';
            document.getElementById('exploreFilters').style.display = mode === 'explore' ? 'block' : 'none';

            // Clear and re-render markers
            if (mode === 'resorts') {
                clearAttractionMarkers();
                renderMarkers();
            } else {
                markers.forEach(m => map.removeLayer(m));
                markers = [];
                renderAttractionMarkers();
                renderAttractionList();
            }
        }

        function clearAttractionMarkers() {
            attractionMarkers.forEach(m => map.removeLayer(m));
            attractionMarkers = [];
        }

        function getFilteredAttractions() {
            return getAllAttractions().filter(a => {
                if (exploreFilters.category !== 'all' && a.category !== exploreFilters.category) return false;
                if (exploreFilters.area !== 'all' && a.area !== exploreFilters.area) return false;
                if (exploreFilters.kidFriendlyOnly && !a.kidFriendly) return false;
                return true;
            });
        }

        function filterAttractions(category) {
            exploreFilters.category = category;

            // Update active chip
            document.querySelectorAll('.explore-chip').forEach(chip => {
                chip.classList.toggle('active', chip.dataset.category === category);
            });

            renderAttractionMarkers();
            renderAttractionList();
        }

        function filterAttractionsByArea(area) {
            exploreFilters.area = area;

            // Update active chip
            document.querySelectorAll('[data-explore-area]').forEach(chip => {
                chip.classList.toggle('active', chip.dataset.exploreArea === area);
            });

            renderAttractionMarkers();
            renderAttractionList();
        }

        function toggleKidFriendly() {
            exploreFilters.kidFriendlyOnly = document.getElementById('kidFriendlyFilter').checked;
            renderAttractionMarkers();
            renderAttractionList();
        }

        function renderAttractionMarkers() {
            clearAttractionMarkers();
            const filtered = getFilteredAttractions();

            filtered.forEach(attraction => {
                const config = categoryConfig[attraction.category] || { icon: 'ðŸ“', color: '#64748b' };
                const icon = L.divIcon({
                    className: 'attraction-marker',
                    html: `<div style="background:${config.color};color:white;padding:4px 8px;border-radius:8px;font-size:1.1rem;box-shadow:0 2px 8px rgba(0,0,0,0.3);border:2px solid white;display:flex;align-items:center;gap:4px;">
                        <span>${config.icon}</span>
                    </div>`,
                    iconSize: [40, 30],
                    iconAnchor: [20, 15]
                });

                const marker = L.marker([attraction.lat, attraction.lng], { icon }).addTo(map);
                marker.on('click', () => {
                    selectedAttraction = attraction;
                    openAttractionModal(attraction);
                    renderAttractionList();
                });
                attractionMarkers.push(marker);
            });

            document.getElementById('attractionCount').textContent = filtered.length;
        }

        function renderAttractionList() {
            const container = document.getElementById('attractionList');
            const filtered = getFilteredAttractions();

            container.innerHTML = filtered.map(a => {
                const config = categoryConfig[a.category] || { icon: 'ðŸ“' };
                const isSelected = selectedAttraction && selectedAttraction.id === a.id;
                return `
                    <div class="attraction-card ${isSelected ? 'selected' : ''}" onclick="selectAttraction('${a.id}')">
                        <div class="attraction-header">
                            <span class="attraction-icon">${config.icon}</span>
                            <span class="attraction-name">${a.name}</span>
                            <span class="attraction-rating">â˜… ${a.rating}</span>
                        </div>
                        <div class="attraction-meta">
                            <span class="attraction-type">${a.type}</span>
                            <span class="attraction-price">${a.priceRange}</span>
                            ${a.addedBy === 'family' ? '<span style="color:#10b981;">ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ Family Pick</span>' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function selectAttraction(id) {
            const attraction = getAllAttractions().find(a => a.id === id);
            if (attraction) {
                selectedAttraction = attraction;
                map.flyTo([attraction.lat, attraction.lng], 13);
                openAttractionModal(attraction);
                renderAttractionList();
            }
        }

        function openAttractionModal(attraction) {
            const config = categoryConfig[attraction.category] || { icon: 'ðŸ“', color: '#64748b' };

            document.getElementById('modalAttractionIcon').textContent = config.icon;
            document.getElementById('modalAttractionName').textContent = attraction.name;
            document.getElementById('modalAttractionType').textContent = attraction.type + ' â€¢ ' + attraction.areaName;
            document.getElementById('modalRating').textContent = attraction.rating;
            document.getElementById('modalReviewCount').textContent = `(${attraction.reviewCount?.toLocaleString() || 'N/A'} reviews on ${attraction.ratingSource || 'N/A'})`;
            document.getElementById('modalPriceRange').textContent = attraction.priceRange + (attraction.priceAdult ? ` (~$${attraction.priceAdult}/person)` : '');
            document.getElementById('modalDuration').textContent = attraction.duration || '';
            document.getElementById('modalDescription').textContent = attraction.description || '';
            document.getElementById('modalArea').textContent = attraction.areaName;
            document.getElementById('modalHours').textContent = attraction.hours || 'Check website';

            // Highlights
            const highlightsEl = document.getElementById('modalHighlights');
            if (attraction.highlights && attraction.highlights.length > 0) {
                highlightsEl.innerHTML = attraction.highlights.map(h => `<span class="highlight-tag">${h}</span>`).join('');
            } else {
                highlightsEl.innerHTML = '<span style="color:#64748b;">No highlights listed</span>';
            }

            // Included
            const includedSection = document.getElementById('modalIncludedSection');
            const includedEl = document.getElementById('modalIncluded');
            if (attraction.included && attraction.included.length > 0) {
                includedEl.innerHTML = attraction.included.map(i => `<div>âœ“ ${i}</div>`).join('');
                includedSection.style.display = 'block';
            } else {
                includedSection.style.display = 'none';
            }

            // Not Included
            const notIncludedSection = document.getElementById('modalNotIncludedSection');
            const notIncludedEl = document.getElementById('modalNotIncluded');
            if (attraction.notIncluded && attraction.notIncluded.length > 0) {
                notIncludedEl.innerHTML = attraction.notIncluded.map(i => `<div>âœ— ${i}</div>`).join('');
                notIncludedSection.style.display = 'block';
            } else {
                notIncludedSection.style.display = 'none';
            }

            // Tips
            document.getElementById('modalTips').textContent = attraction.tips || 'No tips available';

            // Accessibility & Kid-friendly
            const accessEl = document.getElementById('modalAccessibility');
            if (attraction.wheelchairAccessible === true) {
                accessEl.innerHTML = '<span style="color:#10b981;">â™¿ Wheelchair Accessible</span>';
            } else if (attraction.wheelchairAccessible === 'partial') {
                accessEl.innerHTML = '<span style="color:#f59e0b;">â™¿ Partially Accessible</span>';
            } else {
                accessEl.innerHTML = '<span style="color:#ef4444;">â™¿ Limited Accessibility</span>';
            }

            const kidEl = document.getElementById('modalKidFriendly');
            if (attraction.kidFriendly) {
                kidEl.innerHTML = `<span style="color:#10b981;">ðŸ‘¶ Kid-Friendly ${attraction.kidAgeMin > 0 ? `(Ages ${attraction.kidAgeMin}+)` : '(All ages)'}</span>`;
            } else {
                kidEl.innerHTML = '<span style="color:#f59e0b;">ðŸ‘¶ Check age restrictions</span>';
            }

            // Source/Provenance
            const sourceEl = document.getElementById('modalSource');
            if (attraction.source) {
                const verified = attraction.verified ? '<span class="source-verified">âœ“ Verified</span>' : '<span style="color:#f59e0b;">Unverified</span>';
                sourceEl.innerHTML = `
                    ${verified}
                    <span>Source: ${attraction.source.name}</span>
                    <span>â€¢</span>
                    <span>Last checked: ${attraction.source.lastVerified}</span>
                    ${attraction.source.url ? `<a href="${attraction.source.url}" target="_blank" style="color:#0891b2;">View Source â†’</a>` : ''}
                `;
            } else {
                sourceEl.innerHTML = '<span>No source information available</span>';
            }

            // Buttons
            const bookingBtn = document.getElementById('modalBookingBtn');
            if (attraction.bookingUrl || attraction.website) {
                bookingBtn.href = attraction.bookingUrl || attraction.website;
                bookingBtn.style.display = 'flex';
            } else {
                bookingBtn.style.display = 'none';
            }

            const sourceBtn = document.getElementById('modalSourceBtn');
            if (attraction.source && attraction.source.url) {
                sourceBtn.href = attraction.source.url;
                sourceBtn.style.display = 'flex';
            } else {
                sourceBtn.style.display = 'none';
            }

            // Update header color based on category
            document.getElementById('attractionModalHeader').style.background = `linear-gradient(135deg, ${config.color} 0%, ${config.color}dd 100%)`;

            document.getElementById('attractionModal').classList.add('active');
        }

        function closeAttractionModal() {
            document.getElementById('attractionModal').classList.remove('active');
        }

        function openAddAttractionModal() {
            document.getElementById('addAttractionModal').classList.add('active');
        }

        function closeAddAttractionModal() {
            document.getElementById('addAttractionModal').classList.remove('active');
        }

        function submitNewAttraction() {
            const name = document.getElementById('addAttractionName').value.trim();
            const category = document.getElementById('addAttractionCategory').value;
            const area = document.getElementById('addAttractionArea').value;
            const description = document.getElementById('addAttractionDescription').value.trim();
            const price = document.getElementById('addAttractionPrice').value;
            const website = document.getElementById('addAttractionWebsite').value.trim();
            const reason = document.getElementById('addAttractionReason').value.trim();
            const kidFriendly = document.getElementById('addAttractionKidFriendly').checked;

            if (!name) {
                alert('Please enter a name for the attraction');
                return;
            }

            const areaNames = {
                'cancun': 'Cancun',
                'riviera': 'Riviera Maya',
                'tulum': 'Tulum',
                'costa': 'Costa Mujeres',
                'inland': 'Inland'
            };

            // Default coordinates based on area (approximate)
            const areaCoords = {
                'cancun': { lat: 21.1619, lng: -86.8515 },
                'riviera': { lat: 20.6296, lng: -87.0739 },
                'tulum': { lat: 20.2114, lng: -87.4654 },
                'costa': { lat: 21.2567, lng: -86.8054 },
                'inland': { lat: 20.6843, lng: -88.5678 }
            };

            const newAttraction = {
                name,
                category,
                type: categoryConfig[category]?.label || category,
                area,
                areaName: areaNames[area] || area,
                lat: areaCoords[area]?.lat || 21.0,
                lng: areaCoords[area]?.lng || -87.0,
                rating: 0,
                reviewCount: 0,
                ratingSource: 'Not yet rated',
                priceRange: price ? '$'.repeat(Math.min(4, Math.ceil(parseInt(price) / 50))) : '$$',
                priceAdult: price ? parseInt(price) : null,
                description: description || reason || 'Family suggestion - no description provided',
                highlights: reason ? [reason] : [],
                kidFriendly,
                website: website || null,
                bookingUrl: website || null,
                tips: 'This was suggested by a family member. Verify before booking!'
            };

            saveUserAttraction(newAttraction);
            closeAddAttractionModal();

            // Clear form
            document.getElementById('addAttractionName').value = '';
            document.getElementById('addAttractionDescription').value = '';
            document.getElementById('addAttractionPrice').value = '';
            document.getElementById('addAttractionWebsite').value = '';
            document.getElementById('addAttractionReason').value = '';

            // Refresh the list
            renderAttractionMarkers();
            renderAttractionList();

            alert('Thanks! Your suggestion has been added.');
        }

        // Close modals on background click
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('attraction-modal')) {
                e.target.classList.remove('active');
            }
        });

        function getMarkerColor(resort) {
            if (resort.isVilla) return '#8b5cf6';
            if (resort.accessible) return '#f97316';
            if (resort.points) return '#0891b2';
            if (resort.luxury) return '#f59e0b';
            if (resort.adultsOnly) return '#ef4444';
            if (resort.family) return '#10b981';
            return '#64748b';
        }

        function renderMarkers() {
            // Clear existing markers
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            const filtered = getFilteredResorts();

            filtered.forEach(resort => {
                const color = getMarkerColor(resort);
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="width:20px;height:20px;background:${color};border-radius:50%;border:3px solid white;box-shadow:0 2px 6px rgba(0,0,0,0.3);"></div>`,
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });

                const marker = L.marker([resort.lat, resort.lng], {icon}).addTo(map);
                marker.on('click', () => showResortInfo(resort));
                markers.push(marker);
            });

            document.getElementById('filteredCount').textContent = filtered.length;
            renderResortList(filtered);
        }

        function getFilteredResorts() {
            const areaFilter = document.querySelector('.chip[data-filter="area"].active')?.dataset.value || 'all';
            const priceFilter = document.querySelector('.chip[data-filter="price"].active')?.dataset.value || 'all';
            const featureFilters = Array.from(document.querySelectorAll('.chip[data-filter="feature"].active')).map(c => c.dataset.value);

            return resorts.filter(r => {
                if (areaFilter !== 'all' && r.area !== areaFilter) return false;

                if (priceFilter === 'budget' && r.priceMay24 >= 300) return false;
                if (priceFilter === 'mid' && (r.priceMay24 < 300 || r.priceMay24 >= 500)) return false;
                if (priceFilter === 'luxury' && r.priceMay24 < 500) return false;

                if (featureFilters.includes('family') && !r.family) return false;
                if (featureFilters.includes('accessible') && !r.accessible) return false;
                if (featureFilters.includes('points') && !r.points) return false;
                if (featureFilters.includes('luxury') && !r.luxury) return false;
                if (featureFilters.includes('villa') && !r.isVilla) return false;

                return true;
            });
        }

        function renderResortList(filtered) {
            const list = document.getElementById('resortList');
            list.innerHTML = filtered.map(r => {
                const dealBadge = getDealBadge(r);
                const dealBadgeHTML = dealBadge ? `<span class="deal-badge ${dealBadge.class}" style="font-size:0.6rem;padding:2px 6px;">${dealBadge.icon} ${dealBadge.text}</span>` : '';

                return `
                <div class="resort-card ${selectedResort?.id === r.id ? 'selected' : ''}" onclick="showResortInfo(resorts.find(x => x.id === ${r.id}))">
                    <div class="resort-header">
                        <span class="resort-name">${r.name}</span>
                        <span class="resort-rating">${r.valueScore ? '<span style="background:' + (r.valueScore >= 8 ? '#059669' : r.valueScore >= 6 ? '#d97706' : '#dc2626') + ';color:white;padding:2px 6px;border-radius:4px;font-size:0.7rem;margin-right:6px;">' + r.valueScore + '/10</span>' : ''}â˜… ${r.rating}</span>
                    </div>
                    ${dealBadgeHTML ? `<div style="margin-bottom:6px;">${dealBadgeHTML}</div>` : ''}
                    <div class="resort-location">${r.areaName} â€¢ ${r.airportDist} from CUN</div>
                    <div class="resort-tags">
                        ${r.isVilla ? '<span class="tag tag-villa">VILLA ' + r.bedrooms + 'BR</span>' : ''}
                        ${r.family ? '<span class="tag tag-family">Family</span>' : ''}
                        ${r.adultsOnly ? '<span class="tag tag-adults">Adults Only</span>' : ''}
                        ${r.luxury ? '<span class="tag tag-luxury">Luxury</span>' : ''}
                        ${r.points ? '<span class="tag tag-points">' + r.points.toUpperCase() + '</span>' : ''}
                        ${r.accessible ? '<span class="tag tag-accessible">Accessible</span>' : ''}
                    </div>
                    <div class="resort-price">
                        <div>
                            <span class="price-value">$${r.priceMay24}</span>
                            <span class="price-label">/night May 24-31</span>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function showResortInfo(resort) {
            selectedResort = resort;
            const panel = document.getElementById('infoPanel');
            document.getElementById('panelTitle').textContent = resort.name;
            document.getElementById('panelSubtitle').textContent = `${resort.areaName} â€¢ ${resort.airportDist} from airport`;

            // Villas: price is for entire villa; Resorts: price per room
            const isVilla = resort.isVilla;
            const total7May = isVilla ? resort.priceMay24 * 7 : resort.priceMay24 * 7 * 7;
            const total7Jun = isVilla ? resort.priceMay31 * 7 : resort.priceMay31 * 7 * 7;
            const priceLabel = isVilla ? '/night (entire villa)' : '/night per room';
            const totalLabel = isVilla ? 'Est. Total (7 nights entire villa)' : 'Est. Total (7 rooms Ã— 7 nights)';

            // Get deal info
            const dealBadge = getDealBadge(resort);
            const trendHTML = getTrendIndicator(resort);

            document.getElementById('panelBody').innerHTML = `
                ${dealBadge ? `
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:15px;flex-wrap:wrap;">
                    <span class="deal-badge ${dealBadge.class}">${dealBadge.icon} ${dealBadge.text}</span>
                    ${trendHTML}
                </div>
                ` : (trendHTML ? `<div style="margin-bottom:15px;">${trendHTML}</div>` : '')}

                ${isVilla ? `
                <div class="info-section" style="background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%); color: white; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                    <div style="font-size: 1.1rem; font-weight: 700; margin-bottom: 8px;">Private Villa Rental</div>
                    <div style="display: flex; gap: 20px;">
                        <div><span style="opacity: 0.8;">Bedrooms:</span> <strong>${resort.bedrooms}</strong></div>
                        <div><span style="opacity: 0.8;">Sleeps:</span> <strong>${resort.sleeps}</strong></div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.85rem; opacity: 0.9;">Full staff, chef, and concierge typically included</div>
                </div>
                ` : ''}

                <div class="info-section">
                    <div class="info-section-title">Price Calculator</div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
                        <div>
                            <label style="font-size:0.75rem;color:#64748b;display:block;margin-bottom:4px;">Start Date</label>
                            <select id="priceStartDate" onchange="updatePriceCalc()" style="width:100%;padding:8px;border:2px solid #e2e8f0;border-radius:8px;font-size:0.85rem;font-weight:500;">
                                <option value="may24" selected>May 24, 2025</option>
                                <option value="may31">May 31, 2025</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-size:0.75rem;color:#64748b;display:block;margin-bottom:4px;">Duration</label>
                            <select id="priceDuration" onchange="updatePriceCalc()" style="width:100%;padding:8px;border:2px solid #e2e8f0;border-radius:8px;font-size:0.85rem;font-weight:500;">
                                <option value="4">4 nights</option>
                                <option value="5">5 nights</option>
                                <option value="6">6 nights</option>
                                <option value="7" selected>7 nights</option>
                            </select>
                        </div>
                    </div>
                    <div id="priceCalcResult" style="background:linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);padding:15px;border-radius:12px;border:2px solid #10b981;">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                            <div style="text-align:center;">
                                <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">Per Room/Night</div>
                                <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${resort.priceMay24.toLocaleString()}</div>
                            </div>
                            <div style="text-align:center;">
                                <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">${isVilla ? 'Total (Villa)' : '7 Rooms Total'}</div>
                                <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${(isVilla ? resort.priceMay24 * 7 : resort.priceMay24 * 7 * 7).toLocaleString()}</div>
                            </div>
                        </div>
                        <div style="margin-top:12px;padding-top:12px;border-top:1px solid #a7f3d0;text-align:center;">
                            <div style="font-size:0.75rem;color:#166534;" id="priceCalcDates">May 24 - May 31, 2025 (7 nights)</div>
                        </div>
                    </div>
                    <div style="margin-top:10px;font-size:0.75rem;color:#64748b;text-align:center;">
                        ${isVilla ? 'Prices are for entire villa per night' : 'All-inclusive per room/night â€¢ 7 rooms needed for group of 14'}
                    </div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Details</div>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-item-label">Rating</div>
                            <div class="info-item-value">â˜… ${resort.rating} (${resort.reviews.toLocaleString()})</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Type</div>
                            <div class="info-item-value">${resort.adultsOnly ? 'Adults Only' : 'Family'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Accessible</div>
                            <div class="info-item-value">${resort.accessible ? 'âœ“ Yes' : 'âœ— No'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Points</div>
                            <div class="info-item-value">${resort.points ? resort.points.toUpperCase() : 'N/A'}</div>
                        </div>
                    </div>
                </div>

                ${resort.points ? `
                <div class="info-section">
                    <div class="info-section-title">Points Redemption</div>
                    <div style="padding:12px;background:#e0e7ff;border-radius:8px;">
                        <div style="font-weight:600;color:#4f46e5;">${resort.pointsCost}</div>
                        <div style="font-size:0.8rem;color:#666;margin-top:4px;">Points cover full all-inclusive package</div>
                    </div>
                </div>
                ` : ''}

                ${resort.insiderTip ? `
                <div class="info-section" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 15px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                    <div class="info-section-title" style="color: #92400e; display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 1.2rem;">ðŸ”</span> Insider Intel
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 1.3rem; font-weight: 700; color: ${resort.valueScore >= 8 ? '#059669' : resort.valueScore >= 6 ? '#d97706' : '#dc2626'};">${resort.valueScore}/10</div>
                            <div style="font-size: 0.7rem; color: #666;">VALUE SCORE</div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">${resort.serviceRating || 'N/A'}</div>
                            <div style="font-size: 0.7rem; color: #666;">SERVICE</div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">${resort.crowdLevel || 'N/A'}</div>
                            <div style="font-size: 0.7rem; color: #666;">CROWDS</div>
                        </div>
                    </div>
                    <div style="font-size: 0.8rem; color: #78350f; margin-bottom: 8px;"><strong>Renovated:</strong> ${resort.renovated || 'Unknown'}</div>
                    <p style="font-size: 0.85rem; color: #78350f; line-height: 1.5; margin: 0;">${resort.insiderTip}</p>
                </div>
                ` : ''}

                ${getHiddenCostsHTML(resort)}

                ${getSavingsHTML(resort)}

                <div class="info-section">
                    <div class="info-section-title">Features</div>
                    <ul style="list-style:none;display:flex;flex-wrap:wrap;gap:6px;">
                        ${resort.features.map(f => `<li style="background:#f1f5f9;padding:4px 10px;border-radius:4px;font-size:0.8rem;">${f}</li>`).join('')}
                    </ul>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Notes</div>
                    <p style="font-size:0.9rem;color:#666;line-height:1.6;">${resort.notes}</p>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Links & Booking</div>
                    <div class="link-list">
                        <a href="${resort.website}" target="_blank" class="link-item">
                            <span class="link-icon website">ðŸŒ</span>
                            Official Website
                        </a>
                        <a href="${resort.tripadvisor}" target="_blank" class="link-item">
                            <span class="link-icon reviews">â˜…</span>
                            TripAdvisor Reviews
                        </a>
                        <a href="https://www.google.com/maps/search/${encodeURIComponent(resort.name + ' ' + resort.areaName + ' Mexico')}" target="_blank" class="link-item">
                            <span class="link-icon" style="background:#dcfce7;color:#166534;">ðŸ“</span>
                            Google Maps & Reviews
                        </a>
                        ${resort.points === 'hyatt' ? `
                        <a href="https://world.hyatt.com/content/gp/en/rewards/free-nights-upgrades.html" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            World of Hyatt Rewards
                        </a>
                        ` : ''}
                        ${resort.points === 'marriott' ? `
                        <a href="https://all-inclusive.marriott.com/" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            Marriott All-Inclusive
                        </a>
                        ` : ''}
                        ${resort.points === 'hilton' ? `
                        <a href="https://www.hilton.com/en/hilton-honors/" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            Hilton Honors
                        </a>
                        ` : ''}
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                        <div style="font-size: 0.7rem; color: #64748b; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Compare Prices (May 24-31, 2025)</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                            <a href="https://www.expedia.com/Hotel-Search?destination=${encodeURIComponent(resort.name + ', Cancun, Mexico')}&startDate=2025-05-24&endDate=2025-05-31&rooms=1&adults=2" target="_blank" style="text-decoration:none;padding:10px 8px;background:#fef3c7;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#fde68a'" onmouseout="this.style.background='#fef3c7'">
                                <div style="font-size:0.7rem;color:#92400e;font-weight:600;">Expedia</div>
                            </a>
                            <a href="https://www.booking.com/searchresults.html?ss=${encodeURIComponent(resort.name + ' Cancun')}&checkin=2025-05-24&checkout=2025-05-31&group_adults=2&no_rooms=1" target="_blank" style="text-decoration:none;padding:10px 8px;background:#dbeafe;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#bfdbfe'" onmouseout="this.style.background='#dbeafe'">
                                <div style="font-size:0.7rem;color:#1e40af;font-weight:600;">Booking.com</div>
                            </a>
                            <a href="https://www.hotels.com/search.do?destination=${encodeURIComponent(resort.name + ' Cancun Mexico')}&startDate=2025-05-24&endDate=2025-05-31&rooms=1&adults=2" target="_blank" style="text-decoration:none;padding:10px 8px;background:#fee2e2;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#fecaca'" onmouseout="this.style.background='#fee2e2'">
                                <div style="font-size:0.7rem;color:#991b1b;font-weight:600;">Hotels.com</div>
                            </a>
                        </div>
                    </div>
                </div>
            `;

            panel.classList.add('active');
            renderResortList(getFilteredResorts());

            // Pan map to resort
            map.panTo([resort.lat, resort.lng]);
        }

        function closeInfoPanel() {
            document.getElementById('infoPanel').classList.remove('active');
            selectedResort = null;
            renderResortList(getFilteredResorts());
        }

        function updatePriceCalc() {
            if (!selectedResort) return;
            const startDate = document.getElementById('priceStartDate').value;
            const nights = parseInt(document.getElementById('priceDuration').value);

            const basePrice = startDate === 'may24' ? selectedResort.priceMay24 : selectedResort.priceMay31;
            const isVilla = selectedResort.isVilla;

            // Calculate totals
            const perNight = basePrice;
            const totalGroup = isVilla ? basePrice * nights : basePrice * 7 * nights; // 7 rooms for group

            // Calculate date range
            const startDates = {
                'may24': { start: 'May 24', month: 5, day: 24 },
                'may31': { start: 'May 31', month: 5, day: 31 }
            };
            const sd = startDates[startDate];
            let endDay = sd.day + nights;
            let endMonth = 'May';
            if (endDay > 31) {
                endDay = endDay - 31;
                endMonth = 'Jun';
            }
            const dateRange = `${sd.start} - ${endMonth} ${endDay}, 2025 (${nights} nights)`;

            // Update the display
            document.getElementById('priceCalcResult').innerHTML = `
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                    <div style="text-align:center;">
                        <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">Per Room/Night</div>
                        <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${perNight.toLocaleString()}</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">${isVilla ? 'Total (Villa)' : '7 Rooms Total'}</div>
                        <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${totalGroup.toLocaleString()}</div>
                    </div>
                </div>
                <div style="margin-top:12px;padding-top:12px;border-top:1px solid #a7f3d0;text-align:center;">
                    <div style="font-size:0.75rem;color:#166534;">${dateRange}</div>
                </div>
            `;
        }

        // Filter handling
        document.querySelectorAll('.chip[data-filter="area"]').forEach(chip => {
            chip.addEventListener('click', () => {
                document.querySelectorAll('.chip[data-filter="area"]').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                renderMarkers();
            });
        });

        document.querySelectorAll('.chip[data-filter="price"]').forEach(chip => {
            chip.addEventListener('click', () => {
                document.querySelectorAll('.chip[data-filter="price"]').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                renderMarkers();
            });
        });

        document.querySelectorAll('.chip[data-filter="feature"]').forEach(chip => {
            chip.addEventListener('click', () => {
                chip.classList.toggle('active');
                renderMarkers();
            });
        });

        // Tab navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(`view-${tab.dataset.view}`).classList.add('active');

                if (tab.dataset.view === 'map' && map) {
                    setTimeout(() => map.invalidateSize(), 100);
                }
            });
        });

        // Matrix rendering
        function renderMatrix() {
            const tbody = document.getElementById('matrixBody');
            const familyResorts = resorts.filter(r => r.family).sort((a, b) => {
                // Sort villas at the end, otherwise by price
                if (a.isVilla && !b.isVilla) return 1;
                if (!a.isVilla && b.isVilla) return -1;
                return a.priceMay24 - b.priceMay24;
            });

            tbody.innerHTML = familyResorts.map(r => {
                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const priceNote = isVilla ? ' (villa)' : '';
                const rowStyle = isVilla ? 'background: #f5f3ff;' : '';
                return `
                <tr style="${rowStyle}">
                    <td><strong>${r.name}</strong>${isVilla ? '<br><span style="color:#8b5cf6;font-size:0.75rem;">PRIVATE VILLA â€¢ ' + r.bedrooms + ' BR</span>' : ''}</td>
                    <td>${r.areaName}</td>
                    <td><span class="airport-badge">${r.airportDist}</span></td>
                    <td><strong>$${r.priceMay24.toLocaleString()}</strong>/night${priceNote}</td>
                    <td>$${r.priceMay31.toLocaleString()}/night${priceNote}</td>
                    <td style="color:#059669;font-weight:700;">$${total7.toLocaleString()}</td>
                    <td class="check-yes">âœ“</td>
                    <td class="${r.accessible ? 'check-yes' : 'check-no'}">${r.accessible ? 'âœ“' : 'â€”'}</td>
                    <td>${r.points ? `<span style="color:#4f46e5;font-weight:600;">${r.points.toUpperCase()}</span>` : 'â€”'}</td>
                    <td>â˜… ${r.rating}</td>
                    <td>
                        <a href="${r.website}" target="_blank" style="margin-right:8px;">Website</a>
                        <a href="${r.tripadvisor}" target="_blank">Reviews</a>
                    </td>
                </tr>
            `}).join('');
        }

        // Voting System with Cloud Sync
        const VOTE_KEY = 'cancunVacationVotes2025';
        const VOTER_NAME_KEY = 'cancunVoterName';
        const ROOM_CODE = 'STINARD2025';
        const SYNC_INTERVAL = 5000;
        let currentVoter = null;
        let showAllResorts = false;
        let quickPickStep = 0;
        let quickPickAnswers = {};
        let cachedVotes = {};
        let syncEnabled = true;
        let lastSyncTime = 0;

        // Top 4 recommended resorts for quick decision
        const TOP_4_RESORTS = [
            { id: 2, reason: "Best accessibility + great value" },
            { id: 11, reason: "Built for multigenerational families" },
            { id: 16, reason: "Parks included = huge savings" },
            { id: 44, reason: "Private villa with sea turtles" }
        ];

        // Cloud sync using ntfy.sh for real-time updates
        const SYNC_TOPIC = `cancun-votes-${ROOM_CODE.toLowerCase()}`;
        let eventSource = null;

        function initSync() {
            try {
                eventSource = new EventSource(`https://ntfy.sh/${SYNC_TOPIC}/sse`);
                eventSource.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        if (data.message && data.message.startsWith('{')) {
                            const votes = JSON.parse(data.message);
                            if (votes._timestamp > lastSyncTime) {
                                cachedVotes = votes;
                                lastSyncTime = votes._timestamp || Date.now();
                                localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
                                renderVotingOptions();
                                updateVotingResults();
                                showSyncNotification('Votes updated!');
                            }
                        }
                    } catch (e) {}
                };
                eventSource.onerror = () => console.log('Sync connection lost, will retry...');
                console.log('Real-time vote sync enabled!');
            } catch (e) {
                console.log('Real-time sync not available');
            }
        }

        function showSyncNotification(message) {
            const existing = document.querySelector('.sync-notification');
            if (existing) existing.remove();
            const notif = document.createElement('div');
            notif.className = 'sync-notification';
            notif.textContent = message;
            notif.style.cssText = `
                position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
                background: #10b981; color: white; padding: 12px 24px; border-radius: 30px;
                font-weight: 600; font-size: 0.9rem; z-index: 9999; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            `;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 2000);
        }

        function getVotes() {
            if (Object.keys(cachedVotes).length > 0) {
                return { ...cachedVotes };
            }
            const stored = JSON.parse(localStorage.getItem(VOTE_KEY) || '{}');
            cachedVotes = stored;
            return stored;
        }

        function saveVotes(votes) {
            votes._timestamp = Date.now();
            cachedVotes = votes;
            lastSyncTime = votes._timestamp;
            localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
            // Broadcast to cloud
            if (syncEnabled) {
                fetch(`https://ntfy.sh/${SYNC_TOPIC}`, {
                    method: 'POST',
                    body: JSON.stringify(votes)
                }).catch(() => {});
            }
        }

        // Remember voter name across sessions
        function getSavedVoterName() {
            return localStorage.getItem(VOTER_NAME_KEY);
        }

        function saveVoterName(name) {
            localStorage.setItem(VOTER_NAME_KEY, name);
        }

        function renderVoterSelect() {
            const container = document.getElementById('voterSelect');
            const savedName = getSavedVoterName();

            // Auto-select saved voter on first render
            if (!currentVoter && savedName && familyMembers.includes(savedName)) {
                currentVoter = savedName;
            }

            container.innerHTML = `
                <div style="margin-bottom:10px;font-size:0.85rem;opacity:0.8;">Who's voting?</div>
                <div style="display:flex;flex-wrap:wrap;gap:8px;justify-content:center;">
                    ${familyMembers.map(m =>
                        `<button class="voter-btn ${currentVoter === m ? 'active' : ''}" onclick="selectVoter('${m}')">${m}</button>`
                    ).join('')}
                </div>
            `;
        }

        function selectVoter(name) {
            currentVoter = name;
            saveVoterName(name); // Remember for next time
            renderVoterSelect();
            renderTopResorts();
            updateVotingProgress();
            updateVotingResults();
            showToast(`Welcome, ${name}!`);
        }

        function updateVotingProgress() {
            const votes = getVotes();
            const voterCount = Object.keys(votes).filter(v => votes[v].resort).length;
            const progressBar = document.getElementById('progressBar');
            const voterCountEl = document.getElementById('voterCount');

            if (progressBar && voterCountEl) {
                const percent = (voterCount / 14) * 100;
                progressBar.style.width = `${percent}%`;
                voterCountEl.textContent = voterCount;
            }

            // Show reveal button when all 14 have voted (or simulate for testing)
            const revealBtn = document.getElementById('revealBtn');
            if (revealBtn && voterCount >= 1) { // Change to 14 for production
                revealBtn.style.display = 'inline-block';
            }
        }

        function renderTopResorts() {
            const topContainer = document.getElementById('topResortsGrid');
            const moreContainer = document.getElementById('moreResortsGrid');
            const showMoreBtn = document.getElementById('showMoreResortsBtn');

            if (!topContainer) return;

            const votes = getVotes();
            const familyResorts = resorts.filter(r => r.family && r.valueScore >= 7);

            // Render top 4
            const top4 = TOP_4_RESORTS.map(t => ({
                ...resorts.find(r => r.id === t.id),
                reason: t.reason
            })).filter(r => r);

            topContainer.innerHTML = top4.map(r => renderResortVoteCard(r, votes)).join('');

            // Render remaining resorts
            const remainingResorts = familyResorts.filter(r => !TOP_4_RESORTS.find(t => t.id === r.id));
            moreContainer.innerHTML = remainingResorts.map(r => renderResortVoteCard(r, votes)).join('');

            // Update show more button text
            if (showMoreBtn) {
                showMoreBtn.textContent = showAllResorts
                    ? 'Show less â–²'
                    : `Show ${remainingResorts.length} more resorts â–¼`;
            }
        }

        function renderResortVoteCard(resort, votes) {
            const resortVotes = Object.entries(votes).filter(([_, v]) => v.resort === resort.name);
            const isSelected = currentVoter && votes[currentVoter]?.resort === resort.name;
            const budgetFit = getBudgetFit(resort);

            return `
                <div class="resort-vote-card ${isSelected ? 'selected' : ''}" onclick="voteForResort('${resort.name}')">
                    <div class="resort-vote-name">${resort.name}</div>
                    <div class="resort-vote-detail">
                        ${resort.areaName} â€¢ â˜…${resort.rating}
                        ${resort.reason ? `<br><em style="color:#059669;">${resort.reason}</em>` : ''}
                    </div>
                    <div class="resort-vote-price">
                        $${resort.priceMay24}/night
                        <span class="budget-badge ${budgetFit.class}" style="font-size:0.7rem;margin-left:8px;">${budgetFit.label}</span>
                    </div>
                    <div class="resort-vote-voters">
                        ${resortVotes.map(([name]) => `<span class="vote-avatar">${name.charAt(0)}</span>`).join('')}
                        <span style="font-size:0.8rem;color:#64748b;">${resortVotes.length} vote${resortVotes.length !== 1 ? 's' : ''}</span>
                    </div>
                </div>
            `;
        }

        function voteForResort(resortName) {
            if (!currentVoter) {
                showToast('Please select your name first!');
                return;
            }

            const votes = getVotes();
            if (!votes[currentVoter]) votes[currentVoter] = {};
            votes[currentVoter].resort = resortName;
            saveVotes(votes);

            renderTopResorts();
            updateVotingProgress();
            updateVotingResults();
            showToast(`Vote saved for ${resortName}!`);
        }

        function toggleMoreResorts() {
            showAllResorts = !showAllResorts;
            const moreContainer = document.getElementById('moreResortsGrid');
            const btn = document.getElementById('showMoreResortsBtn');

            moreContainer.style.display = showAllResorts ? 'grid' : 'none';
            btn.textContent = showAllResorts ? 'Show less â–²' : 'Show all resorts â–¼';
        }

        // Quick Pick Wizard
        const QUICK_PICK_QUESTIONS = [
            {
                question: "What's most important for your family?",
                options: [
                    { value: 'accessibility', label: 'â™¿ Accessibility (wheelchair, mobility needs)', icon: 'â™¿' },
                    { value: 'kids', label: 'ðŸ‘¶ Kid-friendly activities & pools', icon: 'ðŸ‘¶' },
                    { value: 'value', label: 'ðŸ’° Best value for money', icon: 'ðŸ’°' },
                    { value: 'luxury', label: 'âœ¨ Premium experience', icon: 'âœ¨' }
                ]
            },
            {
                question: "Preferred location vibe?",
                options: [
                    { value: 'hotel-zone', label: 'ðŸ™ï¸ Hotel Zone - walkable, near nightlife', icon: 'ðŸ™ï¸' },
                    { value: 'riviera', label: 'ðŸŒ´ Riviera Maya - quieter, nature', icon: 'ðŸŒ´' },
                    { value: 'private', label: 'ðŸ  Private villa - just our family', icon: 'ðŸ ' },
                    { value: 'any', label: 'ðŸ¤· No preference', icon: 'ðŸ¤·' }
                ]
            },
            {
                question: "Budget priority?",
                options: [
                    { value: 'under-budget', label: 'ðŸ“‰ Keep it under $20K total', icon: 'ðŸ“‰' },
                    { value: 'sweet-spot', label: 'ðŸŽ¯ Sweet spot $20-25K', icon: 'ðŸŽ¯' },
                    { value: 'worth-it', label: 'ðŸ’Ž Worth it if it\'s perfect', icon: 'ðŸ’Ž' }
                ]
            }
        ];

        function startQuickPick() {
            quickPickStep = 1;
            quickPickAnswers = {};
            renderQuickPickQuestion();
        }

        function renderQuickPickQuestion() {
            const container = document.getElementById('quickPickContainer');
            if (quickPickStep > QUICK_PICK_QUESTIONS.length) {
                renderQuickPickResult();
                return;
            }

            const q = QUICK_PICK_QUESTIONS[quickPickStep - 1];
            container.innerHTML = `
                <div class="quick-pick-question">
                    <div style="font-size:0.8rem;color:#92400e;margin-bottom:10px;">Question ${quickPickStep} of ${QUICK_PICK_QUESTIONS.length}</div>
                    <h4>${q.question}</h4>
                    <div class="quick-pick-options">
                        ${q.options.map(opt => `
                            <div class="quick-pick-option" onclick="answerQuickPick('${q.options[0].value.split('-')[0]}', '${opt.value}')">
                                <span style="font-size:1.3rem;margin-right:10px;">${opt.icon}</span>
                                ${opt.label}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function answerQuickPick(category, value) {
            quickPickAnswers[`q${quickPickStep}`] = value;
            quickPickStep++;
            renderQuickPickQuestion();
        }

        function renderQuickPickResult() {
            const container = document.getElementById('quickPickContainer');

            // Simple recommendation logic based on answers
            let recommendedId = 2; // Default: Hard Rock (good all-rounder)
            let reason = "Great for families with excellent accessibility";

            if (quickPickAnswers.q1 === 'accessibility') {
                recommendedId = 2; // Hard Rock
                reason = "Best-in-class wheelchair accessibility and family amenities";
            } else if (quickPickAnswers.q1 === 'value' || quickPickAnswers.q3 === 'under-budget') {
                recommendedId = 44; // Villa
                reason = "Private villa at lowest per-person cost";
            } else if (quickPickAnswers.q2 === 'private') {
                recommendedId = 44; // Villa
                reason = "Private beachfront villa just for your family";
            } else if (quickPickAnswers.q1 === 'kids') {
                recommendedId = 16; // Xcaret
                reason = "Parks included - kids will have endless activities";
            } else if (quickPickAnswers.q1 === 'luxury' || quickPickAnswers.q3 === 'worth-it') {
                recommendedId = 11; // Grand Velas
                reason = "Premium multigenerational resort experience";
            } else if (quickPickAnswers.q2 === 'riviera') {
                recommendedId = 16; // Xcaret
                reason = "Eco-resort in beautiful Riviera Maya";
            }

            const resort = resorts.find(r => r.id === recommendedId);
            const budgetFit = getBudgetFit(resort);

            container.innerHTML = `
                <div class="quick-pick-result">
                    <h4>ðŸŽ¯ We recommend...</h4>
                    <div class="quick-pick-resort-card">
                        <div style="font-size:1.5rem;font-weight:700;color:#1e293b;margin-bottom:8px;">${resort.name}</div>
                        <div style="color:#059669;font-weight:600;margin-bottom:15px;">${reason}</div>
                        <div style="display:flex;justify-content:center;gap:15px;flex-wrap:wrap;">
                            <span style="background:#f1f5f9;padding:6px 12px;border-radius:6px;">$${resort.priceMay24}/night</span>
                            <span style="background:#f1f5f9;padding:6px 12px;border-radius:6px;">â˜… ${resort.rating}</span>
                            <span class="budget-badge ${budgetFit.class}">${budgetFit.label}</span>
                        </div>
                    </div>
                    <button onclick="useQuickPickVote('${resort.name}')" style="background:linear-gradient(135deg, #10b981 0%, #059669 100%);color:white;border:none;padding:12px 30px;border-radius:8px;font-weight:600;cursor:pointer;margin-right:10px;">
                        âœ“ Use This As My Vote
                    </button>
                    <button onclick="resetQuickPick()" style="background:#e2e8f0;color:#64748b;border:none;padding:12px 20px;border-radius:8px;font-weight:600;cursor:pointer;">
                        Try Again
                    </button>
                </div>
            `;
        }

        function useQuickPickVote(resortName) {
            if (!currentVoter) {
                showToast('Please select your name first!');
                return;
            }
            voteForResort(resortName);
            resetQuickPick();
        }

        function resetQuickPick() {
            quickPickStep = 0;
            quickPickAnswers = {};
            document.getElementById('quickPickContainer').innerHTML = `
                <div class="quick-pick-intro">
                    <p>Not sure which resort? Answer 3 quick questions and we'll recommend the best fit!</p>
                    <button onclick="startQuickPick()" class="quick-pick-start-btn">Start Quick Pick â†’</button>
                </div>
            `;
        }

        // Legacy function compatibility
        function renderVotingOptions() {
            renderTopResorts();
            updateVoteOptionDisplay('week');
            updateVoteOptionDisplay('length');
        }

        function updateVoteOptionDisplay(category) {
            const votes = getVotes();
            document.querySelectorAll(`[data-category="${category}"]`).forEach(option => {
                const value = option.dataset.value;
                const optionVotes = Object.entries(votes).filter(([_, v]) => v[category] === value);
                const isSelected = currentVoter && votes[currentVoter]?.[category] === value;

                option.classList.toggle('selected', isSelected);
                option.querySelector('.vote-count-display').textContent = `${optionVotes.length} vote${optionVotes.length !== 1 ? 's' : ''}`;
                option.querySelector('.vote-avatars').innerHTML = optionVotes.map(([name]) =>
                    `<span class="vote-avatar">${name.charAt(0)}</span>`
                ).join('');
            });
        }

        function castVote(category, value) {
            if (!currentVoter) {
                alert('Please select your name first!');
                return;
            }

            const votes = getVotes();
            if (!votes[currentVoter]) votes[currentVoter] = {};
            votes[currentVoter][category] = value;
            saveVotes(votes);

            renderVotingOptions();
            updateVotingResults();
        }

        // Add click handlers for week and length options
        document.querySelectorAll('[data-category="week"], [data-category="length"]').forEach(option => {
            option.addEventListener('click', () => {
                castVote(option.dataset.category, option.dataset.value);
            });
        });

        function updateVotingResults() {
            const votes = getVotes();
            const results = document.getElementById('votingResults');
            const totalVoters = Object.keys(votes).length;

            if (totalVoters === 0) {
                results.innerHTML = '<p>No votes yet. Select your name and start voting!</p>';
                return;
            }

            // Count votes
            const resortCounts = {};
            const weekCounts = {};
            const lengthCounts = {};

            Object.values(votes).forEach(v => {
                if (v.resort) resortCounts[v.resort] = (resortCounts[v.resort] || 0) + 1;
                if (v.week) weekCounts[v.week] = (weekCounts[v.week] || 0) + 1;
                if (v.length) lengthCounts[v.length] = (lengthCounts[v.length] || 0) + 1;
            });

            const topResort = Object.entries(resortCounts).sort((a, b) => b[1] - a[1])[0];
            const topWeek = Object.entries(weekCounts).sort((a, b) => b[1] - a[1])[0];
            const topLength = Object.entries(lengthCounts).sort((a, b) => b[1] - a[1])[0];

            results.innerHTML = `
                <div class="result-item">
                    <span class="result-label">Total Votes</span>
                    <span class="result-value">${totalVoters} family members</span>
                </div>
                ${topResort ? `
                <div class="result-item">
                    <span class="result-label">Leading Resort</span>
                    <span class="result-value">${topResort[0]} (${topResort[1]} votes)</span>
                </div>
                ` : ''}
                ${topWeek ? `
                <div class="result-item">
                    <span class="result-label">Leading Week</span>
                    <span class="result-value">${topWeek[0] === 'may24' ? 'May 24-31' : 'May 31 - Jun 7'} (${topWeek[1]} votes)</span>
                </div>
                ` : ''}
                ${topLength ? `
                <div class="result-item">
                    <span class="result-label">Trip Length</span>
                    <span class="result-value">${topLength[0]} nights (${topLength[1]} votes)</span>
                </div>
                ` : ''}
            `;

            // Update ranked choice results
            updateRankedResults();
            updateVotingProgress();
        }

        // Confetti Celebration
        function launchConfetti() {
            const canvas = document.getElementById('confettiCanvas');
            canvas.style.display = 'block';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const ctx = canvas.getContext('2d');

            const confetti = [];
            const colors = ['#10b981', '#f59e0b', '#3b82f6', '#ef4444', '#8b5cf6', '#ec4899'];

            // Create confetti pieces
            for (let i = 0; i < 150; i++) {
                confetti.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    r: Math.random() * 6 + 4,
                    d: Math.random() * 150 + 10,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    tilt: Math.random() * 10 - 5,
                    tiltAngle: Math.random() * Math.PI,
                    tiltSpeed: Math.random() * 0.1 + 0.05
                });
            }

            let animationFrame;
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                confetti.forEach((c, i) => {
                    ctx.beginPath();
                    ctx.lineWidth = c.r / 2;
                    ctx.strokeStyle = c.color;
                    ctx.moveTo(c.x + c.tilt + c.r / 4, c.y);
                    ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r / 4);
                    ctx.stroke();

                    c.y += 3;
                    c.tiltAngle += c.tiltSpeed;
                    c.tilt = Math.sin(c.tiltAngle) * 15;

                    if (c.y > canvas.height) {
                        confetti[i].y = -10;
                        confetti[i].x = Math.random() * canvas.width;
                    }
                });

                animationFrame = requestAnimationFrame(animate);
            }

            animate();

            // Stop after 4 seconds
            setTimeout(() => {
                cancelAnimationFrame(animationFrame);
                canvas.style.display = 'none';
            }, 4000);
        }

        // Reveal Winner with Celebration
        function revealWinner() {
            const votes = getVotes();
            const resortCounts = {};

            Object.values(votes).forEach(v => {
                if (v.resort) resortCounts[v.resort] = (resortCounts[v.resort] || 0) + 1;
            });

            const sorted = Object.entries(resortCounts).sort((a, b) => b[1] - a[1]);
            if (sorted.length === 0) {
                showToast('No votes yet!');
                return;
            }

            const winner = sorted[0];
            const winnerResort = resorts.find(r => r.name === winner[0]);
            const celebration = document.getElementById('winnerCelebration');

            celebration.style.display = 'block';
            celebration.innerHTML = `
                <div class="winner-celebration">
                    <div class="winner-title">ðŸŽ‰ WE'RE GOING TO... ðŸŽ‰</div>
                    <div class="winner-resort">${winner[0]}</div>
                    <div style="font-size:1.1rem;opacity:0.9;margin-bottom:20px;">
                        ${winner[1]} votes â€¢ ${winnerResort?.areaName || ''} â€¢ $${winnerResort?.priceMay24 || 0}/night
                    </div>
                    <div style="font-size:3rem;margin:20px 0;">ðŸŒ´ðŸŒŠâ˜€ï¸ðŸ–ï¸</div>
                </div>
            `;

            launchConfetti();

            // Scroll to celebration
            celebration.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        // Export Results as shareable text
        function exportResults() {
            const votes = getVotes();
            const resortCounts = {};
            const weekCounts = {};

            Object.values(votes).forEach(v => {
                if (v.resort) resortCounts[v.resort] = (resortCounts[v.resort] || 0) + 1;
                if (v.week) weekCounts[v.week] = (weekCounts[v.week] || 0) + 1;
            });

            const sortedResorts = Object.entries(resortCounts).sort((a, b) => b[1] - a[1]);
            const totalVoters = Object.keys(votes).length;

            let text = `ðŸŒ´ CANCUN 2025 FAMILY VOTE RESULTS ðŸŒ´\n\n`;
            text += `ðŸ“Š ${totalVoters} of 14 family members have voted\n\n`;

            text += `ðŸ† RESORT RANKINGS:\n`;
            sortedResorts.forEach(([name, count], i) => {
                const medal = i === 0 ? 'ðŸ¥‡' : i === 1 ? 'ðŸ¥ˆ' : i === 2 ? 'ðŸ¥‰' : '  ';
                text += `${medal} ${name}: ${count} vote${count !== 1 ? 's' : ''}\n`;
            });

            text += `\nðŸ“… PREFERRED WEEK:\n`;
            Object.entries(weekCounts).forEach(([week, count]) => {
                const label = week === 'may24' ? 'May 24-31' : 'May 31 - Jun 7';
                text += `â€¢ ${label}: ${count} vote${count !== 1 ? 's' : ''}\n`;
            });

            text += `\nðŸ”— Vote at: ${window.location.href}`;

            // Copy to clipboard
            navigator.clipboard.writeText(text).then(() => {
                showToast('Results copied! Share with family ðŸ“¤');
            }).catch(() => {
                // Fallback: show in alert
                alert(text);
            });
        }

        // ============================================
        // RANKED CHOICE VOTING
        // ============================================

        let rankedChoices = {}; // Store each voter's rankings

        function getRankedChoices() {
            const stored = localStorage.getItem('rankedChoices');
            return stored ? JSON.parse(stored) : {};
        }

        function saveRankedChoices(choices) {
            localStorage.setItem('rankedChoices', JSON.stringify(choices));
        }

        function renderRankedOptions() {
            const container = document.getElementById('rankedResortOptions');
            if (!container) return;

            rankedChoices = getRankedChoices();
            const voterRankings = rankedChoices[currentVoter] || [];

            // Top family-friendly resorts for ranked choice
            const topResorts = resorts.filter(r => r.family && r.valueScore >= 7).slice(0, 8);

            container.innerHTML = topResorts.map(r => {
                const rankIndex = voterRankings.indexOf(r.id);
                const isRanked = rankIndex !== -1;
                const rankNum = rankIndex + 1;
                const budgetFit = getBudgetFit(r);

                return `
                    <div class="ranked-option ${isRanked ? 'ranked' : ''}" onclick="toggleRank(${r.id})" data-resort-id="${r.id}">
                        <div class="rank-number">${isRanked ? rankNum : '-'}</div>
                        <div class="ranked-option-info">
                            <div class="ranked-option-name">${r.name}</div>
                            <div class="ranked-option-detail">${r.areaName} â€¢ $${r.priceMay24}/night â€¢ ${budgetFit.label}</div>
                        </div>
                        <div style="font-size:0.8rem;color:#64748b;">${r.valueScore}/10</div>
                    </div>
                `;
            }).join('');
        }

        function toggleRank(resortId) {
            if (!currentVoter) {
                alert('Please select your name first!');
                return;
            }

            rankedChoices = getRankedChoices();
            if (!rankedChoices[currentVoter]) rankedChoices[currentVoter] = [];

            const rankings = rankedChoices[currentVoter];
            const idx = rankings.indexOf(resortId);

            if (idx !== -1) {
                // Remove from rankings
                rankings.splice(idx, 1);
            } else if (rankings.length < 5) {
                // Add to rankings (max 5)
                rankings.push(resortId);
            } else {
                alert('You can only rank up to 5 resorts. Remove one first!');
                return;
            }

            saveRankedChoices(rankedChoices);
            renderRankedOptions();
            updateRankedResults();
        }

        function submitRankedVotes() {
            if (!currentVoter) {
                alert('Please select your name first!');
                return;
            }

            rankedChoices = getRankedChoices();
            const rankings = rankedChoices[currentVoter] || [];

            if (rankings.length === 0) {
                alert('Please rank at least one resort!');
                return;
            }

            showToast(`Rankings saved for ${currentVoter}! ${rankings.length} resort(s) ranked.`);
            updateRankedResults();
        }

        function updateRankedResults() {
            rankedChoices = getRankedChoices();
            const voters = Object.keys(rankedChoices);

            if (voters.length === 0) return;

            // Calculate Borda count scores (1st = 5pts, 2nd = 4pts, etc.)
            const scores = {};

            voters.forEach(voter => {
                const rankings = rankedChoices[voter] || [];
                rankings.forEach((resortId, index) => {
                    const points = 5 - index; // 5 for 1st, 4 for 2nd, etc.
                    scores[resortId] = (scores[resortId] || 0) + points;
                });
            });

            // Sort by score
            const sortedResults = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5);

            // Update the results panel if it exists
            const resultsDiv = document.getElementById('votingResults');
            if (resultsDiv && sortedResults.length > 0) {
                const rankedResultsHtml = `
                    <div style="margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.2);">
                        <h4 style="margin-bottom:15px;">ðŸ† Ranked Choice Results</h4>
                        ${sortedResults.map(([resortId, score], idx) => {
                            const resort = resorts.find(r => r.id === parseInt(resortId));
                            const posClass = idx === 0 ? 'gold' : idx === 1 ? 'silver' : idx === 2 ? 'bronze' : '';
                            return `
                                <div class="ranked-result-item">
                                    <div class="ranked-result-position ${posClass}">${idx + 1}</div>
                                    <div style="flex-grow:1;">
                                        <div style="font-weight:600;">${resort?.name || 'Unknown'}</div>
                                        <div style="font-size:0.8rem;opacity:0.8;">${score} points from ${voters.length} voter(s)</div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;

                // Append or replace ranked results
                const existingRanked = resultsDiv.querySelector('.ranked-results-section');
                if (existingRanked) {
                    existingRanked.innerHTML = rankedResultsHtml;
                } else {
                    const rankedSection = document.createElement('div');
                    rankedSection.className = 'ranked-results-section';
                    rankedSection.innerHTML = rankedResultsHtml;
                    resultsDiv.appendChild(rankedSection);
                }
            }
        }

        // ============================================
        // DEAL FINDER & BUDGET CALCULATOR
        // ============================================

        // Family Budget Target
        const BUDGET_TARGET = {
            min: 20000,
            max: 25000,
            sweet: 22500 // Middle of the range
        };

        // Price History Data (would be loaded from JSON in production)
        const priceHistory = {
            1: { trend: "down", percentChange: -9.5, lowestSeen: 380, avgPrice: 400, dealThreshold: 360 },
            2: { trend: "down", percentChange: -5.9, lowestSeen: 299, avgPrice: 335, dealThreshold: 300 },
            3: { trend: "down", percentChange: -7.9, lowestSeen: 320, avgPrice: 365, dealThreshold: 330 },
            4: { trend: "stable", percentChange: -4.0, lowestSeen: 450, avgPrice: 495, dealThreshold: 460 },
            11: { trend: "down", percentChange: -6.7, lowestSeen: 380, avgPrice: 435, dealThreshold: 400 },
            12: { trend: "down", percentChange: -5.2, lowestSeen: 520, avgPrice: 565, dealThreshold: 530 },
            16: { trend: "down", percentChange: -7.7, lowestSeen: 450, avgPrice: 500, dealThreshold: 460 },
            41: { trend: "down", percentChange: -4.7, lowestSeen: 2700, avgPrice: 2925, dealThreshold: 2750 },
            44: { trend: "down", percentChange: -5.7, lowestSeen: 1500, avgPrice: 1700, dealThreshold: 1550 }
        };

        // Hidden Costs Data
        const hiddenCosts = {
            1: { resortFee: 0, tips: 0, transfer: 85, extras: 25, freeTransfer: false },
            2: { resortFee: 0, tips: 0, transfer: 90, extras: 15, freeTransfer: false },
            3: { resortFee: 0, tips: 0, transfer: 0, extras: 40, freeTransfer: true, resortCredits: 1500 },
            4: { resortFee: 0, tips: 0, transfer: 95, extras: 20, freeTransfer: false },
            11: { resortFee: 0, tips: 0, transfer: 0, extras: 10, freeTransfer: true },
            12: { resortFee: 0, tips: 0, transfer: 0, extras: 15, freeTransfer: true },
            16: { resortFee: 0, tips: 0, transfer: 0, extras: 0, freeTransfer: true, parksIncluded: true, parksValue: 1200 },
            41: { resortFee: 0, tips: 350, transfer: 180, extras: 200, freeTransfer: false, isVilla: true },
            44: { resortFee: 0, tips: 200, transfer: 200, extras: 150, freeTransfer: false, isVilla: true }
        };

        // All-inclusive value data
        const allInclusiveValue = {
            1: { costPerMeal: 42, retailValue: 700, savingsVsRetail: 320, valueRating: "Good" },
            2: { costPerMeal: 36, retailValue: 680, savingsVsRetail: 360, valueRating: "Excellent" },
            4: { costPerMeal: 53, retailValue: 850, savingsVsRetail: 370, valueRating: "Good" },
            11: { costPerMeal: 47, retailValue: 900, savingsVsRetail: 480, valueRating: "Exceptional" },
            12: { costPerMeal: 61, retailValue: 1100, savingsVsRetail: 550, valueRating: "Premium" },
            16: { costPerMeal: 53, retailValue: 1500, savingsVsRetail: 1020, valueRating: "BEST VALUE" }
        };

        // Get deal badge for a resort
        function getDealBadge(resort) {
            const history = priceHistory[resort.id];
            if (!history) {
                // For resorts without history, use value score
                if (resort.valueScore >= 9) return { class: 'good-value', text: 'Good Value', icon: 'ðŸ’š' };
                if (resort.valueScore >= 7) return { class: 'premium', text: 'Fair Price', icon: 'âš–ï¸' };
                return null;
            }

            const currentPrice = resort.priceMay24;

            // Hot deal: at or below deal threshold
            if (currentPrice <= history.dealThreshold) {
                return { class: 'hot-deal', text: 'Hot Deal!', icon: 'ðŸ”¥' };
            }

            // Price drop: trending down significantly
            if (history.trend === 'down' && history.percentChange <= -5) {
                return { class: 'price-drop', text: `${Math.abs(history.percentChange).toFixed(0)}% Drop`, icon: 'ðŸ“‰' };
            }

            // Good value: below average price
            if (currentPrice < history.avgPrice) {
                return { class: 'good-value', text: 'Good Value', icon: 'ðŸ’š' };
            }

            // Premium: above average
            if (currentPrice > history.avgPrice * 1.1) {
                return { class: 'premium', text: 'Premium', icon: 'â­' };
            }

            return null;
        }

        // Get trend indicator HTML
        function getTrendIndicator(resort) {
            const history = priceHistory[resort.id];
            if (!history) return '';

            const arrow = history.trend === 'down' ? 'â†“' : history.trend === 'up' ? 'â†‘' : 'â†’';
            const label = history.trend === 'down' ? 'prices falling' : history.trend === 'up' ? 'prices rising' : 'stable';

            return `<span class="trend-indicator ${history.trend}">${arrow} ${Math.abs(history.percentChange).toFixed(1)}% ${label}</span>`;
        }

        // Generate hidden costs HTML for info panel
        function getHiddenCostsHTML(resort) {
            const costs = hiddenCosts[resort.id];
            if (!costs) return '';

            let items = [];

            if (costs.freeTransfer) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Airport Transfer</span><span class="cost-value included">FREE!</span></div>`);
            } else if (costs.transfer > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Airport Transfer (each way)</span><span class="cost-value">~$${costs.transfer}/person</span></div>`);
            }

            if (costs.tips > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Suggested Staff Tips</span><span class="cost-value">$${costs.tips}/day</span></div>`);
            } else {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Gratuities</span><span class="cost-value included">Included</span></div>`);
            }

            if (costs.extras > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Est. Daily Extras</span><span class="cost-value">~$${costs.extras}/day</span></div>`);
            }

            if (costs.resortCredits) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Resort Credits</span><span class="cost-value included">+$${costs.resortCredits}!</span></div>`);
            }

            if (costs.parksIncluded) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Xcaret Parks</span><span class="cost-value included">ALL INCLUDED ($${costs.parksValue}+ value)!</span></div>`);
            }

            if (items.length === 0) return '';

            return `
                <div class="hidden-costs-panel">
                    <div class="hidden-costs-title">
                        <span>ðŸ’°</span> Hidden Costs Breakdown
                    </div>
                    ${items.join('')}
                </div>
            `;
        }

        // Generate savings summary HTML
        function getSavingsHTML(resort) {
            const history = priceHistory[resort.id];
            const costs = hiddenCosts[resort.id];
            const aiValue = allInclusiveValue[resort.id];

            let savings = [];
            let totalSavings = 0;

            // Price vs average
            if (history && resort.priceMay24 < history.avgPrice) {
                const priceSaving = Math.round((history.avgPrice - resort.priceMay24) * 7 * 7);
                savings.push({ label: 'Below avg price (7 rooms Ã— 7 nights)', amount: priceSaving });
                totalSavings += priceSaving;
            }

            // Free transfer
            if (costs && costs.freeTransfer) {
                const transferSaving = 100 * 14; // Approx $100/person for transfers
                savings.push({ label: 'Free airport transfer (14 people)', amount: transferSaving });
                totalSavings += transferSaving;
            }

            // Resort credits
            if (costs && costs.resortCredits) {
                savings.push({ label: 'Resort credits', amount: costs.resortCredits });
                totalSavings += costs.resortCredits;
            }

            // Parks included
            if (costs && costs.parksIncluded) {
                savings.push({ label: 'Parks included value', amount: costs.parksValue });
                totalSavings += costs.parksValue;
            }

            // All-inclusive value
            if (aiValue && aiValue.savingsVsRetail > 300) {
                const aiSaving = aiValue.savingsVsRetail * 7;
                savings.push({ label: 'All-inclusive vs retail (7 nights)', amount: aiSaving });
                totalSavings += aiSaving;
            }

            if (savings.length === 0) return '';

            return `
                <div class="savings-panel">
                    <div class="savings-title">
                        <span>ðŸŽ‰</span> Potential Savings
                    </div>
                    ${savings.map(s => `
                        <div class="savings-item">
                            <span>${s.label}</span>
                            <span style="font-weight:600;">+$${s.amount.toLocaleString()}</span>
                        </div>
                    `).join('')}
                    <div class="savings-total">
                        <span>Total Potential Savings</span>
                        <span>$${totalSavings.toLocaleString()}</span>
                    </div>
                </div>
            `;
        }

        // Estimate total trip cost for a resort (quick calculation)
        function estimateTripCost(resort, nights = 7) {
            const isVilla = resort.isVilla;
            const accommodationCost = isVilla ? resort.priceMay24 * nights : resort.priceMay24 * 7 * nights;
            const flightCost = 5330; // Fixed estimate for 14 people
            const transferCost = hiddenCosts[resort.id]?.freeTransfer ? 0 : 360;
            const excursionCost = hiddenCosts[resort.id]?.parksIncluded ? 1400 : 2800; // Reduced if parks included
            const extrasCost = (hiddenCosts[resort.id]?.extras || 20) * nights;

            return accommodationCost + flightCost + transferCost + excursionCost + extrasCost;
        }

        // Check if resort fits budget
        function getBudgetFit(resort, nights = 7) {
            const total = estimateTripCost(resort, nights);

            if (total <= BUDGET_TARGET.min) {
                return { status: 'under', label: 'Under Budget!', class: 'budget-under', diff: BUDGET_TARGET.min - total };
            } else if (total <= BUDGET_TARGET.max) {
                return { status: 'sweet', label: 'In Budget!', class: 'budget-sweet', diff: 0 };
            } else {
                return { status: 'over', label: 'Over Budget', class: 'budget-over', diff: total - BUDGET_TARGET.max };
            }
        }

        // Comparison feature
        let compareList = [];

        function toggleCompare(resortId) {
            const idx = compareList.indexOf(resortId);
            if (idx > -1) {
                compareList.splice(idx, 1);
            } else if (compareList.length < 4) {
                compareList.push(resortId);
            }
            updateComparisonPanel();
        }

        function clearComparison() {
            compareList = [];
            updateComparisonPanel();
        }

        function updateComparisonPanel() {
            const panel = document.getElementById('comparisonPanel');
            const grid = document.getElementById('comparisonGrid');
            const count = document.getElementById('compareCount');
            const actions = document.getElementById('comparisonActions');

            count.textContent = compareList.length;

            if (compareList.length === 0) {
                panel.classList.remove('active');
                actions.style.display = 'none';
                return;
            }

            panel.classList.add('active');
            actions.style.display = compareList.length >= 2 ? 'flex' : 'none';

            grid.innerHTML = compareList.map(id => {
                const r = resorts.find(res => res.id === id);
                if (!r) return '';
                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const perPerson = Math.round(total7 / 14);
                const estTrip = estimateTripCost(r);
                const budgetFit = getBudgetFit(r);
                const hiddenCosts = getHiddenCostsForResort(r.id);

                return `
                    <div class="comparison-item">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px;">
                            <h4 style="margin:0;">${r.name}</h4>
                            <button onclick="toggleCompare(${r.id})" style="background:none;border:none;cursor:pointer;font-size:1rem;">âœ•</button>
                        </div>
                        <span class="budget-badge ${budgetFit.class}" style="font-size:0.7rem;">${budgetFit.label}</span>

                        <div class="compare-section">
                            <div class="compare-section-title">Pricing</div>
                            <div class="compare-row"><span>Per night:</span><span>$${r.priceMay24}</span></div>
                            <div class="compare-row"><span>7-night accom:</span><span style="color:#059669;font-weight:600;">$${total7.toLocaleString()}</span></div>
                            <div class="compare-row"><span>Est. total trip:</span><span style="font-weight:600;">$${estTrip.toLocaleString()}</span></div>
                            <div class="compare-row"><span>Per person:</span><span>$${Math.round(estTrip/14).toLocaleString()}</span></div>
                        </div>

                        <div class="compare-section">
                            <div class="compare-section-title">Value</div>
                            <div class="compare-row"><span>Value Score:</span><span>${r.valueScore || 'N/A'}/10</span></div>
                            <div class="compare-row"><span>Rating:</span><span>â˜… ${r.rating} (${r.reviews?.toLocaleString() || 0})</span></div>
                            ${r.points ? `<div class="compare-row"><span>Points:</span><span style="color:#4f46e5;">${r.points.toUpperCase()}</span></div>` : ''}
                        </div>

                        <div class="compare-section">
                            <div class="compare-section-title">Features</div>
                            <div class="compare-amenities">
                                <span class="compare-amenity ${r.family ? 'has' : 'missing'}">${r.family ? 'âœ“' : 'âœ—'} Family</span>
                                <span class="compare-amenity ${r.accessible ? 'has' : 'missing'}">${r.accessible ? 'âœ“' : 'âœ—'} Accessible</span>
                                <span class="compare-amenity ${hiddenCosts.freeTransfer ? 'has' : 'missing'}">${hiddenCosts.freeTransfer ? 'âœ“' : 'âœ—'} Free Transfer</span>
                                <span class="compare-amenity ${hiddenCosts.parksIncluded ? 'has' : 'missing'}">${hiddenCosts.parksIncluded ? 'âœ“' : 'âœ—'} Parks Inc.</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getHiddenCostsForResort(resortId) {
            const costs = {
                1: { freeTransfer: false, parksIncluded: false },
                2: { freeTransfer: false, parksIncluded: false },
                3: { freeTransfer: true, parksIncluded: false, credits: 1500 },
                11: { freeTransfer: true, parksIncluded: false },
                12: { freeTransfer: true, parksIncluded: false },
                16: { freeTransfer: true, parksIncluded: true, parksValue: 1200 },
                41: { freeTransfer: false, parksIncluded: false },
                44: { freeTransfer: false, parksIncluded: false }
            };
            return costs[resortId] || { freeTransfer: false, parksIncluded: false };
        }

        function shareComparison() {
            const ids = compareList.join(',');
            const url = `${window.location.origin}${window.location.pathname}?compare=${ids}`;

            navigator.clipboard.writeText(url).then(() => {
                showToast('Link copied to clipboard!');
            }).catch(() => {
                showToast('Could not copy link');
            });
        }

        function copyComparisonText() {
            const lines = ['ðŸŒ´ Cancun Resort Comparison\n'];

            compareList.forEach(id => {
                const r = resorts.find(res => res.id === id);
                if (!r) return;
                const estTrip = estimateTripCost(r);
                const budgetFit = getBudgetFit(r);

                lines.push(`\nðŸ“ ${r.name}`);
                lines.push(`   ${budgetFit.label} | Est. Total: $${estTrip.toLocaleString()} | Per Person: $${Math.round(estTrip/14).toLocaleString()}`);
                lines.push(`   Rating: â˜…${r.rating} | Value: ${r.valueScore}/10`);
                if (r.points) lines.push(`   Points: ${r.points.toUpperCase()}`);
            });

            lines.push(`\n\nðŸ“… Target: May 24-31, 2025`);
            lines.push(`ðŸ‘¥ 14 people | ðŸ’° Budget: $20K-$25K`);

            navigator.clipboard.writeText(lines.join('\n')).then(() => {
                showToast('Summary copied to clipboard!');
            });
        }

        function showToast(message) {
            const toast = document.getElementById('shareToast');
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        // Check URL for comparison on load
        function loadComparisonFromUrl() {
            const params = new URLSearchParams(window.location.search);
            const compareIds = params.get('compare');
            if (compareIds) {
                compareList = compareIds.split(',').map(Number).filter(id => resorts.find(r => r.id === id));
                updateComparisonPanel();
            }
        }

        // Budget View Mode Toggle
        let budgetMode = 'simple';
        const BUDGET_MODE_KEY = 'cancunBudgetMode';

        function setBudgetMode(mode) {
            budgetMode = mode;
            localStorage.setItem(BUDGET_MODE_KEY, mode);

            const simpleView = document.getElementById('budgetSimpleView');
            const detailedView = document.getElementById('budgetDetailedView');
            const toggleBtns = document.querySelectorAll('.budget-toggle-btn');

            if (mode === 'simple') {
                simpleView.style.display = 'block';
                detailedView.style.display = 'none';
                toggleBtns[0].classList.add('active');
                toggleBtns[1].classList.remove('active');
                updateSimpleBudgetView();
            } else {
                simpleView.style.display = 'none';
                detailedView.style.display = 'block';
                toggleBtns[0].classList.remove('active');
                toggleBtns[1].classList.add('active');
            }
        }

        function updateSimpleBudgetView() {
            // Calculate estimated totals based on default/average values
            const avgResortPrice = 400; // Average nightly rate for family resorts
            const resortCost = avgResortPrice * 7 * 7; // 7 rooms, 7 nights = ~$19,600
            const flightCost = (450 * 3) + (420 * 5) + (280 * 4) + (380 * 2); // All family flights
            const activityCost = 200 * 14; // Moderate activities per person
            const transferCost = 500; // Estimated transfer cost
            const total = resortCost + flightCost + activityCost + transferCost;

            // Update simple view numbers
            const totalEl = document.getElementById('simpleTotalAmount');
            const resortEl = document.getElementById('simpleResortCost');
            const flightEl = document.getElementById('simpleFlightCost');
            const activityEl = document.getElementById('simpleActivityCost');
            const statusEl = document.getElementById('simpleBudgetStatus');

            if (totalEl) totalEl.textContent = `$${total.toLocaleString()}`;
            if (resortEl) resortEl.textContent = `~$${resortCost.toLocaleString()}`;
            if (flightEl) flightEl.textContent = `~$${flightCost.toLocaleString()}`;
            if (activityEl) activityEl.textContent = `~$${activityCost.toLocaleString()}`;

            // Update status
            if (statusEl) {
                if (total <= 25000) {
                    statusEl.innerHTML = '<span class="status-icon">âœ…</span><span>Within your $20K-$25K budget target!</span>';
                    statusEl.classList.remove('over-budget');
                } else {
                    statusEl.innerHTML = `<span class="status-icon">âš ï¸</span><span>$${(total - 25000).toLocaleString()} over budget - check detailed view</span>`;
                    statusEl.classList.add('over-budget');
                }
            }

            // Populate resort picks
            renderSimpleResortPicks();
        }

        function renderSimpleResortPicks() {
            const container = document.getElementById('simpleResortPicks');
            if (!container) return;

            // Get top 3 value picks
            const valuePicks = [
                { id: 2, name: 'Dreams Vista Cancun', note: 'Best accessibility + value' },
                { id: 11, name: 'Grand Palladium Costa Mujeres', note: 'Family-focused amenities' },
                { id: 16, name: 'Hotel Xcaret Arte', note: 'Parks included = huge savings' }
            ];

            container.innerHTML = valuePicks.map(pick => {
                const resort = resorts.find(r => r.id === pick.id);
                if (!resort) return '';
                const total = resort.priceMay24 * 7 * 7;
                return `
                    <div class="simple-pick-card" onclick="selectSimpleResort(${pick.id})">
                        <div class="simple-pick-name">${pick.name}</div>
                        <div class="simple-pick-price">$${total.toLocaleString()} total</div>
                        <div class="simple-pick-note">${pick.note}</div>
                    </div>
                `;
            }).join('');
        }

        function selectSimpleResort(resortId) {
            // Switch to detailed view and select the resort
            const select = document.getElementById('budgetResort');
            if (select) {
                select.value = resortId;
                updateBudgetCalc();
            }
            setBudgetMode('detailed');
        }

        // Budget Calculator
        function initBudgetPage() {
            const select = document.getElementById('budgetResort');
            if (!select) return;

            // Populate resort dropdown
            const familyResorts = resorts.filter(r => r.family).sort((a, b) => {
                if (a.isVilla && !b.isVilla) return 1;
                if (!a.isVilla && b.isVilla) return -1;
                return a.priceMay24 - b.priceMay24;
            });

            select.innerHTML = '<option value="">-- Select a resort --</option>' +
                familyResorts.map(r => {
                    const isVilla = r.isVilla;
                    const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                    return `<option value="${r.id}">${r.name} - $${r.priceMay24}/night${isVilla ? ' (Villa)' : ''}</option>`;
                }).join('');

            // Populate price alert resort dropdown
            const alertSelect = document.getElementById('alertResort');
            if (alertSelect) {
                alertSelect.innerHTML = '<option value="">Select Resort...</option>' +
                    familyResorts.map(r => `<option value="${r.id}">${r.name} ($${r.priceMay24}/night)</option>`).join('');
            }

            // Initialize quick comparison with top picks
            renderQuickComparison();

            // Render flight price widget
            renderFlightWidget();

            // Restore saved budget mode (default to simple)
            const savedMode = localStorage.getItem(BUDGET_MODE_KEY) || 'simple';
            setBudgetMode(savedMode);
        }

        function renderFlightWidget() {
            const container = document.getElementById('flightPriceWidget');
            if (!container) return;

            // Flight data from research
            const flightData = [
                {
                    airport: 'OMA',
                    city: 'Omaha',
                    price: 359,
                    people: 2,
                    trend: 'down',
                    note: 'Seasonal direct on Southwest',
                    googleUrl: 'https://www.google.com/travel/flights?q=flights+from+omaha+to+cancun+may+2025'
                },
                {
                    airport: 'DSM',
                    city: 'Des Moines',
                    price: 398,
                    people: 3,
                    trend: 'stable',
                    note: 'Usually 1 stop via Dallas',
                    googleUrl: 'https://www.google.com/travel/flights?q=flights+from+des+moines+to+cancun+may+2025'
                },
                {
                    airport: 'CID',
                    city: 'Cedar Rapids',
                    price: 420,
                    people: 5,
                    trend: 'up',
                    note: 'Connect via Chicago/Denver',
                    googleUrl: 'https://www.google.com/travel/flights?q=flights+from+cedar+rapids+to+cancun+may+2025'
                },
                {
                    airport: 'MCO',
                    city: 'Orlando',
                    price: 280,
                    people: 4,
                    trend: 'down',
                    note: 'Best prices - direct options',
                    googleUrl: 'https://www.google.com/travel/flights?q=flights+from+orlando+to+cancun+may+2025'
                }
            ];

            container.innerHTML = flightData.map(f => {
                const trendIcon = f.trend === 'down' ? 'ðŸ“‰' : f.trend === 'up' ? 'ðŸ“ˆ' : 'âž¡ï¸';
                const trendColor = f.trend === 'down' ? '#10b981' : f.trend === 'up' ? '#ef4444' : '#6b7280';
                const subtotal = f.price * f.people;

                return `
                    <a href="${f.googleUrl}" target="_blank" style="text-decoration:none;display:block;padding:16px;background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);border-radius:12px;border:2px solid #e2e8f0;transition:all 0.2s;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                            <div style="font-weight:700;color:#1e293b;">${f.airport}</div>
                            <span style="font-size:0.75rem;color:${trendColor};">${trendIcon}</span>
                        </div>
                        <div style="font-size:0.8rem;color:#64748b;margin-bottom:8px;">${f.city}</div>
                        <div style="font-size:1.3rem;font-weight:700;color:#0891b2;margin-bottom:4px;">$${f.price}</div>
                        <div style="font-size:0.75rem;color:#64748b;margin-bottom:8px;">per person, round trip</div>
                        <div style="display:flex;justify-content:space-between;padding-top:8px;border-top:1px dashed #e2e8f0;font-size:0.75rem;">
                            <span style="color:#64748b;">${f.people} people</span>
                            <span style="color:#059669;font-weight:600;">$${subtotal.toLocaleString()} total</span>
                        </div>
                        <div style="font-size:0.7rem;color:#94a3b8;margin-top:8px;">${f.note}</div>
                    </a>
                `;
            }).join('');
        }

        // ============================================
        // ITINERARY BUILDER
        // ============================================

        let selectedDay = 1;
        const tripDays = [
            { day: 1, date: 'Sat, May 24', label: 'Arrival Day' },
            { day: 2, date: 'Sun, May 25', label: 'Day 2' },
            { day: 3, date: 'Mon, May 26', label: 'Day 3' },
            { day: 4, date: 'Tue, May 27', label: 'Day 4' },
            { day: 5, date: 'Wed, May 28', label: 'Day 5' },
            { day: 6, date: 'Thu, May 29', label: 'Day 6' },
            { day: 7, date: 'Fri, May 30', label: 'Day 7' },
            { day: 8, date: 'Sat, May 31', label: 'Departure' }
        ];

        const categoryIcons = {
            excursion: 'ðŸ›ï¸',
            beach: 'ðŸ–ï¸',
            pool: 'ðŸŠ',
            dining: 'ðŸ½ï¸',
            shopping: 'ðŸ›ï¸',
            spa: 'ðŸ’†',
            adventure: 'ðŸ¤¿',
            family: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦'
        };

        function getItinerary() {
            const stored = localStorage.getItem('tripItinerary');
            return stored ? JSON.parse(stored) : [];
        }

        function saveItinerary(items) {
            localStorage.setItem('tripItinerary', JSON.stringify(items));
        }

        function initItinerary() {
            renderDayTabs();
            renderDaySchedule();
            renderItinerarySummary();
        }

        function renderDayTabs() {
            const container = document.getElementById('dayTabs');
            if (!container) return;

            container.innerHTML = tripDays.map(d => `
                <button onclick="selectDay(${d.day})"
                    style="padding:10px 16px;border-radius:8px;border:2px solid ${selectedDay === d.day ? '#0891b2' : '#e2e8f0'};
                    background:${selectedDay === d.day ? 'linear-gradient(135deg, #0891b2 0%, #06b6d4 100%)' : 'white'};
                    color:${selectedDay === d.day ? 'white' : '#1e293b'};cursor:pointer;font-weight:600;transition:all 0.2s;">
                    <div style="font-size:0.75rem;opacity:0.8;">${d.date}</div>
                    <div>${d.label}</div>
                </button>
            `).join('');
        }

        function selectDay(day) {
            selectedDay = day;
            renderDayTabs();
            renderDaySchedule();
        }

        function addItineraryItem() {
            const time = document.getElementById('activityTime')?.value;
            const category = document.getElementById('activityCategory')?.value;
            const title = document.getElementById('activityTitle')?.value;
            const notes = document.getElementById('activityNotes')?.value || '';
            const cost = parseInt(document.getElementById('activityCost')?.value) || 0;

            if (!title) {
                showToast('Please enter an activity title');
                return;
            }

            const items = getItinerary();
            items.push({
                id: Date.now(),
                day: selectedDay,
                time,
                category,
                title,
                notes,
                cost
            });

            saveItinerary(items);
            renderDaySchedule();
            renderItinerarySummary();

            // Clear form
            document.getElementById('activityTitle').value = '';
            document.getElementById('activityNotes').value = '';
            document.getElementById('activityCost').value = '';

            showToast('Activity added!');
        }

        function removeItineraryItem(id) {
            const items = getItinerary().filter(i => i.id !== id);
            saveItinerary(items);
            renderDaySchedule();
            renderItinerarySummary();
        }

        function renderDaySchedule() {
            const container = document.getElementById('daySchedule');
            if (!container) return;

            const items = getItinerary().filter(i => i.day === selectedDay);
            const dayInfo = tripDays.find(d => d.day === selectedDay);

            const timeOrder = ['morning', 'midday', 'afternoon', 'evening', 'night'];
            items.sort((a, b) => timeOrder.indexOf(a.time) - timeOrder.indexOf(b.time));

            if (items.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center;padding:40px;color:#64748b;">
                        <div style="font-size:3rem;margin-bottom:15px;">ðŸ“…</div>
                        <div style="font-size:1.1rem;font-weight:600;margin-bottom:8px;">No activities planned for ${dayInfo?.date}</div>
                        <div style="font-size:0.9rem;">Add activities using the form above!</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = `
                <h3 style="margin-bottom:20px;color:#1e293b;">${dayInfo?.date} - ${dayInfo?.label}</h3>
                <div style="display:flex;flex-direction:column;gap:12px;">
                    ${items.map(item => `
                        <div style="display:flex;gap:15px;padding:15px;background:#f8fafc;border-radius:10px;border-left:4px solid #14b8a6;">
                            <div style="font-size:1.5rem;">${categoryIcons[item.category] || 'ðŸ“Œ'}</div>
                            <div style="flex:1;">
                                <div style="font-weight:600;color:#1e293b;margin-bottom:4px;">${item.title}</div>
                                <div style="font-size:0.8rem;color:#64748b;display:flex;gap:15px;">
                                    <span>${item.time.charAt(0).toUpperCase() + item.time.slice(1)}</span>
                                    ${item.cost ? `<span style="color:#059669;font-weight:600;">$${item.cost}</span>` : ''}
                                </div>
                                ${item.notes ? `<div style="font-size:0.8rem;color:#94a3b8;margin-top:4px;">${item.notes}</div>` : ''}
                            </div>
                            <button onclick="removeItineraryItem(${item.id})" style="background:none;border:none;cursor:pointer;font-size:1rem;color:#94a3b8;">âœ•</button>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderItinerarySummary() {
            const container = document.getElementById('itinerarySummary');
            if (!container) return;

            const items = getItinerary();
            const totalCost = items.reduce((sum, i) => sum + (i.cost || 0), 0);
            const byCategory = items.reduce((acc, i) => {
                acc[i.category] = (acc[i.category] || 0) + 1;
                return acc;
            }, {});
            const daysPlanned = new Set(items.map(i => i.day)).size;

            container.innerHTML = `
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;">${items.length}</div>
                    <div style="font-size:0.8rem;opacity:0.8;">Activities</div>
                </div>
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;">${daysPlanned}</div>
                    <div style="font-size:0.8rem;opacity:0.8;">Days Planned</div>
                </div>
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;">$${totalCost.toLocaleString()}</div>
                    <div style="font-size:0.8rem;opacity:0.8;">Est. Activity Cost</div>
                </div>
                <div style="background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;text-align:center;">
                    <div style="font-size:1.5rem;font-weight:700;">$${Math.round(totalCost / 14)}</div>
                    <div style="font-size:0.8rem;opacity:0.8;">Per Person</div>
                </div>
            `;
        }

        function submitPriceAlert() {
            const email = document.getElementById('alertEmail')?.value;
            const resortId = document.getElementById('alertResort')?.value;
            const threshold = document.getElementById('alertThreshold')?.value;
            const messageDiv = document.getElementById('alertMessage');

            // Validation
            if (!email || !email.includes('@')) {
                showAlertMessage('Please enter a valid email address', 'error');
                return;
            }
            if (!resortId) {
                showAlertMessage('Please select a resort to watch', 'error');
                return;
            }
            if (!threshold || threshold < 100) {
                showAlertMessage('Please enter a price threshold (min $100)', 'error');
                return;
            }

            // In production, this would call the API
            // For now, simulate success and store locally
            const alerts = JSON.parse(localStorage.getItem('priceAlerts') || '[]');
            const resort = resorts.find(r => r.id === parseInt(resortId));

            alerts.push({
                email,
                resortId: parseInt(resortId),
                resortName: resort?.name,
                threshold: parseInt(threshold),
                createdAt: new Date().toISOString()
            });

            localStorage.setItem('priceAlerts', JSON.stringify(alerts));

            showAlertMessage(`Alert set for ${resort?.name} at $${threshold}/night. We'll email you when the price drops!`, 'success');

            // Clear form
            document.getElementById('alertEmail').value = '';
            document.getElementById('alertResort').value = '';
            document.getElementById('alertThreshold').value = '';
        }

        function showAlertMessage(message, type) {
            const messageDiv = document.getElementById('alertMessage');
            messageDiv.style.display = 'block';
            messageDiv.style.background = type === 'success' ? '#d1fae5' : '#fee2e2';
            messageDiv.style.color = type === 'success' ? '#065f46' : '#dc2626';
            messageDiv.textContent = message;

            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        function renderQuickComparison() {
            const container = document.getElementById('quickComparison');
            if (!container) return;

            // Top picks for multigenerational family
            const topPicks = [
                { id: 2, reason: "Best accessibility + value" },
                { id: 11, reason: "Built for multigenerational" },
                { id: 16, reason: "Parks included = $1200+ value" },
                { id: 44, reason: "Private + sea turtles + lowest cost" }
            ];

            container.innerHTML = topPicks.map(pick => {
                const r = resorts.find(res => res.id === pick.id);
                if (!r) return '';

                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const perPerson = Math.round(total7 / 14);
                const dealBadge = getDealBadge(r);
                const estTripCost = estimateTripCost(r);
                const budgetFit = getBudgetFit(r);
                const borderColor = budgetFit.status === 'sweet' ? '#3b82f6' : budgetFit.status === 'under' ? '#10b981' : '#f59e0b';

                return `
                    <div style="background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);border-radius:12px;padding:16px;border:2px solid ${borderColor};">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px;">
                            <div style="font-weight:700;color:#1e293b;">${r.name}</div>
                            <span class="budget-badge ${budgetFit.class}">${budgetFit.status === 'sweet' ? 'âœ“' : budgetFit.status === 'under' ? 'ðŸ’°' : 'âš ï¸'} ${budgetFit.label}</span>
                        </div>
                        <div style="font-size:0.8rem;color:#64748b;margin-bottom:10px;">${pick.reason}</div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:0.8rem;margin-bottom:8px;">
                            <div style="background:white;padding:8px;border-radius:6px;text-align:center;">
                                <div style="color:#64748b;font-size:0.7rem;">Est. Total Trip</div>
                                <div style="font-weight:700;color:${budgetFit.status === 'over' ? '#f59e0b' : '#059669'};">$${estTripCost.toLocaleString()}</div>
                            </div>
                            <div style="background:white;padding:8px;border-radius:6px;text-align:center;">
                                <div style="color:#64748b;font-size:0.7rem;">Per Person</div>
                                <div style="font-weight:700;color:#0891b2;">$${Math.round(estTripCost/14).toLocaleString()}</div>
                            </div>
                        </div>
                        ${budgetFit.status === 'under' ? `<div style="font-size:0.75rem;color:#059669;font-weight:600;margin-bottom:8px;">ðŸ’° $${budgetFit.diff.toLocaleString()} under budget!</div>` : ''}
                        ${budgetFit.status === 'over' ? `<div style="font-size:0.75rem;color:#d97706;font-weight:600;margin-bottom:8px;">âš ï¸ $${budgetFit.diff.toLocaleString()} over max budget</div>` : ''}
                        <div style="display:flex;gap:6px;flex-wrap:wrap;">
                            ${dealBadge ? `<span class="deal-badge ${dealBadge.class}" style="font-size:0.6rem;padding:2px 6px;">${dealBadge.icon}</span>` : ''}
                            ${r.valueScore ? `<span style="background:#d1fae5;color:#065f46;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">${r.valueScore}/10</span>` : ''}
                            ${r.accessible ? `<span style="background:#ffedd5;color:#c2410c;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">â™¿</span>` : ''}
                            ${r.points ? `<span style="background:#cffafe;color:#0e7490;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">${r.points.toUpperCase()}</span>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateBudgetCalc() {
            const resortId = document.getElementById('budgetResort')?.value;
            const week = document.getElementById('budgetWeek')?.value || 'may24';
            const nights = parseInt(document.getElementById('budgetNights')?.value || 7);
            const transferType = document.getElementById('transferType')?.value || 'private';
            const excursionBudget = parseInt(document.getElementById('excursionBudget')?.value || 200);

            // Flight costs
            const flightDSM = parseInt(document.getElementById('flightDSM')?.value || 450) * 3;
            const flightIC = parseInt(document.getElementById('flightIC')?.value || 420) * 5;
            const flightFL = parseInt(document.getElementById('flightFL')?.value || 280) * 4;
            const flightOMA = parseInt(document.getElementById('flightOMA')?.value || 380) * 2;
            const totalFlights = flightDSM + flightIC + flightFL + flightOMA;

            // Update transfer note
            const transferNote = document.getElementById('transferCostNote');
            if (transferNote) {
                if (transferType === 'included') {
                    transferNote.innerHTML = 'âœ“ Transfer included with selected resort (if applicable)';
                } else if (transferType === 'private') {
                    transferNote.innerHTML = '2 private vans for 14 people: ~$160-200 each way<br>Recommended for elderly with mobility needs';
                } else {
                    transferNote.innerHTML = 'Shared shuttle: ~$25-50 per person each way<br>Note: May have multiple stops';
                }
            }

            if (!resortId) {
                return;
            }

            const resort = resorts.find(r => r.id === parseInt(resortId));
            if (!resort) return;

            // Resort cost
            const isVilla = resort.isVilla;
            const pricePerNight = week === 'may24' ? resort.priceMay24 : resort.priceMay31;
            const roomsOrVilla = isVilla ? 1 : 7;
            const accommodationTotal = pricePerNight * roomsOrVilla * nights;

            // Transfer costs
            let transferCost = 0;
            const costs = hiddenCosts[resort.id];
            if (transferType === 'included' && costs?.freeTransfer) {
                transferCost = 0;
            } else if (transferType === 'private') {
                transferCost = 360; // 2 vans Ã— 2 ways Ã— ~$90
            } else {
                transferCost = 50 * 14; // $50 per person roundtrip
            }

            // Excursions
            const excursionTotal = excursionBudget * 14;

            // Hidden costs estimate
            const hiddenCostTotal = (costs?.extras || 20) * nights;

            // Grand total
            const grandTotal = totalFlights + accommodationTotal + transferCost + excursionTotal + hiddenCostTotal;
            const perPerson = Math.round(grandTotal / 14);

            // Deal badge
            const dealBadge = getDealBadge(resort);
            const badgeContainer = document.getElementById('resortDealBadge');
            if (badgeContainer) {
                badgeContainer.innerHTML = dealBadge ?
                    `<span class="deal-badge ${dealBadge.class}">${dealBadge.icon} ${dealBadge.text}</span> ${getTrendIndicator(resort)}` :
                    getTrendIndicator(resort);
            }

            // Update summary
            const summary = document.getElementById('budgetSummary');
            if (summary) {
                summary.innerHTML = `
                    <h3>Trip Budget Summary: ${resort.name}</h3>
                    <div style="margin-top:20px;">
                        <div class="budget-total-row">
                            <span class="label">âœˆï¸ Flights (14 people)</span>
                            <span class="amount">$${totalFlights.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸ¨ Accommodation (${isVilla ? 'villa' : '7 rooms'} Ã— ${nights} nights)</span>
                            <span class="amount">$${accommodationTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸš Airport Transfers</span>
                            <span class="amount">${transferCost === 0 ? 'FREE!' : '$' + transferCost.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸŽ¢ Excursions & Activities</span>
                            <span class="amount">$${excursionTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸ’µ Est. Extra Expenses</span>
                            <span class="amount">$${hiddenCostTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row grand-total">
                            <span class="label">TOTAL TRIP COST</span>
                            <span class="amount">$${grandTotal.toLocaleString()}</span>
                        </div>
                    </div>

                    <!-- Budget Fit Indicator -->
                    <div style="margin-top:20px;padding:15px;border-radius:12px;${
                        grandTotal <= BUDGET_TARGET.min ? 'background:rgba(16,185,129,0.2);border:2px solid #10b981;' :
                        grandTotal <= BUDGET_TARGET.max ? 'background:rgba(59,130,246,0.2);border:2px solid #3b82f6;' :
                        'background:rgba(245,158,11,0.2);border:2px solid #f59e0b;'
                    }">
                        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;">
                            <div>
                                <div style="font-weight:700;font-size:1.1rem;">${
                                    grandTotal <= BUDGET_TARGET.min ? 'ðŸ’° Under Budget!' :
                                    grandTotal <= BUDGET_TARGET.max ? 'âœ“ Within Budget!' :
                                    'âš ï¸ Over Budget'
                                }</div>
                                <div style="font-size:0.85rem;opacity:0.9;">Target: $20K - $25K</div>
                            </div>
                            <div style="text-align:right;">
                                ${grandTotal <= BUDGET_TARGET.min ?
                                    `<div style="font-size:1.2rem;font-weight:700;">$${(BUDGET_TARGET.min - grandTotal).toLocaleString()} to spare</div>` :
                                grandTotal <= BUDGET_TARGET.max ?
                                    `<div style="font-size:1.2rem;font-weight:700;">Perfect fit!</div>` :
                                    `<div style="font-size:1.2rem;font-weight:700;">$${(grandTotal - BUDGET_TARGET.max).toLocaleString()} over</div>`
                                }
                            </div>
                        </div>
                        ${grandTotal > BUDGET_TARGET.max ? `
                        <div style="margin-top:10px;font-size:0.8rem;opacity:0.9;">
                            ðŸ’¡ Tip: Try 5-6 nights, reduce excursions, or choose a lower-cost resort
                        </div>
                        ` : ''}
                    </div>

                    <div class="per-person-badge">
                        <div class="amount">$${perPerson.toLocaleString()}</div>
                        <div class="label">per person for entire trip</div>
                    </div>
                    ${costs?.freeTransfer ? '<div style="margin-top:15px;padding:10px;background:rgba(255,255,255,0.15);border-radius:8px;font-size:0.85rem;">âœ¨ This resort includes FREE airport transfers!</div>' : ''}
                    ${costs?.parksIncluded ? '<div style="margin-top:10px;padding:10px;background:rgba(255,255,255,0.15);border-radius:8px;font-size:0.85rem;">ðŸŽ¢ Includes ALL Xcaret parks ($1200+ value) - consider reducing excursion budget!</div>' : ''}
                `;
            }
        }

        // =====================
        // GROUP COORDINATION
        // =====================
        const EXPENSES_KEY = 'cancunExpenses';

        // Family groups data
        const familyGroups = [
            {
                id: 'alex',
                name: "Alex's Family",
                members: ['Alex', 'Spouse', 'Child 1', 'Child 2'],
                count: 4,
                rooms: 2,
                departureCity: 'DSM',
                phone: '(515) 555-0101',
                email: 'alex@email.com',
                color: '#0891b2'
            },
            {
                id: 'parents',
                name: 'Mom & Dad + Grandma',
                members: ['Mom', 'Dad', 'Grandma'],
                count: 3,
                rooms: 2,
                departureCity: 'CID',
                phone: '(319) 555-0102',
                email: 'parents@email.com',
                color: '#8b5cf6'
            },
            {
                id: 'becketts',
                name: 'The Becketts',
                members: ['Beckett Sr', 'Spouse', 'Teen 1', 'Teen 2', 'Child'],
                count: 5,
                rooms: 2,
                departureCity: 'OMA',
                phone: '(402) 555-0103',
                email: 'becketts@email.com',
                color: '#10b981'
            },
            {
                id: 'dann',
                name: 'Dann & Partner',
                members: ['Dann', 'Partner'],
                count: 2,
                rooms: 1,
                departureCity: 'MCO',
                phone: '(407) 555-0104',
                email: 'dann@email.com',
                color: '#f59e0b'
            }
        ];

        // Flight data
        const flightData = [
            {
                group: 'alex',
                outbound: { flight: 'AA 1234', from: 'DSM', to: 'CUN', depart: 'May 24, 6:00 AM', arrive: '11:30 AM' },
                return: { flight: 'AA 4321', from: 'CUN', to: 'DSM', depart: 'May 31, 2:00 PM', arrive: '8:30 PM' }
            },
            {
                group: 'parents',
                outbound: { flight: 'UA 2345', from: 'CID', to: 'CUN', depart: 'May 24, 7:15 AM', arrive: '12:45 PM' },
                return: { flight: 'UA 5432', from: 'CUN', to: 'CID', depart: 'May 31, 1:00 PM', arrive: '7:45 PM' }
            },
            {
                group: 'becketts',
                outbound: { flight: 'SW 3456', from: 'OMA', to: 'CUN', depart: 'May 24, 5:30 AM', arrive: '11:00 AM' },
                return: { flight: 'SW 6543', from: 'CUN', to: 'OMA', depart: 'May 31, 3:30 PM', arrive: '9:15 PM' }
            },
            {
                group: 'dann',
                outbound: { flight: 'DL 4567', from: 'MCO', to: 'CUN', depart: 'May 24, 8:00 AM', arrive: '10:15 AM' },
                return: { flight: 'DL 7654', from: 'CUN', to: 'MCO', depart: 'May 31, 4:00 PM', arrive: '8:30 PM' }
            }
        ];

        function renderFlightTracker() {
            const container = document.getElementById('flightTracker');
            if (!container) return;

            container.innerHTML = flightData.map(f => {
                const group = familyGroups.find(g => g.id === f.group);
                return `
                    <div style="margin-bottom:15px;padding:15px;background:#f8fafc;border-radius:10px;border-left:4px solid ${group.color};">
                        <div style="font-weight:600;color:${group.color};margin-bottom:10px;">${group.name}</div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;font-size:0.85rem;">
                            <div style="padding:10px;background:white;border-radius:6px;">
                                <div style="color:#64748b;font-size:0.75rem;">OUTBOUND</div>
                                <div style="font-weight:600;">${f.outbound.flight}</div>
                                <div>${f.outbound.from} â†’ ${f.outbound.to}</div>
                                <div style="color:#10b981;">${f.outbound.depart}</div>
                            </div>
                            <div style="padding:10px;background:white;border-radius:6px;">
                                <div style="color:#64748b;font-size:0.75rem;">RETURN</div>
                                <div style="font-weight:600;">${f.return.flight}</div>
                                <div>${f.return.from} â†’ ${f.return.to}</div>
                                <div style="color:#ef4444;">${f.return.depart}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function checkAllFlightStatus() {
            alert('On travel day, this will check real-time flight status via FlightAware or similar API. For now, check your airline app or flightaware.com');
        }

        function renderRoomAssignments() {
            const container = document.getElementById('roomAssignments');
            if (!container) return;

            let roomNumber = 1;
            container.innerHTML = familyGroups.map(g => {
                const rooms = [];
                for (let i = 0; i < g.rooms; i++) {
                    rooms.push(roomNumber++);
                }
                return `
                    <div style="margin-bottom:15px;padding:15px;background:#f8fafc;border-radius:10px;border-left:4px solid ${g.color};">
                        <div style="display:flex;justify-content:space-between;align-items:center;">
                            <div>
                                <div style="font-weight:600;color:${g.color};">${g.name}</div>
                                <div style="font-size:0.85rem;color:#64748b;">${g.members.join(', ')}</div>
                            </div>
                            <div style="text-align:right;">
                                <div style="font-size:0.75rem;color:#64748b;">ROOMS</div>
                                <div style="font-weight:700;font-size:1.2rem;">${rooms.join(' & ')}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderContactCards() {
            const container = document.getElementById('contactCards');
            if (!container) return;

            container.innerHTML = familyGroups.map(g => `
                <div style="padding:12px;background:#f8fafc;border-radius:8px;display:flex;align-items:center;gap:12px;">
                    <div style="width:40px;height:40px;background:${g.color};border-radius:50%;display:flex;align-items:center;justify-content:center;color:white;font-weight:700;">
                        ${g.name.charAt(0)}
                    </div>
                    <div style="flex:1;">
                        <div style="font-weight:600;color:#1e293b;">${g.name}</div>
                        <div style="font-size:0.8rem;color:#64748b;">${g.count} people</div>
                    </div>
                    <div style="text-align:right;font-size:0.85rem;">
                        <a href="tel:${g.phone}" style="color:#0891b2;text-decoration:none;">${g.phone}</a>
                    </div>
                </div>
            `).join('');
        }

        function copyAllContacts() {
            const text = familyGroups.map(g => `${g.name}: ${g.phone}`).join('\n');
            navigator.clipboard.writeText(text);
            alert('Contacts copied to clipboard!');
        }

        function createWhatsAppGroup() {
            alert('To create a WhatsApp group:\n1. Open WhatsApp\n2. Tap New Group\n3. Add family members\n4. Name it "Cancun 2025 ðŸŒ´"\n5. Share the invite link here!');
        }

        function sharePhotoAlbum() {
            alert('Create a shared album:\n\nðŸ“± iPhone: Photos â†’ Albums â†’ New Shared Album â†’ "Cancun 2025"\n\nðŸ¤– Android: Google Photos â†’ Sharing â†’ Shared Album â†’ "Cancun 2025"\n\nShare the link with everyone!');
        }

        function shareCalendar() {
            const calendarEvent = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
DTSTART:20250524
DTEND:20250531
SUMMARY:Cancun Family Vacation ðŸŒ´
LOCATION:Cancun, Mexico
DESCRIPTION:Family vacation May 24-31, 2025
END:VEVENT
END:VCALENDAR`;
            const blob = new Blob([calendarEvent], { type: 'text/calendar' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'cancun-vacation-2025.ics';
            a.click();
        }

        // Expense Splitter
        function getExpenses() {
            const saved = localStorage.getItem(EXPENSES_KEY);
            return saved ? JSON.parse(saved) : [];
        }

        function saveExpenses(expenses) {
            localStorage.setItem(EXPENSES_KEY, JSON.stringify(expenses));
        }

        function addExpense() {
            const desc = document.getElementById('expenseDesc').value.trim();
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const paidBy = document.getElementById('expensePaidBy').value;
            const splitBetween = Array.from(document.querySelectorAll('.expenseSplit:checked')).map(cb => cb.value);

            if (!desc || !amount || splitBetween.length === 0) {
                alert('Please fill in all fields and select at least one group to split between.');
                return;
            }

            const expenses = getExpenses();
            expenses.push({
                id: Date.now(),
                desc,
                amount,
                paidBy,
                splitBetween,
                date: new Date().toISOString()
            });
            saveExpenses(expenses);

            document.getElementById('expenseDesc').value = '';
            document.getElementById('expenseAmount').value = '';

            renderExpenseList();
            renderSettlementSummary();
        }

        function deleteExpense(id) {
            const expenses = getExpenses().filter(e => e.id !== id);
            saveExpenses(expenses);
            renderExpenseList();
            renderSettlementSummary();
        }

        function renderExpenseList() {
            const container = document.getElementById('expenseList');
            if (!container) return;

            const expenses = getExpenses();
            if (expenses.length === 0) {
                container.innerHTML = '<div style="text-align:center;color:#64748b;padding:20px;">No expenses yet. Add shared costs above.</div>';
                return;
            }

            container.innerHTML = expenses.map(e => {
                const payer = familyGroups.find(g => g.id === e.paidBy);
                return `
                    <div style="padding:12px;background:#f8fafc;border-radius:8px;margin-bottom:10px;display:flex;align-items:center;gap:12px;">
                        <div style="flex:1;">
                            <div style="font-weight:600;">${e.desc}</div>
                            <div style="font-size:0.8rem;color:#64748b;">Paid by ${payer?.name || e.paidBy}</div>
                        </div>
                        <div style="font-weight:700;color:#10b981;">$${e.amount.toFixed(2)}</div>
                        <button onclick="deleteExpense(${e.id})" style="background:none;border:none;color:#ef4444;cursor:pointer;font-size:1.2rem;">Ã—</button>
                    </div>
                `;
            }).join('');
        }

        function renderSettlementSummary() {
            const container = document.getElementById('settlementSummary');
            if (!container) return;

            const expenses = getExpenses();
            if (expenses.length === 0) {
                container.innerHTML = '<div style="text-align:center;color:#64748b;">Add expenses to see settlement</div>';
                return;
            }

            // Calculate balances
            const balances = {};
            familyGroups.forEach(g => { balances[g.id] = 0; });

            expenses.forEach(e => {
                // Credit the payer
                balances[e.paidBy] += e.amount;

                // Calculate per-group share based on headcount
                const splitGroups = e.splitBetween.map(id => familyGroups.find(g => g.id === id)).filter(Boolean);
                const totalPeople = splitGroups.reduce((sum, g) => sum + g.count, 0);

                splitGroups.forEach(g => {
                    const share = (e.amount * g.count) / totalPeople;
                    balances[g.id] -= share;
                });
            });

            // Generate settlement instructions
            const settlements = [];
            const debtors = Object.entries(balances).filter(([_, bal]) => bal < -0.01).sort((a, b) => a[1] - b[1]);
            const creditors = Object.entries(balances).filter(([_, bal]) => bal > 0.01).sort((a, b) => b[1] - a[1]);

            debtors.forEach(([debtorId, debt]) => {
                let remaining = Math.abs(debt);
                creditors.forEach(([creditorId, credit]) => {
                    if (remaining > 0.01 && credit > 0.01) {
                        const payment = Math.min(remaining, credit);
                        if (payment > 0.01) {
                            settlements.push({
                                from: debtorId,
                                to: creditorId,
                                amount: payment
                            });
                            remaining -= payment;
                            balances[creditorId] -= payment;
                        }
                    }
                });
            });

            if (settlements.length === 0) {
                container.innerHTML = '<div style="text-align:center;color:#10b981;font-weight:600;">âœ“ All settled up!</div>';
                return;
            }

            container.innerHTML = settlements.map(s => {
                const from = familyGroups.find(g => g.id === s.from);
                const to = familyGroups.find(g => g.id === s.to);
                return `
                    <div style="padding:10px;background:white;border-radius:8px;display:flex;align-items:center;gap:8px;font-size:0.9rem;">
                        <span style="font-weight:600;color:${from?.color || '#64748b'};">${from?.name || s.from}</span>
                        <span>â†’</span>
                        <span style="font-weight:600;color:${to?.color || '#64748b'};">${to?.name || s.to}</span>
                        <span style="margin-left:auto;font-weight:700;color:#10b981;">$${s.amount.toFixed(2)}</span>
                    </div>
                `;
            }).join('');
        }

        function copySettlement() {
            const container = document.getElementById('settlementSummary');
            const text = container.innerText;
            navigator.clipboard.writeText('Cancun Trip Settlement:\n' + text);
            alert('Settlement details copied!');
        }

        function initGroupPage() {
            renderFlightTracker();
            renderRoomAssignments();
            renderContactCards();
            renderExpenseList();
            renderSettlementSummary();
        }

        // =====================
        // PREP & PACK
        // =====================
        const TRIP_DATE = new Date('2025-05-24');
        const PREP_CHECKLIST_KEY = 'cancunPrepChecklist';
        const PACKING_LIST_KEY = 'cancunPackingList';

        // Trip Preparation Checklist with timeline
        const prepChecklistData = [
            {
                timeframe: '3+ Months Before',
                icon: 'ðŸ“…',
                items: [
                    { id: 'passport', text: 'Check all passports are valid (6+ months beyond travel)' },
                    { id: 'resort', text: 'Research and book resort' },
                    { id: 'budget', text: 'Set family budget and payment plan' }
                ]
            },
            {
                timeframe: '2 Months Before',
                icon: 'âœˆï¸',
                items: [
                    { id: 'flights', text: 'Book flights for all family groups' },
                    { id: 'insurance', text: 'Consider travel insurance' },
                    { id: 'confirmations', text: 'Share all confirmation numbers with family' }
                ]
            },
            {
                timeframe: '1 Month Before',
                icon: 'ðŸŽ«',
                items: [
                    { id: 'excursions', text: 'Book excursions and activities' },
                    { id: 'transfers', text: 'Arrange airport transfers' },
                    { id: 'dietary', text: 'Notify resort of dietary restrictions' },
                    { id: 'seats', text: 'Select airplane seats' }
                ]
            },
            {
                timeframe: '2 Weeks Before',
                icon: 'ðŸ“±',
                items: [
                    { id: 'checkin', text: 'Online check-in for flights (when available)' },
                    { id: 'notify', text: 'Notify bank/credit cards of travel' },
                    { id: 'phone', text: 'Check phone international plan' },
                    { id: 'prescriptions', text: 'Refill prescriptions' }
                ]
            },
            {
                timeframe: '1 Week Before',
                icon: 'ðŸ§³',
                items: [
                    { id: 'packing', text: 'Start packing (use list below!)' },
                    { id: 'currency', text: 'Get some Mexican pesos or small USD bills' },
                    { id: 'printouts', text: 'Print/download confirmations offline' },
                    { id: 'petcare', text: 'Arrange pet/house sitter if needed' }
                ]
            },
            {
                timeframe: 'Day Before',
                icon: 'âœ…',
                items: [
                    { id: 'charge', text: 'Charge all devices' },
                    { id: 'documents', text: 'Put passports, IDs, and documents in carry-on' },
                    { id: 'weather', text: 'Check Cancun weather forecast' },
                    { id: 'weight', text: 'Weigh luggage (50 lbs limit)' }
                ]
            }
        ];

        // Packing List Data
        const packingListData = [
            {
                category: 'Documents',
                icon: 'ðŸ“„',
                items: [
                    'Passport (valid 6+ months)',
                    'Driver\'s license / ID',
                    'Travel insurance documents',
                    'Hotel confirmation',
                    'Flight confirmation',
                    'Credit cards (notify bank!)',
                    'Some cash (USD + pesos)'
                ]
            },
            {
                category: 'Beach & Pool',
                icon: 'ðŸ–ï¸',
                items: [
                    'Swimsuits (2-3 per person)',
                    'Cover-ups / sarong',
                    'Reef-safe sunscreen',
                    'Sunglasses',
                    'Sun hat / baseball cap',
                    'Beach bag',
                    'Waterproof phone pouch',
                    'Snorkel gear (optional)'
                ]
            },
            {
                category: 'Clothing',
                icon: 'ðŸ‘•',
                items: [
                    'Light, breathable shirts',
                    'Shorts',
                    'Sundresses',
                    'Light pants for evenings',
                    'Nice outfit for dinner',
                    'Light jacket/cardigan (AC is cold!)',
                    'Comfortable walking shoes',
                    'Sandals / flip-flops',
                    'Underwear & socks',
                    'Sleepwear'
                ]
            },
            {
                category: 'Toiletries',
                icon: 'ðŸ§´',
                items: [
                    'Toothbrush & toothpaste',
                    'Shampoo & conditioner',
                    'Deodorant',
                    'Razor',
                    'Hairbrush / comb',
                    'Hair ties',
                    'Makeup (if used)',
                    'Contact lenses & solution'
                ]
            },
            {
                category: 'Health & Safety',
                icon: 'ðŸ’Š',
                items: [
                    'Prescription medications',
                    'Pain relievers (Advil/Tylenol)',
                    'Antihistamines',
                    'Anti-diarrhea medicine',
                    'Motion sickness pills',
                    'First aid kit basics',
                    'Insect repellent',
                    'Aloe vera gel',
                    'Hand sanitizer'
                ]
            },
            {
                category: 'Electronics',
                icon: 'ðŸ”Œ',
                items: [
                    'Phone & charger',
                    'Camera & charger',
                    'Power bank',
                    'Headphones',
                    'Kindle / tablet',
                    'Universal adapter (Mexico uses US plugs)'
                ]
            },
            {
                category: 'Kids Items',
                icon: 'ðŸ‘¶',
                items: [
                    'Swim diapers',
                    'Floaties / puddle jumper',
                    'Kids sunscreen (high SPF)',
                    'Favorite toys / books',
                    'Snacks for travel',
                    'Stroller (if needed)',
                    'Baby carrier',
                    'Kids headphones for flights'
                ]
            },
            {
                category: 'Misc',
                icon: 'ðŸŽ’',
                items: [
                    'Day backpack',
                    'Reusable water bottle',
                    'Books / magazines',
                    'Playing cards / games',
                    'Laundry bag',
                    'Ziploc bags (various sizes)',
                    'Pen for customs forms'
                ]
            }
        ];

        function getSavedPrepChecklist() {
            const saved = localStorage.getItem(PREP_CHECKLIST_KEY);
            return saved ? JSON.parse(saved) : {};
        }

        function savePrepChecklistItem(id, checked) {
            const saved = getSavedPrepChecklist();
            saved[id] = checked;
            localStorage.setItem(PREP_CHECKLIST_KEY, JSON.stringify(saved));
            updatePrepProgress();
        }

        function getSavedPackingList() {
            const saved = localStorage.getItem(PACKING_LIST_KEY);
            return saved ? JSON.parse(saved) : {};
        }

        function savePackingItem(category, item, checked) {
            const saved = getSavedPackingList();
            const key = `${category}:${item}`;
            saved[key] = checked;
            localStorage.setItem(PACKING_LIST_KEY, JSON.stringify(saved));
            updatePrepProgress();
        }

        function renderPrepChecklist() {
            const container = document.getElementById('prepChecklist');
            if (!container) return;

            const saved = getSavedPrepChecklist();

            container.innerHTML = prepChecklistData.map(section => `
                <div style="margin-bottom:20px;">
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;padding:8px 12px;background:#f0fdfa;border-radius:8px;border-left:4px solid #14b8a6;">
                        <span style="font-size:1.2rem;">${section.icon}</span>
                        <span style="font-weight:600;color:#0f766e;">${section.timeframe}</span>
                    </div>
                    <div style="display:grid;gap:8px;padding-left:10px;">
                        ${section.items.map(item => `
                            <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:8px;border-radius:6px;transition:background 0.2s;${saved[item.id] ? 'background:#f0fdf4;' : ''}" onmouseover="this.style.background='#f8fafc'" onmouseout="this.style.background='${saved[item.id] ? '#f0fdf4' : ''}'">
                                <input type="checkbox" ${saved[item.id] ? 'checked' : ''} onchange="savePrepChecklistItem('${item.id}', this.checked)" style="width:18px;height:18px;accent-color:#10b981;">
                                <span style="${saved[item.id] ? 'text-decoration:line-through;color:#94a3b8;' : 'color:#475569;'}">${item.text}</span>
                            </label>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }

        function renderPackingList() {
            const container = document.getElementById('packingList');
            if (!container) return;

            const saved = getSavedPackingList();

            container.innerHTML = packingListData.map(section => `
                <div style="margin-bottom:20px;">
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:10px;cursor:pointer;" onclick="togglePackingSection('${section.category}')">
                        <span style="font-size:1.2rem;">${section.icon}</span>
                        <span style="font-weight:600;color:#1e293b;">${section.category}</span>
                        <span style="font-size:0.75rem;color:#64748b;margin-left:auto;" id="count-${section.category}">
                            ${section.items.filter(item => saved[`${section.category}:${item}`]).length}/${section.items.length}
                        </span>
                        <span id="arrow-${section.category}" style="transition:transform 0.2s;">â–¼</span>
                    </div>
                    <div id="section-${section.category}" style="display:grid;gap:6px;padding-left:10px;">
                        ${section.items.map(item => {
                            const key = `${section.category}:${item}`;
                            return `
                            <label style="display:flex;align-items:center;gap:10px;cursor:pointer;padding:6px 8px;border-radius:6px;font-size:0.9rem;${saved[key] ? 'background:#f0fdf4;' : ''}">
                                <input type="checkbox" ${saved[key] ? 'checked' : ''} onchange="savePackingItem('${section.category}', '${item.replace(/'/g, "\\'")}', this.checked)" style="width:16px;height:16px;accent-color:#10b981;">
                                <span style="${saved[key] ? 'text-decoration:line-through;color:#94a3b8;' : 'color:#475569;'}">${item}</span>
                            </label>
                        `;}).join('')}
                    </div>
                </div>
            `).join('');
        }

        function togglePackingSection(category) {
            const section = document.getElementById(`section-${category}`);
            const arrow = document.getElementById(`arrow-${category}`);
            if (section.style.display === 'none') {
                section.style.display = 'grid';
                arrow.style.transform = 'rotate(0deg)';
            } else {
                section.style.display = 'none';
                arrow.style.transform = 'rotate(-90deg)';
            }
        }

        function resetPackingList() {
            if (confirm('Reset all packing list checkboxes?')) {
                localStorage.removeItem(PACKING_LIST_KEY);
                renderPackingList();
                updatePrepProgress();
            }
        }

        function printPackingList() {
            const saved = getSavedPackingList();
            let printContent = 'ðŸ§³ CANCUN PACKING LIST\\n\\n';
            packingListData.forEach(section => {
                printContent += `${section.icon} ${section.category}\\n`;
                section.items.forEach(item => {
                    const key = `${section.category}:${item}`;
                    printContent += `  ${saved[key] ? 'âœ“' : 'â˜'} ${item}\\n`;
                });
                printContent += '\\n';
            });
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`<pre style="font-family:sans-serif;font-size:14px;">${printContent}</pre>`);
            printWindow.document.close();
            printWindow.print();
        }

        function updateTripCountdown() {
            const now = new Date();
            const diff = TRIP_DATE - now;
            const days = Math.ceil(diff / (1000 * 60 * 60 * 24));
            const countdown = document.getElementById('tripCountdown');
            if (countdown) {
                if (days > 0) {
                    countdown.textContent = `${days} days to go!`;
                } else if (days === 0) {
                    countdown.textContent = "It's TODAY! ðŸŽ‰";
                } else {
                    countdown.textContent = "Trip completed! ðŸŒ´";
                }
            }
        }

        function updatePrepProgress() {
            const prepSaved = getSavedPrepChecklist();
            const packingSaved = getSavedPackingList();

            // Count prep items
            let totalPrep = 0;
            let checkedPrep = 0;
            prepChecklistData.forEach(section => {
                section.items.forEach(item => {
                    totalPrep++;
                    if (prepSaved[item.id]) checkedPrep++;
                });
            });

            // Count packing items
            let totalPacking = 0;
            let checkedPacking = 0;
            packingListData.forEach(section => {
                section.items.forEach(item => {
                    totalPacking++;
                    if (packingSaved[`${section.category}:${item}`]) checkedPacking++;
                });
            });

            const total = totalPrep + totalPacking;
            const checked = checkedPrep + checkedPacking;
            const percent = Math.round((checked / total) * 100);

            const bar = document.getElementById('prepProgressBar');
            const text = document.getElementById('prepProgressText');
            if (bar) bar.style.width = `${percent}%`;
            if (text) text.textContent = `${percent}%`;
        }

        function renderAmenitiesTable() {
            const tbody = document.getElementById('amenitiesBody');
            if (!tbody) return;

            // Get top family resorts
            const familyResorts = resorts.filter(r => r.family && !r.isVilla).slice(0, 10);

            // Amenities data (would ideally be in resort data, but adding here for demo)
            const amenitiesData = {
                1: { kidsClub: true, waterPark: false, spa: true, beach: true, pools: 3, restaurants: 6, wheelchair: true, wifi: true }, // Hyatt Ziva
                2: { kidsClub: true, waterPark: false, spa: true, beach: true, pools: 2, restaurants: 5, wheelchair: true, wifi: true }, // Hard Rock
                7: { kidsClub: true, waterPark: true, spa: true, beach: true, pools: 4, restaurants: 8, wheelchair: true, wifi: true }, // Moon Palace
                11: { kidsClub: true, waterPark: true, spa: true, beach: true, pools: 5, restaurants: 10, wheelchair: true, wifi: true }, // Grand Palladium
                16: { kidsClub: true, waterPark: true, spa: true, beach: true, pools: 3, restaurants: 7, wheelchair: true, wifi: true }, // Xcaret Arte
            };

            tbody.innerHTML = familyResorts.map(r => {
                const a = amenitiesData[r.id] || {};
                const check = 'âœ…';
                const x = 'âŒ';
                return `
                    <tr style="border-bottom:1px solid #e2e8f0;">
                        <td style="padding:12px;font-weight:600;">${r.name}</td>
                        <td style="padding:12px;text-align:center;">${a.kidsClub ? check : x}</td>
                        <td style="padding:12px;text-align:center;">${a.waterPark ? check : x}</td>
                        <td style="padding:12px;text-align:center;">${a.spa ? check : x}</td>
                        <td style="padding:12px;text-align:center;">${a.beach ? check : x}</td>
                        <td style="padding:12px;text-align:center;">${a.pools || '?'}</td>
                        <td style="padding:12px;text-align:center;">${a.restaurants || '?'}</td>
                        <td style="padding:12px;text-align:center;">${a.wheelchair ? check : x}</td>
                        <td style="padding:12px;text-align:center;">${a.wifi ? check : x}</td>
                    </tr>
                `;
            }).join('');
        }

        function initPrepPage() {
            updateTripCountdown();
            renderPrepChecklist();
            renderPackingList();
            updatePrepProgress();
            renderAmenitiesTable();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            initSync();
            renderMatrix();
            renderVoterSelect();
            renderVotingOptions();
            renderRankedOptions();
            updateVotingResults();
            initBudgetPage();
            initItinerary();
            initGroupPage();
            initPrepPage();
            loadComparisonFromUrl();
            document.getElementById('resortCount').textContent = resorts.length;
        });
    </script>
</body>
</html>
