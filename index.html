<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Vacation Planner 2025 - Cancun & Riviera Maya</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Real-time vote sync powered by ntfy.sh -->
    <style>
        :root {
            --primary: #0891b2;
            --primary-dark: #0e7490;
            --secondary: #f97316;
            --accent: #06b6d4;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1e293b;
            --light: #f0fdfa;
            --gray: #64748b;
            --sand: #fef3c7;
            --ocean: #0891b2;
            --coral: #f97316;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--light);
            color: var(--dark);
            line-height: 1.5;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 50%, #0891b2 100%);
            color: white;
            padding: 20px 30px;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(8, 145, 178, 0.3);
        }

        .header-content {
            max-width: 1800px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 800;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-stats {
            display: flex;
            gap: 25px;
            font-size: 0.9rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .stat-label {
            opacity: 0.9;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 5px;
            background: rgba(255,255,255,0.1);
            padding: 5px;
            border-radius: 12px;
        }

        .nav-tab {
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: white;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .nav-tab:hover {
            background: rgba(255,255,255,0.15);
        }

        .nav-tab.active {
            background: white;
            color: var(--primary);
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 380px 1fr;
            height: calc(100vh - 80px);
        }

        /* ============================================
           RESPONSIVE DESIGN - Mobile First Approach
           ============================================ */

        /* Large Desktop (1400px+) - Full layout */
        @media (min-width: 1400px) {
            .header-content {
                gap: 30px;
            }
            .header h1 {
                font-size: 1.8rem;
            }
            .nav-tab {
                padding: 10px 20px;
            }
        }

        /* Desktop (1024px - 1400px) */
        @media (max-width: 1400px) {
            .header h1 {
                font-size: 1.4rem;
            }
            .nav-tab {
                padding: 8px 14px;
                font-size: 0.85rem;
            }
            .header-stats {
                gap: 15px;
            }
            .stat-value {
                font-size: 1.2rem;
            }
        }

        /* Tablet (768px - 1024px) */
        @media (max-width: 1024px) {
            .header {
                padding: 15px 20px;
            }
            .header-content {
                flex-direction: column;
                align-items: stretch;
                gap: 12px;
            }
            .header h1 {
                font-size: 1.3rem;
                text-align: center;
                justify-content: center;
            }
            .nav-tabs {
                justify-content: center;
                flex-wrap: wrap;
            }
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            .header-stats {
                justify-content: center;
                gap: 20px;
            }
            .main-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            .sidebar {
                max-height: 40vh;
                border-right: none;
                border-bottom: 1px solid #e2e8f0;
            }
            #map {
                height: 50vh !important;
            }
            .budget-view {
                padding: 20px;
            }
            .budget-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        /* Mobile (under 768px) - iPhone optimized */
        @media (max-width: 768px) {
            .header {
                padding: 12px 15px;
            }
            .header-content {
                gap: 10px;
            }
            .header h1 {
                font-size: 1.1rem;
            }
            .header h1 span {
                font-size: 1.2rem !important;
            }
            .nav-tabs {
                width: 100%;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
                justify-content: flex-start;
                padding: 4px;
                gap: 4px;
            }
            .nav-tabs::-webkit-scrollbar {
                display: none;
            }
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.75rem;
                white-space: nowrap;
                flex-shrink: 0;
            }
            .header-stats {
                gap: 15px;
            }
            .stat-value {
                font-size: 1rem;
            }
            .stat-label {
                font-size: 0.65rem;
            }
            .sidebar {
                max-height: 35vh;
            }
            .sidebar-section {
                padding: 15px;
            }
            .resort-card {
                padding: 12px 15px;
            }
            .resort-name {
                font-size: 0.9rem;
            }
            #map {
                height: 45vh !important;
            }
            /* Budget view mobile */
            .budget-view {
                padding: 15px;
            }
            .budget-header h2 {
                font-size: 1.3rem;
            }
            .budget-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .budget-card {
                padding: 16px;
            }
            .budget-target-display {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            .budget-total-row .amount {
                font-size: 1rem;
            }
            .budget-total-row.grand-total .amount {
                font-size: 1.4rem;
            }
            /* Info panel mobile */
            .info-panel {
                width: 100% !important;
                max-width: none !important;
                right: 0 !important;
                bottom: 0;
                top: auto !important;
                max-height: 70vh;
                border-radius: 20px 20px 0 0;
            }
            .deal-finder-section {
                grid-template-columns: 1fr;
            }
            /* Matrix table mobile */
            .matrix-container {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .matrix-table {
                font-size: 0.75rem;
            }
            .matrix-table th,
            .matrix-table td {
                padding: 8px 6px;
            }
            /* Voting view mobile */
            .voting-container {
                padding: 15px;
            }
            .voting-header h2 {
                font-size: 1.4rem;
            }
            .voter-select {
                gap: 8px;
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
                justify-content: flex-start;
                padding-bottom: 10px;
                flex-wrap: nowrap;
            }
            .voter-btn {
                padding: 10px 16px;
                font-size: 0.8rem;
                white-space: nowrap;
                flex-shrink: 0;
            }
            .voting-section {
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            .voting-section h3 {
                font-size: 1rem;
            }
            .resort-options {
                grid-template-columns: 1fr !important;
                gap: 12px;
            }
            .voting-summary {
                flex-direction: column;
                gap: 15px;
            }
            .voting-card {
                padding: 15px;
            }
            .family-member {
                padding: 12px;
            }
        }

        /* Small Mobile (under 480px) */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 0.95rem;
            }
            .nav-tab {
                padding: 6px 10px;
                font-size: 0.7rem;
            }
            .stat-value {
                font-size: 0.9rem;
            }
            .filter-chips {
                gap: 6px;
            }
            .chip {
                padding: 5px 10px;
                font-size: 0.7rem;
            }
            .resort-name {
                font-size: 0.85rem;
            }
            .price-value {
                font-size: 0.95rem;
            }
            /* Voting small mobile */
            .voting-header h2 {
                font-size: 1.2rem;
            }
            .voter-btn {
                padding: 8px 12px;
                font-size: 0.75rem;
            }
            .voting-section {
                padding: 15px 12px;
            }
            .voting-section h3 {
                font-size: 0.9rem;
            }
        }

        /* Sidebar */
        .sidebar {
            background: white;
            overflow-y: auto;
            border-right: 1px solid #e2e8f0;
        }

        .sidebar-section {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .sidebar-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 12px;
        }

        /* Filters */
        .filter-group {
            margin-bottom: 15px;
        }

        .filter-label {
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .chip {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            border: 2px solid #e2e8f0;
            background: white;
            transition: all 0.2s;
        }

        .chip:hover {
            border-color: var(--primary);
        }

        .chip.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .chip.family { border-color: #10b981; }
        .chip.family.active { background: #10b981; border-color: #10b981; }
        .chip.luxury { border-color: #f59e0b; }
        .chip.luxury.active { background: #f59e0b; border-color: #f59e0b; }
        .chip.points { border-color: #0891b2; }
        .chip.points.active { background: #0891b2; border-color: #0891b2; }
        .chip.accessible { border-color: #f97316; }
        .chip.accessible.active { background: #f97316; border-color: #f97316; }
        .chip.villa { border-color: #8b5cf6; }
        .chip.villa.active { background: #8b5cf6; border-color: #8b5cf6; }

        /* Resort List */
        .resort-list {
            padding: 0;
        }

        .resort-card {
            padding: 16px 20px;
            border-bottom: 1px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .resort-card:hover {
            background: linear-gradient(to right, #f0fdfa, #fefce8);
            transform: translateX(4px);
            box-shadow: -4px 0 12px rgba(8, 145, 178, 0.1);
        }

        .resort-card.selected {
            background: linear-gradient(to right, #cffafe, #fef3c7);
            border-left: 4px solid var(--primary);
        }

        .resort-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .resort-name {
            font-weight: 700;
            font-size: 1rem;
            color: var(--dark);
        }

        .resort-rating {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--warning);
        }

        .resort-location {
            font-size: 0.8rem;
            color: var(--gray);
            margin-bottom: 8px;
        }

        .resort-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 10px;
        }

        .tag {
            font-size: 0.7rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .tag-family { background: #d1fae5; color: #065f46; }
        .tag-luxury { background: #fef3c7; color: #92400e; }
        .tag-points { background: #cffafe; color: #0e7490; }
        .tag-accessible { background: #ffedd5; color: #c2410c; }
        .tag-adults { background: #fee2e2; color: #991b1b; }
        .tag-new { background: #cffafe; color: #0e7490; }
        .tag-villa { background: #ede9fe; color: #5b21b6; font-weight: 700; }

        .resort-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
        }

        .price-label {
            font-size: 0.75rem;
            color: var(--gray);
        }

        .vote-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: 2px solid var(--primary);
            background: transparent;
            color: var(--primary);
            font-weight: 600;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .vote-btn:hover {
            background: var(--primary);
            color: white;
        }

        .vote-btn.voted {
            background: var(--primary);
            color: white;
        }

        /* Map Container */
        .map-container {
            position: relative;
        }

        #map {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        /* Map Legend */
        .map-legend {
            position: absolute;
            bottom: 30px;
            left: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 500;
            font-size: 0.8rem;
        }

        .legend-title {
            font-weight: 700;
            margin-bottom: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 6px;
        }

        .legend-marker {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        /* Info Panel */
        .info-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 400px;
            max-height: calc(100% - 40px);
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 500;
            overflow: hidden;
            display: none;
        }

        .info-panel.active {
            display: block;
        }

        .info-panel-header {
            padding: 20px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
        }

        .info-panel-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
        }

        .info-panel-title {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .info-panel-subtitle {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .info-panel-body {
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }

        .info-section {
            margin-bottom: 20px;
        }

        .info-section-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--gray);
            margin-bottom: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .info-item {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
        }

        .info-item-label {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .info-item-value {
            font-weight: 700;
            font-size: 1rem;
        }

        .price-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .price-card {
            background: #f0fdf4;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .price-card.highlight {
            background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%);
            border: 2px solid #10b981;
        }

        .price-week {
            font-size: 0.75rem;
            color: var(--gray);
            margin-bottom: 4px;
        }

        .price-amount {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--success);
        }

        .link-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .link-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            background: #f8fafc;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .link-item:hover {
            background: #e2e8f0;
        }

        .link-icon {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }

        .link-icon.website { background: #dbeafe; color: #2563eb; }
        .link-icon.reviews { background: #fef3c7; color: #d97706; }
        .link-icon.points { background: #e0e7ff; color: #4f46e5; }
        .link-icon.booking { background: #d1fae5; color: #059669; }

        /* Views */
        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* Voting View */
        .voting-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }

        .voting-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .voting-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .voter-select {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .voter-btn {
            padding: 12px 24px;
            border-radius: 30px;
            border: 2px solid #e2e8f0;
            background: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .voter-btn:hover {
            border-color: var(--primary);
        }

        .voter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }

        .voting-section {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        .voting-section h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .vote-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .vote-option {
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .vote-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .vote-option.selected {
            border-color: var(--primary);
            background: linear-gradient(to right, #cffafe, #fef3c7);
        }

        .vote-option-name {
            font-weight: 700;
            margin-bottom: 5px;
        }

        .vote-option-detail {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .vote-count-display {
            margin-top: 10px;
            font-size: 0.8rem;
            color: var(--primary);
            font-weight: 600;
        }

        .vote-avatars {
            display: flex;
            gap: 4px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .vote-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 700;
        }

        /* Results Panel */
        .results-panel {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 50%, #0891b2 100%);
            color: white;
            border-radius: 16px;
            padding: 30px;
            margin-top: 30px;
        }

        .results-panel h3 {
            margin-bottom: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .result-label {
            font-weight: 500;
        }

        .result-value {
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Matrix View */
        .matrix-container {
            padding: 30px;
            overflow-x: auto;
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        .matrix-table th {
            background: var(--dark);
            color: white;
            padding: 14px 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            white-space: nowrap;
        }

        .matrix-table th:first-child {
            position: sticky;
            left: 0;
            z-index: 10;
        }

        .matrix-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            white-space: nowrap;
        }

        .matrix-table td:first-child {
            position: sticky;
            left: 0;
            background: white;
            font-weight: 600;
            z-index: 5;
        }

        .matrix-table tr:hover td {
            background: #f8fafc;
        }

        .matrix-table tr:hover td:first-child {
            background: #f1f5f9;
        }

        .check-yes { color: var(--success); font-weight: bold; }
        .check-no { color: #cbd5e1; }

        /* Family Info */
        .family-info {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .family-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .family-member {
            padding: 15px;
            background: #f8fafc;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .family-member h4 {
            margin-bottom: 5px;
        }

        .family-member p {
            font-size: 0.85rem;
            color: var(--gray);
        }

        /* Airport Info */
        .airport-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Deal Score Badges */
        .deal-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .deal-badge.hot-deal {
            background: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
            color: white;
            animation: pulse 2s infinite;
        }

        .deal-badge.good-value {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
        }

        .deal-badge.premium {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: #78350f;
        }

        .deal-badge.price-drop {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Price Trend Indicators */
        .trend-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .trend-indicator.down { color: #10b981; }
        .trend-indicator.up { color: #ef4444; }
        .trend-indicator.stable { color: #64748b; }

        /* Budget Calculator Styles */
        .budget-view {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
        }

        .budget-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .budget-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .budget-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .budget-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--dark);
        }

        .budget-card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .budget-input-group {
            margin-bottom: 15px;
        }

        .budget-input-group label {
            display: block;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--gray);
            margin-bottom: 6px;
        }

        .budget-input-group input,
        .budget-input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .budget-input-group input:focus,
        .budget-input-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(8, 145, 178, 0.1);
        }

        .budget-summary {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
            border-radius: 16px;
            padding: 30px;
        }

        .budget-summary h3 {
            margin-bottom: 20px;
        }

        .budget-total-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .budget-total-row:last-child {
            border-bottom: none;
            padding-top: 20px;
            margin-top: 10px;
            border-top: 2px solid rgba(255,255,255,0.3);
        }

        .budget-total-row .label {
            font-size: 0.95rem;
        }

        .budget-total-row .amount {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .budget-total-row.grand-total .label {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .budget-total-row.grand-total .amount {
            font-size: 1.8rem;
            font-weight: 800;
        }

        .per-person-badge {
            background: rgba(255,255,255,0.2);
            padding: 10px 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
        }

        .per-person-badge .amount {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .per-person-badge .label {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        /* Hidden Costs Section */
        .hidden-costs-panel {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
            border-left: 4px solid #f59e0b;
        }

        .hidden-costs-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 12px;
        }

        .hidden-cost-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(146, 64, 14, 0.1);
            font-size: 0.85rem;
        }

        .hidden-cost-item:last-child {
            border-bottom: none;
        }

        .hidden-cost-item .cost-label {
            color: #78350f;
        }

        .hidden-cost-item .cost-value {
            font-weight: 600;
            color: #92400e;
        }

        .hidden-cost-item .cost-value.included {
            color: #059669;
        }

        /* Deal Comparison Panel */
        .comparison-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
            z-index: 1000;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .comparison-panel.active {
            transform: translateY(0);
        }

        .comparison-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .comparison-item {
            padding: 15px 20px;
            border-right: 1px solid #e2e8f0;
            border-bottom: 1px solid #e2e8f0;
        }

        .comparison-item h4 {
            font-size: 0.95rem;
            margin-bottom: 10px;
        }

        .compare-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            padding: 4px 0;
        }

        /* Savings Summary */
        .savings-panel {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #10b981;
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
        }

        .savings-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #065f46;
            margin-bottom: 12px;
        }

        .savings-item {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 0.85rem;
            color: #047857;
        }

        .savings-total {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            margin-top: 8px;
            border-top: 2px solid #10b981;
            font-weight: 700;
            font-size: 1rem;
            color: #065f46;
        }

        /* Credit Card Portals */
        .portal-links {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .portal-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            text-decoration: none;
            transition: all 0.2s;
        }

        .portal-link:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .portal-link .portal-name {
            font-weight: 600;
            font-size: 0.8rem;
            color: var(--dark);
        }

        .portal-link .portal-bonus {
            font-size: 0.7rem;
            color: var(--success);
            margin-top: 4px;
        }

        /* Best Time to Book */
        .booking-tips {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-radius: 12px;
            padding: 16px;
            margin: 15px 0;
        }

        .booking-tips-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            color: #1e40af;
            margin-bottom: 12px;
        }

        .booking-deadline {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .booking-deadline .date {
            font-weight: 700;
            color: #1e40af;
            font-size: 0.85rem;
        }

        .booking-deadline .note {
            font-size: 0.8rem;
            color: #3b82f6;
        }

        /* Budget Fit Indicators */
        .budget-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 700;
        }

        .budget-under {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
        }

        .budget-sweet {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
            animation: glow 2s ease-in-out infinite;
        }

        .budget-over {
            background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);
            color: #78350f;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(59, 130, 246, 0.5); }
            50% { box-shadow: 0 0 15px rgba(59, 130, 246, 0.8); }
        }

        .budget-target-display {
            background: linear-gradient(135deg, #0e7490 0%, #06b6d4 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .budget-target-display h3 {
            margin: 0;
            font-size: 1rem;
        }

        .budget-target-range {
            display: flex;
            gap: 20px;
        }

        .budget-target-range .target-item {
            text-align: center;
        }

        .budget-target-range .target-value {
            font-size: 1.3rem;
            font-weight: 700;
        }

        .budget-target-range .target-label {
            font-size: 0.7rem;
            opacity: 0.8;
        }

        /* Compare checkbox */
        .compare-checkbox {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
        }

        .compare-checkbox input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .compare-checkbox label {
            font-size: 0.75rem;
            color: var(--gray);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1><span style="font-size:1.6rem;">ðŸŒ´</span> Cancun Family Vacation 2025 <span style="font-size:1.6rem;">ðŸŒŠ</span></h1>

            <nav class="nav-tabs">
                <button class="nav-tab active" data-view="map">Map</button>
                <button class="nav-tab" data-view="matrix">Full Matrix</button>
                <button class="nav-tab" data-view="budget">Deals & Budget</button>
                <button class="nav-tab" data-view="voting">Family Voting</button>
            </nav>

            <div class="header-stats">
                <div class="stat">
                    <div class="stat-value">14</div>
                    <div class="stat-label">People</div>
                </div>
                <div class="stat">
                    <div class="stat-value">7</div>
                    <div class="stat-label">Rooms</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="resortCount">45</div>
                    <div class="stat-label">Options</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Map View -->
    <div class="view active" id="view-map">
        <div class="main-container">
            <aside class="sidebar">
                <div class="sidebar-section">
                    <div class="sidebar-title">Target Weeks</div>
                    <div class="filter-chips">
                        <div class="chip active" data-week="may24">May 24-31 (Best $)</div>
                        <div class="chip" data-week="may31">May 31 - Jun 7</div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <div class="sidebar-title">Filter Resorts</div>

                    <div class="filter-group">
                        <span class="filter-label">Area</span>
                        <div class="filter-chips">
                            <div class="chip active" data-filter="area" data-value="all">All</div>
                            <div class="chip" data-filter="area" data-value="cancun">Cancun</div>
                            <div class="chip" data-filter="area" data-value="riviera">Riviera Maya</div>
                            <div class="chip" data-filter="area" data-value="tulum">Tulum</div>
                            <div class="chip" data-filter="area" data-value="costa">Costa Mujeres</div>
                        </div>
                    </div>

                    <div class="filter-group">
                        <span class="filter-label">Features</span>
                        <div class="filter-chips">
                            <div class="chip family" data-filter="feature" data-value="family">Family</div>
                            <div class="chip accessible" data-filter="feature" data-value="accessible">Accessible</div>
                            <div class="chip points" data-filter="feature" data-value="points">Bookable w/ Points</div>
                            <div class="chip luxury" data-filter="feature" data-value="luxury">Luxury</div>
                            <div class="chip villa" data-filter="feature" data-value="villa">Private Villas</div>
                        </div>
                    </div>

                    <div class="filter-group">
                        <span class="filter-label">Price Range (per room/night)</span>
                        <div class="filter-chips">
                            <div class="chip active" data-filter="price" data-value="all">All</div>
                            <div class="chip" data-filter="price" data-value="budget">Under $300</div>
                            <div class="chip" data-filter="price" data-value="mid">$300-500</div>
                            <div class="chip" data-filter="price" data-value="luxury">$500+</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section" style="padding: 0;">
                    <div class="sidebar-title" style="padding: 20px 20px 10px;">Resorts (<span id="filteredCount">0</span>)</div>
                    <div class="resort-list" id="resortList"></div>
                </div>
            </aside>

            <div class="map-container">
                <div id="map"></div>

                <div class="map-legend">
                    <div class="legend-title">Legend</div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #10b981;"></div>
                        <span>Family-Friendly</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #f59e0b;"></div>
                        <span>Luxury</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #0891b2;"></div>
                        <span>Points Eligible</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #ef4444;"></div>
                        <span>Adults Only</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #f97316;"></div>
                        <span>Accessible</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-marker" style="background: #8b5cf6;"></div>
                        <span>Private Villa</span>
                    </div>
                </div>

                <div class="info-panel" id="infoPanel">
                    <button class="info-panel-close" onclick="closeInfoPanel()">&times;</button>
                    <div class="info-panel-header">
                        <div class="info-panel-title" id="panelTitle">Resort Name</div>
                        <div class="info-panel-subtitle" id="panelSubtitle">Location</div>
                    </div>
                    <div class="info-panel-body" id="panelBody"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Matrix View -->
    <div class="view" id="view-matrix">
        <div class="matrix-container">
            <div class="family-info">
                <h3>Our Group</h3>
                <div class="family-grid">
                    <div class="family-member">
                        <h4>Tom & Julie (Mom & Dad)</h4>
                        <p>2 people (near 80, mobility needs)</p>
                        <p>Des Moines, IA</p>
                    </div>
                    <div class="family-member">
                        <h4>Becketts Family</h4>
                        <p>5 people (3 college-age)</p>
                        <p>Iowa City, IA</p>
                    </div>
                    <div class="family-member">
                        <h4>Our Family</h4>
                        <p>4 people (kids 9 & 11)</p>
                        <p>Florida</p>
                    </div>
                    <div class="family-member">
                        <h4>Dann & Husband</h4>
                        <p>2 people</p>
                        <p>Omaha, NE</p>
                    </div>
                </div>
            </div>

            <table class="matrix-table" id="matrixTable">
                <thead>
                    <tr>
                        <th>Resort</th>
                        <th>Area</th>
                        <th>Airport</th>
                        <th>May 24-31</th>
                        <th>May 31-Jun 7</th>
                        <th>7 Nights Total</th>
                        <th>Family</th>
                        <th>Accessible</th>
                        <th>Points</th>
                        <th>Rating</th>
                        <th>Links</th>
                    </tr>
                </thead>
                <tbody id="matrixBody"></tbody>
            </table>
        </div>
    </div>

    <!-- Voting View -->
    <div class="view" id="view-voting">
        <div class="voting-container">
            <div class="voting-header">
                <h2>Family Voting</h2>
                <p>Select your name and vote for your top picks!</p>

                <div class="voter-select" id="voterSelect"></div>
            </div>

            <div class="voting-section">
                <h3>Top Resort Choice</h3>
                <div class="vote-options" id="resortVoteOptions"></div>
            </div>

            <div class="voting-section">
                <h3>Preferred Week</h3>
                <div class="vote-options" id="weekVoteOptions">
                    <div class="vote-option" data-category="week" data-value="may24">
                        <div class="vote-option-name">May 24-31, 2025</div>
                        <div class="vote-option-detail">Best value - shoulder season pricing</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                    <div class="vote-option" data-category="week" data-value="may31">
                        <div class="vote-option-name">May 31 - June 7, 2025</div>
                        <div class="vote-option-detail">Early summer - slightly higher prices</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                </div>
            </div>

            <div class="voting-section">
                <h3>Trip Length</h3>
                <div class="vote-options" id="lengthVoteOptions">
                    <div class="vote-option" data-category="length" data-value="5">
                        <div class="vote-option-name">5 Nights</div>
                        <div class="vote-option-detail">Shorter trip, lower cost</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                    <div class="vote-option" data-category="length" data-value="7">
                        <div class="vote-option-name">7 Nights</div>
                        <div class="vote-option-detail">Recommended - full week</div>
                        <div class="vote-count-display"></div>
                        <div class="vote-avatars"></div>
                    </div>
                </div>
            </div>

            <div class="results-panel">
                <h3>Current Results</h3>
                <div id="votingResults"></div>
            </div>
        </div>
    </div>

    <!-- Budget & Deals View -->
    <div class="view" id="view-budget">
        <div class="budget-view">
            <div class="budget-header">
                <h2>Trip Budget Calculator & Deal Finder</h2>
                <p>Calculate your total trip cost and find the best deals for your group of 14</p>
            </div>

            <div class="budget-target-display">
                <div>
                    <h3>Your Budget Target</h3>
                    <div style="font-size:0.8rem;opacity:0.9;">Total trip for 13 people, 7 nights</div>
                </div>
                <div class="budget-target-range">
                    <div class="target-item">
                        <div class="target-value">$20K</div>
                        <div class="target-label">MIN</div>
                    </div>
                    <div class="target-item" style="background:rgba(255,255,255,0.15);padding:5px 15px;border-radius:8px;">
                        <div class="target-value">$22.5K</div>
                        <div class="target-label">SWEET SPOT</div>
                    </div>
                    <div class="target-item">
                        <div class="target-value">$25K</div>
                        <div class="target-label">MAX</div>
                    </div>
                </div>
            </div>

            <div class="budget-grid">
                <!-- Resort Selection -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#cffafe;color:#0891b2;">1</span>
                        Select Resort
                    </h3>
                    <div class="budget-input-group">
                        <label>Choose Resort</label>
                        <select id="budgetResort" onchange="updateBudgetCalc()">
                            <option value="">-- Select a resort --</option>
                        </select>
                    </div>
                    <div class="budget-input-group">
                        <label>Travel Week</label>
                        <select id="budgetWeek" onchange="updateBudgetCalc()">
                            <option value="may24">May 24-31, 2025 (Best Value)</option>
                            <option value="may31">May 31 - Jun 7, 2025</option>
                        </select>
                    </div>
                    <div class="budget-input-group">
                        <label>Number of Nights</label>
                        <select id="budgetNights" onchange="updateBudgetCalc()">
                            <option value="5">5 nights</option>
                            <option value="6">6 nights</option>
                            <option value="7" selected>7 nights</option>
                        </select>
                    </div>
                    <div id="resortDealBadge" style="margin-top:15px;"></div>
                </div>

                <!-- Flights -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#dbeafe;color:#2563eb;">2</span>
                        Flights (13 people)
                    </h3>
                    <div class="budget-input-group">
                        <label>Des Moines Group (2 people - Tom & Julie)</label>
                        <input type="number" id="flightDSM" value="450" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Iowa City Group (5 people - Becketts)</label>
                        <input type="number" id="flightIC" value="420" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Florida Group (4 people - Your family)</label>
                        <input type="number" id="flightFL" value="280" onchange="updateBudgetCalc()">
                    </div>
                    <div class="budget-input-group">
                        <label>Omaha (2 people - Dann & Husband)</label>
                        <input type="number" id="flightOMA" value="380" onchange="updateBudgetCalc()">
                    </div>
                    <div style="margin-top:10px;padding:12px;background:#f0fdf4;border-radius:8px;">
                        <div style="font-size:0.8rem;color:#059669;font-weight:600;">Flight Tips:</div>
                        <div style="font-size:0.75rem;color:#047857;margin-top:4px;">Southwest from Omaha has seasonal direct flights. Check Google Flights for best prices.</div>
                    </div>
                </div>

                <!-- Transfers -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#fef3c7;color:#d97706;">3</span>
                        Airport Transfers
                    </h3>
                    <div class="budget-input-group">
                        <label>Transfer Type</label>
                        <select id="transferType" onchange="updateBudgetCalc()">
                            <option value="private">Private Van (2 vans, door-to-door)</option>
                            <option value="shared">Shared Shuttle (per person)</option>
                            <option value="included">Included with Resort</option>
                        </select>
                    </div>
                    <div id="transferCostNote" style="margin-top:10px;padding:12px;background:#fef3c7;border-radius:8px;font-size:0.8rem;color:#92400e;"></div>
                </div>

                <!-- Excursions -->
                <div class="budget-card">
                    <h3>
                        <span class="budget-card-icon" style="background:#f0fdf4;color:#059669;">4</span>
                        Excursions & Activities
                    </h3>
                    <div class="budget-input-group">
                        <label>Estimated per person for activities</label>
                        <select id="excursionBudget" onchange="updateBudgetCalc()">
                            <option value="0">None / Resort Only</option>
                            <option value="100">Light ($100/person) - 1 day trip</option>
                            <option value="200" selected>Moderate ($200/person) - 2-3 activities</option>
                            <option value="350">Full ($350/person) - Multiple parks/tours</option>
                        </select>
                    </div>
                    <div style="margin-top:10px;padding:12px;background:#f0fdf4;border-radius:8px;">
                        <div style="font-size:0.8rem;color:#059669;font-weight:600;">Popular Options:</div>
                        <ul style="font-size:0.75rem;color:#047857;margin:4px 0 0 15px;">
                            <li>Xcaret Park: ~$130/adult</li>
                            <li>Chichen Itza Tour: ~$80/person</li>
                            <li>Snorkeling Tour: ~$50/person</li>
                            <li>Hotel Xcaret includes ALL parks!</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Deal Finder Section -->
            <div style="background:white;border-radius:16px;padding:24px;margin-bottom:20px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">ðŸ”</span> Deal Finder & Booking Tips
                </h3>
                <div style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:20px;">
                    <!-- Best Time to Book -->
                    <div class="booking-tips">
                        <div class="booking-tips-title">
                            <span>ðŸ“…</span> Best Time to Book
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Jan 15 - Feb 28</span>
                            <span class="note">Optimal booking window for May 2025</span>
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Feb 15</span>
                            <span class="note">Prices increase after President's Day</span>
                        </div>
                        <div class="booking-deadline">
                            <span class="date">Mar 1</span>
                            <span class="note">Spring break surge pricing starts</span>
                        </div>
                    </div>

                    <!-- Credit Card Portals -->
                    <div style="background:linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%);border-radius:12px;padding:16px;">
                        <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:#5b21b6;margin-bottom:12px;">
                            <span>ðŸ’³</span> Credit Card Portal Bonuses
                        </div>
                        <div class="portal-links">
                            <a href="https://ultimaterewardspoints.chase.com" target="_blank" class="portal-link">
                                <span class="portal-name">Chase Travel</span>
                                <span class="portal-bonus">1.5x points (Reserve)</span>
                            </a>
                            <a href="https://travel.americanexpress.com" target="_blank" class="portal-link">
                                <span class="portal-name">Amex Travel</span>
                                <span class="portal-bonus">5x on flights</span>
                            </a>
                            <a href="https://travel.capitalone.com" target="_blank" class="portal-link">
                                <span class="portal-name">Capital One</span>
                                <span class="portal-bonus">10x on hotels</span>
                            </a>
                            <a href="https://www.costcotravel.com" target="_blank" class="portal-link">
                                <span class="portal-name">Costco Travel</span>
                                <span class="portal-bonus">15-25% savings!</span>
                            </a>
                        </div>
                    </div>

                    <!-- Package Deals -->
                    <div style="background:linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);border-radius:12px;padding:16px;">
                        <div style="display:flex;align-items:center;gap:8px;font-weight:700;color:#92400e;margin-bottom:12px;">
                            <span>ðŸ“¦</span> Package Deals (Flight + Hotel)
                        </div>
                        <div style="display:grid;gap:8px;">
                            <a href="https://www.costcotravel.com/Vacation-Packages/Mexico" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Costco Travel</span>
                                <span style="color:#059669;font-weight:600;">Best Value!</span>
                            </a>
                            <a href="https://www.southwestvacations.com" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Southwest Vacations</span>
                                <span style="color:#64748b;">Free bags/changes</span>
                            </a>
                            <a href="https://www.applevacations.com" target="_blank" style="display:flex;justify-content:space-between;padding:10px;background:white;border-radius:8px;text-decoration:none;color:#78350f;">
                                <span style="font-weight:600;">Apple Vacations</span>
                                <span style="color:#64748b;">Charter flights</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Budget Summary -->
            <div class="budget-summary" id="budgetSummary">
                <h3>Trip Budget Summary</h3>
                <p style="opacity:0.8;margin-bottom:20px;">Select a resort above to calculate your total trip cost</p>
            </div>

            <!-- Comparison Panel -->
            <div style="margin-top:20px;background:white;border-radius:16px;padding:24px;box-shadow:0 4px 20px rgba(0,0,0,0.08);">
                <h3 style="margin-bottom:20px;display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.5rem;">âš–ï¸</span> Quick Comparison: Top Picks for Your Group
                </h3>
                <div id="quickComparison" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(280px, 1fr));gap:15px;">
                </div>
            </div>
        </div>
    </div>

    <!-- Side-by-Side Comparison Panel -->
    <div class="comparison-panel" id="comparisonPanel">
        <div class="comparison-header">
            <h3>Comparing <span id="compareCount">0</span> Resorts</h3>
            <button onclick="clearComparison()" style="background:rgba(255,255,255,0.2);border:none;color:white;padding:8px 16px;border-radius:6px;cursor:pointer;">Clear All</button>
        </div>
        <div class="comparison-grid" id="comparisonGrid"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Comprehensive Resort Database
        const resorts = [
            // CANCUN HOTEL ZONE
            {
                id: 1,
                name: "Hyatt Ziva Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0892,
                lng: -86.7720,
                airportDist: "25 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 12500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hyatt",
                pointsCost: "25,000-50,000/night",
                website: "https://www.hyatt.com/en-US/hotel/mexico/hyatt-ziva-cancun/cunif",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d152887-Reviews-Hyatt_Ziva_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Turquoize adults tower", "Kids club", "Swim-up suites", "World of Hyatt"],
                notes: "Has adults-only Turquoize tower within resort - great for grandparents wanting quiet",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2023 (partial)",
                serviceRating: "Excellent",
                insiderTip: "CAUTION: Main building renovation ongoing - no main buffet currently. Reddit users report food quality dropped. Turquoize tower is adults-only oasis WITHIN resort - perfect split for your group! Points value ~$425/night = good redemption at 25k points.",
                crowdLevel: "Medium-High"
            },
            {
                id: 2,
                name: "Hard Rock Hotel Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0998,
                lng: -86.7634,
                airportDist: "20 min",
                priceMay24: 320,
                priceMay31: 360,
                rating: 4.4,
                reviews: 9800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.hardrockhotels.com/cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d1022636-Reviews-Hard_Rock_Hotel_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Best accessibility", "Ramps everywhere", "Rock Star suites", "Water park"],
                notes: "HIGHLY recommended for mobility - ramps to beach and pool, wheelchair accessible throughout",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "TOP PICK FOR YOUR GROUP! Reddit unanimously recommends for wheelchair users - ramps to beach AND pool, golf carts available. Staff very accommodating with mobility needs. Great value at $320/night. Water park keeps kids busy while grandparents relax.",
                crowdLevel: "Medium"
            },
            {
                id: 3,
                name: "Moon Palace Cancun",
                area: "cancun",
                areaName: "Cancun (South)",
                lat: 20.9847,
                lng: -86.8318,
                airportDist: "15 min",
                priceMay24: 350,
                priceMay31: 400,
                rating: 4.5,
                reviews: 28000,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.moonpalacecancun.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155263-Reviews-Moon_Palace_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Massive resort", "FlowRider", "Waterpark", "Golf", "Resort credits"],
                notes: "Huge property - lots of walking. Great for active families, may be tiring for elderly",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2018",
                serviceRating: "Mixed",
                insiderTip: "WARNING: Reddit reviews are VERY mixed. 'Not worth the price' is common complaint. High season = overcrowded, buffet lines long. Beach is reportedly 'non-usable'. Great waterpark but NOT recommended for honeymoons or quiet getaways. Consider Grand for better experience.",
                crowdLevel: "Very High"
            },
            {
                id: 4,
                name: "Grand Fiesta Americana Coral Beach",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.1303,
                lng: -86.7462,
                airportDist: "30 min",
                priceMay24: 480,
                priceMay31: 520,
                rating: 4.7,
                reviews: 6200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.fiestamericanagrand.com/en/coral-beach-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d154435-Reviews-Grand_Fiesta_Americana_Coral_Beach_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["AAA Five Diamond", "Gem Spa", "Butler service", "Premium location"],
                notes: "Luxury option with excellent service. Good accessibility.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2022",
                serviceRating: "Outstanding",
                insiderTip: "REDDIT FAVORITE! 97 upvotes on review saying 'we loved it'. Staff know guests by name. Spacious layout means less crowded than neighbors. Perfect for families who want quality over activities. Frequent travelers' go-to at $500-600/night. Live music excellent!",
                crowdLevel: "Low-Medium"
            },
            {
                id: 5,
                name: "Club Med Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0736,
                lng: -86.7832,
                airportDist: "25 min",
                priceMay24: 400,
                priceMay31: 450,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.clubmed.us/r/cancun/y",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d154474-Reviews-Club_Med_Cancun_Yucatan-Cancun_Yucatan_Peninsula.html",
                features: ["Kids clubs 0-17", "Circus school", "Trapeze", "All activities included"],
                notes: "Excellent for multigenerational - dedicated kids clubs for all ages",
                valueScore: 7,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "Unique all-inclusive concept with circus school & trapeze! Kids LOVE it. However, showing age in some areas. All activities truly included (sailing, water sports). French influence means excellent food variety.",
                crowdLevel: "Medium"
            },
            {
                id: 6,
                name: "Paradisus Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0654,
                lng: -86.7878,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 7800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "melia",
                pointsCost: "Melia Rewards",
                website: "https://www.melia.com/en/hotels/mexico/cancun/paradisus-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155685-Reviews-Paradisus_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Family Concierge", "YHI Spa", "Royal Service option"],
                notes: "Good value luxury with family concierge service",
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "Family Concierge level is worth the upgrade - dedicated check-in, lounge access, kid amenities. Good value compared to luxury competitors. Melia Rewards members get perks. Beach can get seaweed in summer.",
                crowdLevel: "Medium"
            },
            {
                id: 7,
                name: "Hilton Cancun",
                area: "cancun",
                areaName: "Cancun (South)",
                lat: 20.9764,
                lng: -86.8342,
                airportDist: "12 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.5,
                reviews: 3200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hilton",
                pointsCost: "80,000-120,000/night",
                website: "https://www.hilton.com/en/hotels/cunhihi-hilton-cancun-an-all-inclusive-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d23462107-Reviews-Hilton_Cancun_an_All_Inclusive_Resort-Cancun_Yucatan_Peninsula.html",
                features: ["Newer property (2021)", "Hilton Honors", "Multiple pools", "Golf access"],
                notes: "Newer resort, Hilton points eligible, good for families",
                valueScore: 8,
                renovated: "2021 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BRAND NEW (2021)! One of the newest all-inclusives in Cancun. Hilton Honors points work here - 80-120k/night is decent value. Closest resort to airport (12 min). Modern rooms, great pools. Still working out kinks but improving fast.",
                crowdLevel: "Medium"
            },
            {
                id: 8,
                name: "Dreams Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2547,
                lng: -86.8012,
                airportDist: "30 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.6,
                reviews: 8500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.dreamsresorts.com/playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d8082143-Reviews-Dreams_Playa_Mujeres_Golf_Spa_Resort-Cancun_Yucatan_Peninsula.html",
                features: ["Quieter area", "Golf course", "Explorer's Club kids", "Core Zone teens"],
                notes: "Quieter than Hotel Zone, great kids programs, Marriott Bonvoy",
                valueScore: 8,
                renovated: "2018",
                serviceRating: "Very Good",
                insiderTip: "GREAT FOR YOUR GROUP! Quieter Costa Mujeres area perfect for elderly. Marriott Bonvoy points work. Explorer's Club for kids 3-12 is excellent. Golf course on-site. Less party atmosphere than Hotel Zone. Reddit recommends over Finest for families.",
                crowdLevel: "Low"
            },
            {
                id: 9,
                name: "Finest Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2612,
                lng: -86.7987,
                airportDist: "35 min",
                priceMay24: 520,
                priceMay31: 580,
                rating: 4.7,
                reviews: 4800,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.theexcellencecollection.com/finest-playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d8546989-Reviews-Finest_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Luxury family", "Suite hotel", "Imagine kids club", "Rooftop pools"],
                notes: "Premium family resort, all suites, excellent for multigenerational",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2016 (Original)",
                serviceRating: "Top Notch",
                insiderTip: "Reddit rates 8.5/10. 'Service is absolutely top notch, food outstanding'. Kids club takes ages 3+ without parent! Small resort = you'll see kids regularly. ISSUE: Max 5 people/family suite, max 3 adults (13+) per room - may need creative booking for your 14. Some wear showing in 2024 reviews.",
                crowdLevel: "Low"
            },
            {
                id: 10,
                name: "Majestic Elegance Costa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2498,
                lng: -86.8045,
                airportDist: "30 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 5600,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.majestic-resorts.com/en/hotel/majestic-elegance-costa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d17448876-Reviews-Majestic_Elegance_Costa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Elegance Club upgrade", "Water park", "Family suites"],
                notes: "Good value in quieter Costa Mujeres area",
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "Elegance Club upgrade worth considering for better beach/pool area. Water park keeps kids busy. Good value vs neighbors. Costa Mujeres area is quieter. Some rooms show wear - request renovated building.",
                crowdLevel: "Medium"
            },
            // RIVIERA MAYA
            {
                id: 11,
                name: "Generations Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6523,
                lng: -87.0587,
                airportDist: "45 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.7,
                reviews: 3200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.genrivieramaya.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d4083498-Reviews-Generations_Riviera_Maya_Family_Resort-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["BUILT for multigenerational", "All oceanfront suites", "Baby to boomers", "Gourmet dining"],
                notes: "TOP PICK - Specifically designed for multigenerational families. All suites oceanfront.",
                valueScore: 10,
                renovated: "2017",
                serviceRating: "Outstanding",
                insiderTip: "IDEAL FOR YOUR GROUP! Literally DESIGNED for multigenerational travel! All suites face ocean. Baby concierge, kids club, teen lounge, adult wellness - everyone covered. Gourmet Inclusive dining. Staff trained specifically for multi-gen groups. Higher price but WORTH IT for your mix of ages.",
                crowdLevel: "Low"
            },
            {
                id: 12,
                name: "Grand Velas Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6891,
                lng: -87.0312,
                airportDist: "40 min",
                priceMay24: 550,
                priceMay31: 620,
                rating: 4.8,
                reviews: 9500,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://rivieramaya.grandvelas.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d1204526-Reviews-Grand_Velas_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["AAA Five Diamond", "8 restaurants", "SE Spa", "Kids/Teen clubs", "3 ambiances"],
                notes: "Luxury option - most expensive but highest rated. Amazing food.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2022",
                serviceRating: "Outstanding",
                insiderTip: "SPLURGE PICK! Consistently rated best all-inclusive in Mexico. Three ambiances (Zen, Ambassador, Grand Class) let you choose vibe. Food is genuinely gourmet - not typical buffet fare. Reddit says 'worth every penny'. If budget allows, this delivers true luxury experience.",
                crowdLevel: "Low-Medium"
            },
            {
                id: 13,
                name: "Sensira Resort & Spa",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7234,
                lng: -87.0123,
                airportDist: "35 min",
                priceMay24: 380,
                priceMay31: 430,
                rating: 4.5,
                reviews: 1800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://sensiraresorts.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d23557162-Reviews-Sensira_Resort_Spa_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Family union concept", "Rooms up to 7 guests", "Aqua park", "Wellness focus"],
                notes: "Newer property built around family bonding. $300 resort credit booking direct.",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2021 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "HIDDEN GEM! Newer resort specifically designed for multi-gen families. Rooms fit up to 7 people - perfect for your group! $300 resort credit when booking direct is real value. Wellness focus great for elderly. Less crowded than mega-resorts.",
                crowdLevel: "Low"
            },
            {
                id: 14,
                name: "Royalton Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7612,
                lng: -86.9876,
                airportDist: "25 min",
                priceMay24: 320,
                priceMay31: 360,
                rating: 4.3,
                reviews: 14200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "60,000-80,000/night",
                website: "https://www.royaltonresorts.com/royalton-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d7019593-Reviews-Royalton_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Sports Event Guarantee", "Clubhouse kids", "Water park"],
                notes: "Good value, Marriott points eligible, large property",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "POINTS VALUE! Marriott Bonvoy at 60-80k/night is decent redemption. Large property - lots of walking. Water park great for kids 9-11. Diamond Club upgrade worth it for better service. Some reviews mention dated rooms - request renovated building.",
                crowdLevel: "Medium-High"
            },
            {
                id: 15,
                name: "Iberostar Selection Paraiso Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7156,
                lng: -87.0089,
                airportDist: "30 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 11000,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.iberostar.com/en/hotels/riviera-maya/iberostar-selection-paraiso-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d592583-Reviews-Iberostar_Selection_Paraiso_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Part of 5-resort complex", "Marriott Bonvoy", "Water park", "Star Camp kids"],
                notes: "Good family resort, part of larger Paraiso complex",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "Great for kids 7-9! Part of 5-resort complex so tons to explore. WATCH OUT: Pushy timeshare sales, slow elevators, buffet closed 11am-1pm (only burgers/hot dogs). Good golf course. If traveling with kids & OK with buffet most nights, solid choice.",
                crowdLevel: "Medium"
            },
            {
                id: 16,
                name: "Hotel Xcaret Mexico",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.5812,
                lng: -87.1187,
                airportDist: "55 min",
                priceMay24: 480,
                priceMay31: 540,
                rating: 4.7,
                reviews: 7200,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.hotelxcaret.com/en/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d12149498-Reviews-Hotel_Xcaret_Mexico-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Includes ALL Xcaret parks", "Unique eco-design", "Underground rivers", "Mexican culture"],
                notes: "All Xcaret parks included - incredible value if you want park access. Very unique.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2017 (Original)",
                serviceRating: "Excellent",
                insiderTip: "BEST VALUE FOR ACTIVITIES! All 10+ Xcaret parks included ($1200+ value). Underground river rooms are magical. Mexican culture focus educational for kids. CAUTION: 55min from airport, can feel remote. If your group wants parks anyway, this is unbeatable value.",
                crowdLevel: "Medium"
            },
            {
                id: 17,
                name: "Barcelo Maya Palace",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.4534,
                lng: -87.2234,
                airportDist: "70 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.3,
                reviews: 16500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.barcelo.com/en-us/barcelo-maya-palace/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d500888-Reviews-Barcelo_Maya_Palace-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Huge complex", "Multiple hotels", "Pirates island water park", "Good value"],
                notes: "Budget-friendly option, part of massive Barcelo Maya complex",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Mixed",
                insiderTip: "BUDGET PICK! Cheapest family option at $280/night. Part of massive 5-hotel complex = lots to explore but can feel crowded. Pirates waterpark is huge hit with kids. 70min from airport is long drive. Good if budget is priority over luxury.",
                crowdLevel: "High"
            },
            {
                id: 18,
                name: "Hyatt Vivid Playa del Carmen",
                area: "riviera",
                areaName: "Playa del Carmen",
                lat: 20.6298,
                lng: -87.0712,
                airportDist: "50 min",
                priceMay24: 350,
                priceMay31: 390,
                rating: 4.5,
                reviews: 2100,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: "hyatt",
                pointsCost: "25,000-40,000/night",
                website: "https://www.hyatt.com/en-US/hotel/mexico/hyatt-vivid-playa-del-carmen/cunpd",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d25246619-Reviews-Hyatt_Vivid_Playa_del_Carmen-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Hyatt points", "Newer property", "Fifth Avenue nearby"],
                notes: "Adults only - good for Dann & husband or grandparents if wanting separate stay",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2023 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "NEWEST HYATT in area! Adults-only so perfect for Dann & husband. Fifth Avenue walkable = nightlife/shopping access. Hyatt points at 25-40k/night is solid value. Modern rooms, rooftop pool. Trendy vibe may appeal to younger adults in group.",
                crowdLevel: "Medium"
            },
            {
                id: 19,
                name: "Planet Hollywood Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7534,
                lng: -86.9923,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "60,000-80,000/night",
                website: "https://www.planethollywoodhotels.com/cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d15092376-Reviews-Planet_Hollywood_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Movie memorabilia", "PH Spa", "Stars kids club"],
                notes: "Fun theme, Marriott points, good for families",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2020",
                serviceRating: "Good",
                insiderTip: "FUN THEME! Kids will love the movie memorabilia. Marriott Bonvoy points work here. Stars Kids Club keeps children entertained. Not as upscale as name suggests but solid mid-range option. Good value if you want brand recognition + points.",
                crowdLevel: "Medium"
            },
            {
                id: 20,
                name: "Secrets Akumal",
                area: "riviera",
                areaName: "Akumal",
                lat: 20.3956,
                lng: -87.3112,
                airportDist: "75 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.6,
                reviews: 8900,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/akumal-riviera-maya",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g499447-d8518695-Reviews-Secrets_Akumal_Riviera_Maya-Akumal_Yucatan_Peninsula.html",
                features: ["Adults only", "AAA Four Diamond", "Sea turtle area", "Unlimited luxury"],
                notes: "Adults only - good for couples in family wanting romantic escape",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "BEST FOR COUPLES! Adults-only with Marriott Bonvoy. Sea turtles nest on beach - magical experience. Akumal = quieter area. Good for Dann & husband or grandparents wanting peace. AAA Four Diamond quality. Long drive from airport (75min) but worth it for serenity.",
                crowdLevel: "Low"
            },
            // TULUM AREA
            {
                id: 21,
                name: "Hilton Tulum Riviera Maya",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2712,
                lng: -87.4234,
                airportDist: "90 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.6,
                reviews: 2800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "hilton",
                pointsCost: "80,000-120,000/night",
                website: "https://www.hilton.com/en/hotels/tulaihh-hilton-tulum-riviera-maya-all-inclusive-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d23461797-Reviews-Hilton_Tulum_Riviera_Maya_All_Inclusive_Resort-Tulum_Yucatan_Peninsula.html",
                features: ["Hilton Honors", "World-class fitness", "Near ruins", "Newer property"],
                notes: "Best Tulum option for families, Hilton points",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2022 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BEST TULUM FOR FAMILIES! Newest resort in Tulum area. Hilton Honors points at 80-120k/night. World-class gym. Near Tulum ruins = easy excursion. CAUTION: 90min from airport is long with kids. Worth it if you want Tulum vibe + family amenities.",
                crowdLevel: "Medium"
            },
            {
                id: 22,
                name: "Dreams Tulum Resort & Spa",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2634,
                lng: -87.4312,
                airportDist: "90 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.4,
                reviews: 12300,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.dreamsresorts.com/tulum",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d152897-Reviews-Dreams_Tulum_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Explorer's Club kids", "Near Tulum ruins"],
                notes: "Good family option in Tulum, longer drive from airport",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "SOLID TULUM OPTION! Marriott Bonvoy compatible. Explorer's Club great for kids 3-12. Near ruins and cenotes. More established than newer competitors. Some rooms dated - request ocean view for best experience. 90min drive manageable if you want authentic Tulum feel.",
                crowdLevel: "Medium"
            },
            {
                id: 23,
                name: "Grand Bahia Principe Tulum",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2478,
                lng: -87.4456,
                airportDist: "95 min",
                priceMay24: 260,
                priceMay31: 300,
                rating: 4.3,
                reviews: 9800,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.bahia-principe.com/en/resorts-mexico/resort-grand-tulum/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d500894-Reviews-Grand_Bahia_Principe_Tulum-Tulum_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Part of complex", "Water park", "Good for value"],
                notes: "Most affordable Tulum option, good for budget-conscious",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2017",
                serviceRating: "Mixed",
                insiderTip: "BUDGET TULUM! Cheapest way to get Tulum at $260/night. Part of larger complex = more options. Water park keeps kids happy. Service can be inconsistent. 95min drive is longest. Good if you want Tulum on a budget but manage expectations.",
                crowdLevel: "High"
            },
            {
                id: 24,
                name: "Kore Tulum Retreat",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2156,
                lng: -87.4623,
                airportDist: "100 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 3200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://koretulum.com/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d1493827-Reviews-Kore_Tulum_Retreat_Wellness_Resort-Tulum_Yucatan_Peninsula.html",
                features: ["Adults only", "Wellness focus", "Boutique", "Spa focused"],
                notes: "Adults only - boutique wellness option",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "WELLNESS RETREAT! Adults-only boutique for those wanting spa/wellness focus. Great for grandparents wanting tranquility. Smaller = more intimate service. Real Tulum bohemian vibe. 100min from airport is far but you're here to disconnect.",
                crowdLevel: "Very Low"
            },
            {
                id: 25,
                name: "Grand Palladium White Sand",
                area: "riviera",
                areaName: "Riviera Maya (near Tulum)",
                lat: 20.3534,
                lng: -87.3423,
                airportDist: "80 min",
                priceMay24: 300,
                priceMay31: 340,
                rating: 4.3,
                reviews: 11200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.palladiumhotelgroup.com/en/hotels/mexico/rivieramaya/grand-palladium-white-sand-resort-spa",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g1229481-d292294-Reviews-Grand_Palladium_White_Sand_Resort_Spa-Xpu_Ha_Yucatan_Peninsula.html",
                features: ["Part of complex", "Baby club", "Good beach", "Zentropia spa"],
                notes: "Good value option between Playa del Carmen and Tulum",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "MID-RANGE VALUE! Good balance of price/quality. Baby club rare - great if traveling with infants. Part of 4-resort complex. Zentropia spa excellent. Beach is wide and nice. 80min from airport is moderate. Solid choice for families on budget.",
                crowdLevel: "Medium-High"
            },
            // More Costa Mujeres
            {
                id: 26,
                name: "Atelier Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2634,
                lng: -86.7945,
                airportDist: "35 min",
                priceMay24: 480,
                priceMay31: 540,
                rating: 4.7,
                reviews: 4500,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.atelierdehoteles.com/playa-mujeres/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d15071178-Reviews-Atelier_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Luxury", "Artistic design", "Rooftop pools"],
                notes: "Adults only luxury - good option for couple wanting premium experience",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Outstanding",
                insiderTip: "LUXURY ADULTS-ONLY! Art-focused design is stunning. Rooftop pools with views. High-end service. Great for Dann & husband or if grandparents want separate luxury stay. Costa Mujeres = quieter than Hotel Zone. Worth splurge for special occasions.",
                crowdLevel: "Low"
            },
            {
                id: 27,
                name: "Haven Riviera Cancun",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2512,
                lng: -86.8078,
                airportDist: "30 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 5800,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.havenresorts.com/haven-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d13398982-Reviews-Haven_Riviera_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Serenity suite upgrade", "Good spa"],
                notes: "Adults only - nice option for couples",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "GOOD VALUE ADULTS-ONLY! Serenity suite upgrade worth it for better room. Good spa. Less expensive than Atelier but still quality adults-only experience. Costa Mujeres location is peaceful. 30min from airport is reasonable.",
                crowdLevel: "Low-Medium"
            },
            // Additional family resorts
            {
                id: 28,
                name: "Ocean Riviera Paradise",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7234,
                lng: -86.9987,
                airportDist: "30 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.2,
                reviews: 8900,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.oceanhotels.net/en/hotels/ocean-riviera-paradise",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d10169936-Reviews-Ocean_Riviera_Paradise-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Privilege upgrade", "Near Playa"],
                notes: "Good budget option with Privilege upgrade available",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2017",
                serviceRating: "Mixed",
                insiderTip: "BUDGET OPTION! Cheapest in Riviera Maya at $280/night. Privilege upgrade essential for better experience. Near Playa del Carmen for shopping/nightlife. Service reviews mixed. Good if budget is tight but expect basics. 30min from airport.",
                crowdLevel: "High"
            },
            {
                id: 29,
                name: "Riu Palace Riviera Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7012,
                lng: -87.0145,
                airportDist: "35 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.5,
                reviews: 6700,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.riu.com/en/hotel/mexico/playa-del-carmen/hotel-riu-palace-riviera-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d152937-Reviews-Hotel_Riu_Palace_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["24hr all-inclusive", "Good beach", "RiuLand kids"],
                notes: "Solid Riu property with good kids program",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "SOLID FAMILY CHOICE! 24-hour all-inclusive = late night snacks available. RiuLand kids club well-reviewed. Good beach area. Reliable Riu brand quality. Not fancy but delivers consistent experience. 35min from airport is moderate.",
                crowdLevel: "Medium"
            },
            {
                id: 30,
                name: "The Royal Sands",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0912,
                lng: -86.7712,
                airportDist: "25 min",
                priceMay24: 300,
                priceMay31: 340,
                rating: 4.3,
                reviews: 5400,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.royalresorts.com/the-royal-sands",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d155678-Reviews-The_Royal_Sands-Cancun_Yucatan_Peninsula.html",
                features: ["Suite hotel", "Kitchen in rooms", "Good for families"],
                notes: "All suite property with kitchens - good for families",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2016",
                serviceRating: "Good",
                insiderTip: "KITCHEN SUITES! All rooms have kitchens = save money on snacks/breakfast. Good for families with picky eaters. Hotel Zone location is walkable to shops. Older property but well-maintained. 25min from airport. Good value for suite-style accommodations.",
                crowdLevel: "Medium"
            },
            {
                id: 31,
                name: "Le Blanc Spa Resort",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.1234,
                lng: -86.7523,
                airportDist: "28 min",
                priceMay24: 650,
                priceMay31: 720,
                rating: 4.8,
                reviews: 7800,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.leblancsparesort.com/cancun/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d601051-Reviews-Le_Blanc_Spa_Resort_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "AAA Five Diamond", "Premium luxury", "Butler service"],
                notes: "Most luxurious adults-only option - for couples wanting ultra-premium",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "World-Class",
                insiderTip: "ULTIMATE LUXURY! AAA Five Diamond = highest rating possible. Butler service is exceptional. Most expensive but truly delivers premium experience. Perfect for honeymoon or special anniversary. If grandparents or Dann & husband want to splurge, this is THE choice.",
                crowdLevel: "Low"
            },
            {
                id: 32,
                name: "Secrets The Vine Cancun",
                area: "cancun",
                areaName: "Cancun Hotel Zone",
                lat: 21.0845,
                lng: -86.7756,
                airportDist: "22 min",
                priceMay24: 420,
                priceMay31: 480,
                rating: 4.6,
                reviews: 11200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/the-vine-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d2312009-Reviews-Secrets_The_Vine_Cancun-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Marriott Bonvoy", "Wine theme", "Unlimited luxury"],
                notes: "Adults only, Marriott points - wine-themed luxury",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "POINTS + LUXURY! Marriott Bonvoy works here. Wine theme = excellent wine selection included. Unlimited luxury concept. Great for wine-loving couples. Hotel Zone location = close to everything. Solid choice for adults wanting Marriott points + quality.",
                crowdLevel: "Medium"
            },
            // More Tulum
            {
                id: 33,
                name: "Secrets Tulum Resort",
                area: "tulum",
                areaName: "Tulum",
                lat: 20.2289,
                lng: -87.4534,
                airportDist: "95 min",
                priceMay24: 400,
                priceMay31: 450,
                rating: 4.5,
                reviews: 1200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.secretsresorts.com/tulum",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d25113654-Reviews-Secrets_Tulum_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Adults only", "Marriott Bonvoy", "Newer 2024", "Near ruins"],
                notes: "New 2024 adults-only Secrets in Tulum",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2024 (NEW)",
                serviceRating: "Very Good",
                insiderTip: "BRAND NEW 2024! Newest Secrets resort. Marriott Bonvoy compatible. Near Tulum ruins. Adults-only luxury in authentic Tulum setting. Still working out kinks as new property. 95min from airport is long but worth it for newest Secrets experience.",
                crowdLevel: "Low"
            },
            // Additional resorts
            {
                id: 34,
                name: "Sandos Caracol Eco Resort",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.6712,
                lng: -87.0456,
                airportDist: "45 min",
                priceMay24: 280,
                priceMay31: 320,
                rating: 4.2,
                reviews: 14500,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.sandos.com/hotels/riviera-maya/sandos-caracol-eco-resort/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d219619-Reviews-Sandos_Caracol_Eco_Resort-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Eco-resort", "Cenote on property", "Budget friendly", "Nature focus"],
                notes: "Eco-focused budget option with cenote on-site",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "ECO BUDGET PICK! Cenote on property = unique experience. Nature focus great for educational family trips. Budget-friendly at $280/night. Not luxury but delivers authentic eco-experience. 45min from airport. Good for nature-loving families on budget.",
                crowdLevel: "High"
            },
            {
                id: 35,
                name: "Xcaret Arte",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.5789,
                lng: -87.1212,
                airportDist: "55 min",
                priceMay24: 580,
                priceMay31: 650,
                rating: 4.8,
                reviews: 3200,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.hotelxcaretarte.com/en/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d21018987-Reviews-Hotel_Xcaret_Arte-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Art focused", "All Xcaret parks", "Premium luxury"],
                notes: "Adults only sister to Hotel Xcaret - all parks included, art theme",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "Outstanding",
                insiderTip: "ADULTS XCARET! All Xcaret parks included + art workshops. Unique artist residency program. Premium adults-only luxury. Great for creative couples. If parents/grandparents want parks + sophistication, this is perfect. 55min from airport.",
                crowdLevel: "Low"
            },
            {
                id: 36,
                name: "Breathless Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7612,
                lng: -86.9812,
                airportDist: "25 min",
                priceMay24: 360,
                priceMay31: 400,
                rating: 4.4,
                reviews: 7800,
                family: false,
                accessible: true,
                luxury: false,
                adultsOnly: true,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.breathlessresorts.com/riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d8545775-Reviews-Breathless_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Party vibe", "Marriott Bonvoy", "Xhale Club upgrade"],
                notes: "Adults only with party vibe - good for younger adults",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2019",
                serviceRating: "Good",
                insiderTip: "PARTY ATMOSPHERE! For younger adults who want energy. Marriott Bonvoy eligible. Xhale Club upgrade worth it for quieter area. May not suit grandparents. Good for college-age kids in your group who want nightlife. 25min from airport.",
                crowdLevel: "High"
            },
            {
                id: 37,
                name: "Now Sapphire Riviera Cancun",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7512,
                lng: -86.9912,
                airportDist: "25 min",
                priceMay24: 340,
                priceMay31: 380,
                rating: 4.3,
                reviews: 9200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: "marriott",
                pointsCost: "Marriott Bonvoy",
                website: "https://www.nowresorts.com/sapphire-riviera-cancun",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d500896-Reviews-Now_Sapphire_Riviera_Cancun-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Marriott Bonvoy", "Explorer's Club kids", "Spa", "Good beach"],
                notes: "Good family option with Marriott points",
                // INSIDER INTEL
                valueScore: 7,
                renovated: "2018",
                serviceRating: "Good",
                insiderTip: "SOLID FAMILY CHOICE! Marriott Bonvoy = points value. Explorer's Club keeps kids 3-12 happy. Good beach area. Reliable mid-range family option. 25min from airport is convenient. Not exciting but consistently delivers for families.",
                crowdLevel: "Medium"
            },
            {
                id: 38,
                name: "Valentin Imperial Maya",
                area: "riviera",
                areaName: "Riviera Maya",
                lat: 20.7134,
                lng: -87.0023,
                airportDist: "35 min",
                priceMay24: 380,
                priceMay31: 420,
                rating: 4.5,
                reviews: 8100,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.valentinhotelgroup.com/en/valentin-imperial-maya",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150812-d592582-Reviews-Valentin_Imperial_Riviera_Maya-Playa_del_Carmen_Yucatan_Peninsula.html",
                features: ["Adults only", "Premium rooms", "10 restaurants", "Good spa"],
                notes: "Adults only - solid luxury option for couples",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2019",
                serviceRating: "Very Good",
                insiderTip: "GREAT VALUE LUXURY! 10 restaurants = no dining boredom. Adults-only with quality service. Good spa. Less expensive than Le Blanc but still upscale. 35min from airport. Strong choice for couples wanting luxury without extreme prices.",
                crowdLevel: "Medium"
            },
            {
                id: 39,
                name: "Excellence Playa Mujeres",
                area: "costa",
                areaName: "Costa Mujeres",
                lat: 21.2689,
                lng: -86.7923,
                airportDist: "35 min",
                priceMay24: 450,
                priceMay31: 500,
                rating: 4.7,
                reviews: 14500,
                family: false,
                accessible: true,
                luxury: true,
                adultsOnly: true,
                points: null,
                pointsCost: null,
                website: "https://www.theexcellencecollection.com/excellence-playa-mujeres",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150807-d1936990-Reviews-Excellence_Playa_Mujeres-Cancun_Yucatan_Peninsula.html",
                features: ["Adults only", "Excellence Club upgrade", "All suites", "Private pools available"],
                notes: "Top-rated adults only - sister to Finest (family version)",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2020",
                serviceRating: "Excellent",
                insiderTip: "TOP ADULTS-ONLY PICK! Sister to Finest (your family option). Excellence Club upgrade worth it. All suites = spacious. Private pools available. Same quality as family version. Perfect if splitting group - adults here, families at Finest. 35min from airport.",
                crowdLevel: "Low"
            },
            {
                id: 40,
                name: "Grand Sirenis Riviera Maya",
                area: "tulum",
                areaName: "Near Tulum",
                lat: 20.2856,
                lng: -87.4123,
                airportDist: "85 min",
                priceMay24: 240,
                priceMay31: 280,
                rating: 4.1,
                reviews: 10200,
                family: true,
                accessible: true,
                luxury: false,
                adultsOnly: false,
                points: null,
                pointsCost: null,
                website: "https://www.sirenishotels.com/en/hotels/riviera-maya/grand-sirenis-riviera-maya/",
                tripadvisor: "https://www.tripadvisor.com/Hotel_Review-g150813-d625506-Reviews-Grand_Sirenis_Riviera_Maya_Resort_Spa-Tulum_Yucatan_Peninsula.html",
                features: ["Budget friendly", "Cenote on site", "Large property"],
                notes: "Budget option near Tulum with cenote",
                // INSIDER INTEL
                valueScore: 6,
                renovated: "2016",
                serviceRating: "Mixed",
                insiderTip: "CHEAPEST OPTION! At $240/night, this is budget king. Cenote on-site is unique. Large property = lots of walking. Service inconsistent per reviews. 85min from airport. Good if you want Tulum area on tight budget but temper expectations.",
                crowdLevel: "High"
            },

            // LUXURY VILLA RENTALS - Great for large groups
            {
                id: 41,
                name: "Hacienda Magica (Villa)",
                area: "riviera",
                areaName: "Puerto Aventuras",
                lat: 20.4983,
                lng: -87.2350,
                airportDist: "45 min",
                priceMay24: 2860,
                priceMay31: 3200,
                rating: 5.0,
                reviews: 89,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 14,
                sleeps: 36,
                points: null,
                pointsCost: null,
                website: "https://hauteretreats.com/luxury-rentals/hacienda-magica-14-br/",
                tripadvisor: "https://www.tripadvisor.com/VacationRentalReview-g153510-d2350771-Hacienda_Magica-Puerto_Aventuras.html",
                features: ["14 bedrooms", "Beachfront", "Full staff", "Private chef", "Tennis court", "Pool"],
                notes: "VILLA: Palatial beachfront villa with full staff, chef, and butler. Price is for entire villa/night. Perfect for our group of 14!",
                // INSIDER INTEL
                valueScore: 10,
                renovated: "2020",
                serviceRating: "Outstanding",
                insiderTip: "ULTIMATE PRIVACY PICK! 14 bedrooms fits your ENTIRE group of 14 under one roof! Full staff handles everything. Private chef = custom menus for all ages. Beachfront. At $2860/night for entire villa = ~$204/person/night. INCREDIBLE value for private experience!",
                crowdLevel: "Private"
            },
            {
                id: 42,
                name: "Villa Esmeralda (Villa)",
                area: "riviera",
                areaName: "Playa del Carmen",
                lat: 20.6296,
                lng: -87.0739,
                airportDist: "55 min",
                priceMay24: 1800,
                priceMay31: 2100,
                rating: 4.9,
                reviews: 42,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 8,
                sleeps: 16,
                points: null,
                pointsCost: null,
                website: "https://www.mayaluxe.com/luxury-villas/",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150812-Reviews-Playa_del_Carmen_Yucatan_Peninsula-Villas.html",
                features: ["8 bedrooms", "Private pool", "Chef available", "Oceanfront", "Concierge"],
                notes: "VILLA: Luxury beachfront villa. Chef and concierge available. Price is per night for entire villa.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2019",
                serviceRating: "Excellent",
                insiderTip: "GREAT VILLA VALUE! 8 bedrooms at $1800/night = ~$138/person/night. Private pool + oceanfront. Chef available. Near Playa del Carmen = restaurants/shopping. Could work for your 13 people with room to spare.",
                crowdLevel: "Private"
            },
            {
                id: 43,
                name: "Hacienda del Mar (Villa)",
                area: "cancun",
                areaName: "Puerto Cancun",
                lat: 21.1456,
                lng: -86.8123,
                airportDist: "25 min",
                priceMay24: 2200,
                priceMay31: 2500,
                rating: 4.8,
                reviews: 56,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 7,
                sleeps: 14,
                points: null,
                pointsCost: null,
                website: "https://www.rentalescapes.com/rentals/luxury-vacation-rentals-mexico/riviera-maya/cancun",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150807-Reviews-Cancun_Yucatan_Peninsula-Villas.html",
                features: ["7 bedrooms", "Private beach", "Full staff", "Golf nearby", "Marina access"],
                notes: "VILLA: Perfect for our 13 people - 7 rooms for flexibility. Full staff included. Gated community with marina.",
                // INSIDER INTEL
                valueScore: 9,
                renovated: "2021",
                serviceRating: "Excellent",
                insiderTip: "PERFECT FIT! 7 bedrooms = exactly 7 rooms your group needs. Full staff included. Gated Puerto Cancun community is safe and upscale. Marina access for boat trips. Golf nearby. 25min from airport. At $2200/night = ~$157/person. Great for group wanting resort feel with privacy.",
                crowdLevel: "Private"
            },
            {
                id: 44,
                name: "Villa Quinta Clara (Villa)",
                area: "riviera",
                areaName: "Akumal",
                lat: 20.3961,
                lng: -87.3120,
                airportDist: "70 min",
                priceMay24: 1650,
                priceMay31: 1900,
                rating: 4.9,
                reviews: 34,
                family: true,
                accessible: true,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 8,
                sleeps: 18,
                points: null,
                pointsCost: null,
                website: "https://isleblue.co/mayan-riviera/villas",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g499445-Reviews-Akumal_Yucatan_Peninsula-Villas.html",
                features: ["8 bedrooms", "Sea turtle beach", "Snorkeling", "Cook included", "Pool"],
                notes: "VILLA: Located in Akumal - famous for sea turtles! Cook and housekeeper included. Great for kids.",
                // INSIDER INTEL
                valueScore: 10,
                renovated: "2018",
                serviceRating: "Excellent",
                insiderTip: "BEST FOR KIDS! Akumal = sea turtle snorkeling RIGHT ON BEACH! Kids will love it. Cook + housekeeper included. 8 bedrooms sleeps 18 = fits your 14 with room to spare. At $1650/night = ~$118/person = INCREDIBLE value! Magical for multigenerational memories.",
                crowdLevel: "Private"
            },
            {
                id: 45,
                name: "Casa de los Suenos (Villa)",
                area: "tulum",
                areaName: "Tulum Beach",
                lat: 20.2145,
                lng: -87.4298,
                airportDist: "90 min",
                priceMay24: 2400,
                priceMay31: 2800,
                rating: 4.8,
                reviews: 28,
                family: true,
                accessible: false,
                luxury: true,
                adultsOnly: false,
                isVilla: true,
                bedrooms: 9,
                sleeps: 20,
                points: null,
                pointsCost: null,
                website: "https://www.mayaluxe.com/luxury-villas/?filter_region=tulum",
                tripadvisor: "https://www.tripadvisor.com/VacationRentals-g150813-Reviews-Tulum_Yucatan_Peninsula-Villas.html",
                features: ["9 bedrooms", "Beachfront Tulum", "Cenote nearby", "Chef available", "Bohemian luxury"],
                notes: "VILLA: Stunning Tulum beachfront. Note: Tulum beach is less accessible (stairs to beach). Great for those wanting authentic Tulum vibe.",
                // INSIDER INTEL
                valueScore: 8,
                renovated: "2020",
                serviceRating: "Very Good",
                insiderTip: "TULUM BOHEMIAN LUXURY! 9 bedrooms on Tulum beach = Instagram-worthy. Cenote nearby for swimming. Chef available. CAUTION: Tulum beach has stairs = NOT ideal for mobility-challenged grandparents. 90min from airport. Perfect if everyone mobile and wants authentic Tulum.",
                crowdLevel: "Private"
            }
        ];

        // Family members for voting
        const familyMembers = [
            "Alex", "Andrew", "Cindy", "Tom", "Julie",
            "Dann", "Dann's Husband", "Beckett 1", "Beckett 2"
        ];

        // Initialize map
        let map;
        let markers = [];
        let selectedResort = null;

        function initMap() {
            map = L.map('map').setView([20.8, -87.1], 9);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
                maxZoom: 19
            }).addTo(map);

            // Add airport marker
            const airportIcon = L.divIcon({
                className: 'custom-marker',
                html: '<div style="background:#1e40af;color:white;padding:6px 10px;border-radius:6px;font-weight:bold;font-size:11px;white-space:nowrap;">CUN Airport</div>',
                iconSize: [80, 30]
            });
            L.marker([21.0365, -86.8770], {icon: airportIcon}).addTo(map);

            renderMarkers();
        }

        function getMarkerColor(resort) {
            if (resort.isVilla) return '#8b5cf6';
            if (resort.accessible) return '#f97316';
            if (resort.points) return '#0891b2';
            if (resort.luxury) return '#f59e0b';
            if (resort.adultsOnly) return '#ef4444';
            if (resort.family) return '#10b981';
            return '#64748b';
        }

        function renderMarkers() {
            // Clear existing markers
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            const filtered = getFilteredResorts();

            filtered.forEach(resort => {
                const color = getMarkerColor(resort);
                const icon = L.divIcon({
                    className: 'custom-marker',
                    html: `<div style="width:20px;height:20px;background:${color};border-radius:50%;border:3px solid white;box-shadow:0 2px 6px rgba(0,0,0,0.3);"></div>`,
                    iconSize: [20, 20],
                    iconAnchor: [10, 10]
                });

                const marker = L.marker([resort.lat, resort.lng], {icon}).addTo(map);
                marker.on('click', () => showResortInfo(resort));
                markers.push(marker);
            });

            document.getElementById('filteredCount').textContent = filtered.length;
            renderResortList(filtered);
        }

        function getFilteredResorts() {
            const areaFilter = document.querySelector('.chip[data-filter="area"].active')?.dataset.value || 'all';
            const priceFilter = document.querySelector('.chip[data-filter="price"].active')?.dataset.value || 'all';
            const featureFilters = Array.from(document.querySelectorAll('.chip[data-filter="feature"].active')).map(c => c.dataset.value);

            return resorts.filter(r => {
                if (areaFilter !== 'all' && r.area !== areaFilter) return false;

                if (priceFilter === 'budget' && r.priceMay24 >= 300) return false;
                if (priceFilter === 'mid' && (r.priceMay24 < 300 || r.priceMay24 >= 500)) return false;
                if (priceFilter === 'luxury' && r.priceMay24 < 500) return false;

                if (featureFilters.includes('family') && !r.family) return false;
                if (featureFilters.includes('accessible') && !r.accessible) return false;
                if (featureFilters.includes('points') && !r.points) return false;
                if (featureFilters.includes('luxury') && !r.luxury) return false;
                if (featureFilters.includes('villa') && !r.isVilla) return false;

                return true;
            });
        }

        function renderResortList(filtered) {
            const list = document.getElementById('resortList');
            list.innerHTML = filtered.map(r => {
                const dealBadge = getDealBadge(r);
                const dealBadgeHTML = dealBadge ? `<span class="deal-badge ${dealBadge.class}" style="font-size:0.6rem;padding:2px 6px;">${dealBadge.icon} ${dealBadge.text}</span>` : '';

                return `
                <div class="resort-card ${selectedResort?.id === r.id ? 'selected' : ''}" onclick="showResortInfo(resorts.find(x => x.id === ${r.id}))">
                    <div class="resort-header">
                        <span class="resort-name">${r.name}</span>
                        <span class="resort-rating">${r.valueScore ? '<span style="background:' + (r.valueScore >= 8 ? '#059669' : r.valueScore >= 6 ? '#d97706' : '#dc2626') + ';color:white;padding:2px 6px;border-radius:4px;font-size:0.7rem;margin-right:6px;">' + r.valueScore + '/10</span>' : ''}â˜… ${r.rating}</span>
                    </div>
                    ${dealBadgeHTML ? `<div style="margin-bottom:6px;">${dealBadgeHTML}</div>` : ''}
                    <div class="resort-location">${r.areaName} â€¢ ${r.airportDist} from CUN</div>
                    <div class="resort-tags">
                        ${r.isVilla ? '<span class="tag tag-villa">VILLA ' + r.bedrooms + 'BR</span>' : ''}
                        ${r.family ? '<span class="tag tag-family">Family</span>' : ''}
                        ${r.adultsOnly ? '<span class="tag tag-adults">Adults Only</span>' : ''}
                        ${r.luxury ? '<span class="tag tag-luxury">Luxury</span>' : ''}
                        ${r.points ? '<span class="tag tag-points">' + r.points.toUpperCase() + '</span>' : ''}
                        ${r.accessible ? '<span class="tag tag-accessible">Accessible</span>' : ''}
                    </div>
                    <div class="resort-price">
                        <div>
                            <span class="price-value">$${r.priceMay24}</span>
                            <span class="price-label">/night May 24-31</span>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function showResortInfo(resort) {
            selectedResort = resort;
            const panel = document.getElementById('infoPanel');
            document.getElementById('panelTitle').textContent = resort.name;
            document.getElementById('panelSubtitle').textContent = `${resort.areaName} â€¢ ${resort.airportDist} from airport`;

            // Villas: price is for entire villa; Resorts: price per room
            const isVilla = resort.isVilla;
            const total7May = isVilla ? resort.priceMay24 * 7 : resort.priceMay24 * 7 * 7;
            const total7Jun = isVilla ? resort.priceMay31 * 7 : resort.priceMay31 * 7 * 7;
            const priceLabel = isVilla ? '/night (entire villa)' : '/night per room';
            const totalLabel = isVilla ? 'Est. Total (7 nights entire villa)' : 'Est. Total (7 rooms Ã— 7 nights)';

            // Get deal info
            const dealBadge = getDealBadge(resort);
            const trendHTML = getTrendIndicator(resort);

            document.getElementById('panelBody').innerHTML = `
                ${dealBadge ? `
                <div style="display:flex;align-items:center;gap:10px;margin-bottom:15px;flex-wrap:wrap;">
                    <span class="deal-badge ${dealBadge.class}">${dealBadge.icon} ${dealBadge.text}</span>
                    ${trendHTML}
                </div>
                ` : (trendHTML ? `<div style="margin-bottom:15px;">${trendHTML}</div>` : '')}

                ${isVilla ? `
                <div class="info-section" style="background: linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%); color: white; padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                    <div style="font-size: 1.1rem; font-weight: 700; margin-bottom: 8px;">Private Villa Rental</div>
                    <div style="display: flex; gap: 20px;">
                        <div><span style="opacity: 0.8;">Bedrooms:</span> <strong>${resort.bedrooms}</strong></div>
                        <div><span style="opacity: 0.8;">Sleeps:</span> <strong>${resort.sleeps}</strong></div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.85rem; opacity: 0.9;">Full staff, chef, and concierge typically included</div>
                </div>
                ` : ''}

                <div class="info-section">
                    <div class="info-section-title">Price Calculator</div>
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-bottom:15px;">
                        <div>
                            <label style="font-size:0.75rem;color:#64748b;display:block;margin-bottom:4px;">Start Date</label>
                            <select id="priceStartDate" onchange="updatePriceCalc()" style="width:100%;padding:8px;border:2px solid #e2e8f0;border-radius:8px;font-size:0.85rem;font-weight:500;">
                                <option value="may24" selected>May 24, 2025</option>
                                <option value="may31">May 31, 2025</option>
                            </select>
                        </div>
                        <div>
                            <label style="font-size:0.75rem;color:#64748b;display:block;margin-bottom:4px;">Duration</label>
                            <select id="priceDuration" onchange="updatePriceCalc()" style="width:100%;padding:8px;border:2px solid #e2e8f0;border-radius:8px;font-size:0.85rem;font-weight:500;">
                                <option value="4">4 nights</option>
                                <option value="5">5 nights</option>
                                <option value="6">6 nights</option>
                                <option value="7" selected>7 nights</option>
                            </select>
                        </div>
                    </div>
                    <div id="priceCalcResult" style="background:linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);padding:15px;border-radius:12px;border:2px solid #10b981;">
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                            <div style="text-align:center;">
                                <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">Per Room/Night</div>
                                <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${resort.priceMay24.toLocaleString()}</div>
                            </div>
                            <div style="text-align:center;">
                                <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">${isVilla ? 'Total (Villa)' : '7 Rooms Total'}</div>
                                <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${(isVilla ? resort.priceMay24 * 7 : resort.priceMay24 * 7 * 7).toLocaleString()}</div>
                            </div>
                        </div>
                        <div style="margin-top:12px;padding-top:12px;border-top:1px solid #a7f3d0;text-align:center;">
                            <div style="font-size:0.75rem;color:#166534;" id="priceCalcDates">May 24 - May 31, 2025 (7 nights)</div>
                        </div>
                    </div>
                    <div style="margin-top:10px;font-size:0.75rem;color:#64748b;text-align:center;">
                        ${isVilla ? 'Prices are for entire villa per night' : 'All-inclusive per room/night â€¢ 7 rooms needed for group of 14'}
                    </div>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Details</div>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-item-label">Rating</div>
                            <div class="info-item-value">â˜… ${resort.rating} (${resort.reviews.toLocaleString()})</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Type</div>
                            <div class="info-item-value">${resort.adultsOnly ? 'Adults Only' : 'Family'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Accessible</div>
                            <div class="info-item-value">${resort.accessible ? 'âœ“ Yes' : 'âœ— No'}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Points</div>
                            <div class="info-item-value">${resort.points ? resort.points.toUpperCase() : 'N/A'}</div>
                        </div>
                    </div>
                </div>

                ${resort.points ? `
                <div class="info-section">
                    <div class="info-section-title">Points Redemption</div>
                    <div style="padding:12px;background:#e0e7ff;border-radius:8px;">
                        <div style="font-weight:600;color:#4f46e5;">${resort.pointsCost}</div>
                        <div style="font-size:0.8rem;color:#666;margin-top:4px;">Points cover full all-inclusive package</div>
                    </div>
                </div>
                ` : ''}

                ${resort.insiderTip ? `
                <div class="info-section" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); padding: 15px; border-radius: 12px; border-left: 4px solid #f59e0b;">
                    <div class="info-section-title" style="color: #92400e; display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 1.2rem;">ðŸ”</span> Insider Intel
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 12px;">
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 1.3rem; font-weight: 700; color: ${resort.valueScore >= 8 ? '#059669' : resort.valueScore >= 6 ? '#d97706' : '#dc2626'};">${resort.valueScore}/10</div>
                            <div style="font-size: 0.7rem; color: #666;">VALUE SCORE</div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">${resort.serviceRating || 'N/A'}</div>
                            <div style="font-size: 0.7rem; color: #666;">SERVICE</div>
                        </div>
                        <div style="text-align: center; padding: 8px; background: rgba(255,255,255,0.7); border-radius: 8px;">
                            <div style="font-size: 0.85rem; font-weight: 600; color: #1e293b;">${resort.crowdLevel || 'N/A'}</div>
                            <div style="font-size: 0.7rem; color: #666;">CROWDS</div>
                        </div>
                    </div>
                    <div style="font-size: 0.8rem; color: #78350f; margin-bottom: 8px;"><strong>Renovated:</strong> ${resort.renovated || 'Unknown'}</div>
                    <p style="font-size: 0.85rem; color: #78350f; line-height: 1.5; margin: 0;">${resort.insiderTip}</p>
                </div>
                ` : ''}

                ${getHiddenCostsHTML(resort)}

                ${getSavingsHTML(resort)}

                <div class="info-section">
                    <div class="info-section-title">Features</div>
                    <ul style="list-style:none;display:flex;flex-wrap:wrap;gap:6px;">
                        ${resort.features.map(f => `<li style="background:#f1f5f9;padding:4px 10px;border-radius:4px;font-size:0.8rem;">${f}</li>`).join('')}
                    </ul>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Notes</div>
                    <p style="font-size:0.9rem;color:#666;line-height:1.6;">${resort.notes}</p>
                </div>

                <div class="info-section">
                    <div class="info-section-title">Links & Booking</div>
                    <div class="link-list">
                        <a href="${resort.website}" target="_blank" class="link-item">
                            <span class="link-icon website">ðŸŒ</span>
                            Official Website
                        </a>
                        <a href="${resort.tripadvisor}" target="_blank" class="link-item">
                            <span class="link-icon reviews">â˜…</span>
                            TripAdvisor Reviews
                        </a>
                        <a href="https://www.google.com/maps/search/${encodeURIComponent(resort.name + ' ' + resort.areaName + ' Mexico')}" target="_blank" class="link-item">
                            <span class="link-icon" style="background:#dcfce7;color:#166534;">ðŸ“</span>
                            Google Maps & Reviews
                        </a>
                        ${resort.points === 'hyatt' ? `
                        <a href="https://world.hyatt.com/content/gp/en/rewards/free-nights-upgrades.html" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            World of Hyatt Rewards
                        </a>
                        ` : ''}
                        ${resort.points === 'marriott' ? `
                        <a href="https://all-inclusive.marriott.com/" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            Marriott All-Inclusive
                        </a>
                        ` : ''}
                        ${resort.points === 'hilton' ? `
                        <a href="https://www.hilton.com/en/hilton-honors/" target="_blank" class="link-item">
                            <span class="link-icon points">ðŸŽ¯</span>
                            Hilton Honors
                        </a>
                        ` : ''}
                    </div>
                    <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                        <div style="font-size: 0.7rem; color: #64748b; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px;">Compare Prices (May 24-31, 2025)</div>
                        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;">
                            <a href="https://www.expedia.com/Hotel-Search?destination=${encodeURIComponent(resort.name + ', Cancun, Mexico')}&startDate=2025-05-24&endDate=2025-05-31&rooms=1&adults=2" target="_blank" style="text-decoration:none;padding:10px 8px;background:#fef3c7;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#fde68a'" onmouseout="this.style.background='#fef3c7'">
                                <div style="font-size:0.7rem;color:#92400e;font-weight:600;">Expedia</div>
                            </a>
                            <a href="https://www.booking.com/searchresults.html?ss=${encodeURIComponent(resort.name + ' Cancun')}&checkin=2025-05-24&checkout=2025-05-31&group_adults=2&no_rooms=1" target="_blank" style="text-decoration:none;padding:10px 8px;background:#dbeafe;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#bfdbfe'" onmouseout="this.style.background='#dbeafe'">
                                <div style="font-size:0.7rem;color:#1e40af;font-weight:600;">Booking.com</div>
                            </a>
                            <a href="https://www.hotels.com/search.do?destination=${encodeURIComponent(resort.name + ' Cancun Mexico')}&startDate=2025-05-24&endDate=2025-05-31&rooms=1&adults=2" target="_blank" style="text-decoration:none;padding:10px 8px;background:#fee2e2;border-radius:8px;text-align:center;transition:all 0.2s;" onmouseover="this.style.background='#fecaca'" onmouseout="this.style.background='#fee2e2'">
                                <div style="font-size:0.7rem;color:#991b1b;font-weight:600;">Hotels.com</div>
                            </a>
                        </div>
                    </div>
                </div>
            `;

            panel.classList.add('active');
            renderResortList(getFilteredResorts());

            // Pan map to resort
            map.panTo([resort.lat, resort.lng]);
        }

        function closeInfoPanel() {
            document.getElementById('infoPanel').classList.remove('active');
            selectedResort = null;
            renderResortList(getFilteredResorts());
        }

        function updatePriceCalc() {
            if (!selectedResort) return;
            const startDate = document.getElementById('priceStartDate').value;
            const nights = parseInt(document.getElementById('priceDuration').value);

            const basePrice = startDate === 'may24' ? selectedResort.priceMay24 : selectedResort.priceMay31;
            const isVilla = selectedResort.isVilla;

            // Calculate totals
            const perNight = basePrice;
            const totalGroup = isVilla ? basePrice * nights : basePrice * 7 * nights; // 7 rooms for group

            // Calculate date range
            const startDates = {
                'may24': { start: 'May 24', month: 5, day: 24 },
                'may31': { start: 'May 31', month: 5, day: 31 }
            };
            const sd = startDates[startDate];
            let endDay = sd.day + nights;
            let endMonth = 'May';
            if (endDay > 31) {
                endDay = endDay - 31;
                endMonth = 'Jun';
            }
            const dateRange = `${sd.start} - ${endMonth} ${endDay}, 2025 (${nights} nights)`;

            // Update the display
            document.getElementById('priceCalcResult').innerHTML = `
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:15px;">
                    <div style="text-align:center;">
                        <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">Per Room/Night</div>
                        <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${perNight.toLocaleString()}</div>
                    </div>
                    <div style="text-align:center;">
                        <div style="font-size:0.7rem;color:#666;text-transform:uppercase;">${isVilla ? 'Total (Villa)' : '7 Rooms Total'}</div>
                        <div style="font-size:1.3rem;font-weight:700;color:#059669;">$${totalGroup.toLocaleString()}</div>
                    </div>
                </div>
                <div style="margin-top:12px;padding-top:12px;border-top:1px solid #a7f3d0;text-align:center;">
                    <div style="font-size:0.75rem;color:#166534;">${dateRange}</div>
                </div>
            `;
        }

        // Filter handling
        document.querySelectorAll('.chip[data-filter="area"]').forEach(chip => {
            chip.addEventListener('click', () => {
                document.querySelectorAll('.chip[data-filter="area"]').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                renderMarkers();
            });
        });

        document.querySelectorAll('.chip[data-filter="price"]').forEach(chip => {
            chip.addEventListener('click', () => {
                document.querySelectorAll('.chip[data-filter="price"]').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                renderMarkers();
            });
        });

        document.querySelectorAll('.chip[data-filter="feature"]').forEach(chip => {
            chip.addEventListener('click', () => {
                chip.classList.toggle('active');
                renderMarkers();
            });
        });

        // Tab navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(`view-${tab.dataset.view}`).classList.add('active');

                if (tab.dataset.view === 'map' && map) {
                    setTimeout(() => map.invalidateSize(), 100);
                }
            });
        });

        // Matrix rendering
        function renderMatrix() {
            const tbody = document.getElementById('matrixBody');
            const familyResorts = resorts.filter(r => r.family).sort((a, b) => {
                // Sort villas at the end, otherwise by price
                if (a.isVilla && !b.isVilla) return 1;
                if (!a.isVilla && b.isVilla) return -1;
                return a.priceMay24 - b.priceMay24;
            });

            tbody.innerHTML = familyResorts.map(r => {
                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const priceNote = isVilla ? ' (villa)' : '';
                const rowStyle = isVilla ? 'background: #f5f3ff;' : '';
                return `
                <tr style="${rowStyle}">
                    <td><strong>${r.name}</strong>${isVilla ? '<br><span style="color:#8b5cf6;font-size:0.75rem;">PRIVATE VILLA â€¢ ' + r.bedrooms + ' BR</span>' : ''}</td>
                    <td>${r.areaName}</td>
                    <td><span class="airport-badge">${r.airportDist}</span></td>
                    <td><strong>$${r.priceMay24.toLocaleString()}</strong>/night${priceNote}</td>
                    <td>$${r.priceMay31.toLocaleString()}/night${priceNote}</td>
                    <td style="color:#059669;font-weight:700;">$${total7.toLocaleString()}</td>
                    <td class="check-yes">âœ“</td>
                    <td class="${r.accessible ? 'check-yes' : 'check-no'}">${r.accessible ? 'âœ“' : 'â€”'}</td>
                    <td>${r.points ? `<span style="color:#4f46e5;font-weight:600;">${r.points.toUpperCase()}</span>` : 'â€”'}</td>
                    <td>â˜… ${r.rating}</td>
                    <td>
                        <a href="${r.website}" target="_blank" style="margin-right:8px;">Website</a>
                        <a href="${r.tripadvisor}" target="_blank">Reviews</a>
                    </td>
                </tr>
            `}).join('');
        }

        // Voting System with Cloud Sync
        const VOTE_KEY = 'cancunVacationVotes2025';
        const ROOM_CODE = 'STINARD2025'; // Unique room code for your family
        const SYNC_INTERVAL = 5000; // Sync every 5 seconds
        let currentVoter = null;
        let cachedVotes = {};
        let syncEnabled = true;
        let lastSyncTime = 0;

        // Cloud sync using ntfy.sh for real-time updates + localStorage
        // This provides free, instant cross-device sync
        const SYNC_TOPIC = `cancun-votes-${ROOM_CODE.toLowerCase()}`;
        let eventSource = null;

        // Initialize real-time sync
        function initSync() {
            // Listen for real-time updates via Server-Sent Events
            try {
                eventSource = new EventSource(`https://ntfy.sh/${SYNC_TOPIC}/sse`);
                eventSource.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        if (data.message && data.message.startsWith('{')) {
                            const votes = JSON.parse(data.message);
                            if (votes._timestamp > lastSyncTime) {
                                cachedVotes = votes;
                                lastSyncTime = votes._timestamp || Date.now();
                                localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
                                // Update UI
                                renderVotingOptions();
                                updateVotingResults();
                                showSyncNotification('Votes updated!');
                            }
                        }
                    } catch (e) {}
                };
                eventSource.onerror = () => {
                    console.log('Sync connection lost, will retry...');
                };
                console.log('Real-time vote sync enabled!');
            } catch (e) {
                console.log('Real-time sync not available');
            }
        }

        // Show sync notification
        function showSyncNotification(message) {
            const existing = document.querySelector('.sync-notification');
            if (existing) existing.remove();

            const notif = document.createElement('div');
            notif.className = 'sync-notification';
            notif.innerHTML = `<span style="margin-right:8px;">ðŸ”„</span>${message}`;
            notif.style.cssText = `
                position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
                background: #10b981; color: white; padding: 12px 24px; border-radius: 30px;
                font-weight: 600; font-size: 0.9rem; z-index: 9999; box-shadow: 0 4px 20px rgba(0,0,0,0.2);
                animation: slideUp 0.3s ease;
            `;
            document.body.appendChild(notif);
            setTimeout(() => notif.remove(), 2000);
        }

        function getVotes() {
            if (Object.keys(cachedVotes).length > 0) {
                return { ...cachedVotes };
            }
            const stored = JSON.parse(localStorage.getItem(VOTE_KEY) || '{}');
            cachedVotes = stored;
            return stored;
        }

        function saveVotes(votes) {
            votes._timestamp = Date.now();
            lastSyncTime = votes._timestamp;

            // Save locally
            localStorage.setItem(VOTE_KEY, JSON.stringify(votes));
            cachedVotes = votes;

            // Broadcast to other devices
            if (syncEnabled) {
                fetch(`https://ntfy.sh/${SYNC_TOPIC}`, {
                    method: 'POST',
                    body: JSON.stringify(votes)
                }).catch(() => {});
            }
        }

        // Function to clear all votes
        function clearAllVotes() {
            if (confirm('Are you sure you want to clear ALL votes? This cannot be undone.')) {
                cachedVotes = { _timestamp: Date.now() };
                localStorage.setItem(VOTE_KEY, JSON.stringify(cachedVotes));
                lastSyncTime = cachedVotes._timestamp;

                // Broadcast clear to other devices
                fetch(`https://ntfy.sh/${SYNC_TOPIC}`, {
                    method: 'POST',
                    body: JSON.stringify(cachedVotes)
                }).catch(() => {});

                renderVotingOptions();
                updateVotingResults();
                showSyncNotification('All votes cleared');
            }
        }

        // Initialize sync when page loads
        if (typeof EventSource !== 'undefined') {
            initSync();
        }

        function renderVoterSelect() {
            const container = document.getElementById('voterSelect');
            container.innerHTML = familyMembers.map(m =>
                `<button class="voter-btn ${currentVoter === m ? 'active' : ''}" onclick="selectVoter('${m}')">${m}</button>`
            ).join('');
        }

        function selectVoter(name) {
            currentVoter = name;
            renderVoterSelect();
            renderVotingOptions();
            updateVotingResults();
        }

        function renderVotingOptions() {
            const container = document.getElementById('resortVoteOptions');
            const votes = getVotes();
            const topResorts = resorts.filter(r => r.family).slice(0, 10);

            container.innerHTML = topResorts.map(r => {
                const resortVotes = Object.entries(votes).filter(([_, v]) => v.resort === r.name);
                const isSelected = currentVoter && votes[currentVoter]?.resort === r.name;

                return `
                <div class="vote-option ${isSelected ? 'selected' : ''}" data-category="resort" data-value="${r.name}" onclick="castVote('resort', '${r.name}')">
                    <div class="vote-option-name">${r.name}</div>
                    <div class="vote-option-detail">${r.areaName} â€¢ $${r.priceMay24}/night</div>
                    <div class="vote-count-display">${resortVotes.length} vote${resortVotes.length !== 1 ? 's' : ''}</div>
                    <div class="vote-avatars">
                        ${resortVotes.map(([name]) => `<span class="vote-avatar">${name.charAt(0)}</span>`).join('')}
                    </div>
                </div>
            `}).join('');

            // Update week and length options
            updateVoteOptionDisplay('week');
            updateVoteOptionDisplay('length');
        }

        function updateVoteOptionDisplay(category) {
            const votes = getVotes();
            document.querySelectorAll(`[data-category="${category}"]`).forEach(option => {
                const value = option.dataset.value;
                const optionVotes = Object.entries(votes).filter(([_, v]) => v[category] === value);
                const isSelected = currentVoter && votes[currentVoter]?.[category] === value;

                option.classList.toggle('selected', isSelected);
                option.querySelector('.vote-count-display').textContent = `${optionVotes.length} vote${optionVotes.length !== 1 ? 's' : ''}`;
                option.querySelector('.vote-avatars').innerHTML = optionVotes.map(([name]) =>
                    `<span class="vote-avatar">${name.charAt(0)}</span>`
                ).join('');
            });
        }

        function castVote(category, value) {
            if (!currentVoter) {
                alert('Please select your name first!');
                return;
            }

            const votes = getVotes();
            if (!votes[currentVoter]) votes[currentVoter] = {};
            votes[currentVoter][category] = value;
            saveVotes(votes);

            renderVotingOptions();
            updateVotingResults();
        }

        // Add click handlers for week and length options
        document.querySelectorAll('[data-category="week"], [data-category="length"]').forEach(option => {
            option.addEventListener('click', () => {
                castVote(option.dataset.category, option.dataset.value);
            });
        });

        function updateVotingResults() {
            const votes = getVotes();
            const results = document.getElementById('votingResults');
            const totalVoters = Object.keys(votes).length;

            if (totalVoters === 0) {
                results.innerHTML = '<p>No votes yet. Select your name and start voting!</p>';
                return;
            }

            // Count votes
            const resortCounts = {};
            const weekCounts = {};
            const lengthCounts = {};

            Object.values(votes).forEach(v => {
                if (v.resort) resortCounts[v.resort] = (resortCounts[v.resort] || 0) + 1;
                if (v.week) weekCounts[v.week] = (weekCounts[v.week] || 0) + 1;
                if (v.length) lengthCounts[v.length] = (lengthCounts[v.length] || 0) + 1;
            });

            const topResort = Object.entries(resortCounts).sort((a, b) => b[1] - a[1])[0];
            const topWeek = Object.entries(weekCounts).sort((a, b) => b[1] - a[1])[0];
            const topLength = Object.entries(lengthCounts).sort((a, b) => b[1] - a[1])[0];

            results.innerHTML = `
                <div class="result-item">
                    <span class="result-label">Total Votes</span>
                    <span class="result-value">${totalVoters} family members</span>
                </div>
                ${topResort ? `
                <div class="result-item">
                    <span class="result-label">Leading Resort</span>
                    <span class="result-value">${topResort[0]} (${topResort[1]} votes)</span>
                </div>
                ` : ''}
                ${topWeek ? `
                <div class="result-item">
                    <span class="result-label">Leading Week</span>
                    <span class="result-value">${topWeek[0] === 'may24' ? 'May 24-31' : 'May 31 - Jun 7'} (${topWeek[1]} votes)</span>
                </div>
                ` : ''}
                ${topLength ? `
                <div class="result-item">
                    <span class="result-label">Trip Length</span>
                    <span class="result-value">${topLength[0]} nights (${topLength[1]} votes)</span>
                </div>
                ` : ''}
            `;
        }

        // ============================================
        // DEAL FINDER & BUDGET CALCULATOR
        // ============================================

        // Family Budget Target
        const BUDGET_TARGET = {
            min: 20000,
            max: 25000,
            sweet: 22500 // Middle of the range
        };

        // Price History Data (would be loaded from JSON in production)
        const priceHistory = {
            1: { trend: "down", percentChange: -9.5, lowestSeen: 380, avgPrice: 400, dealThreshold: 360 },
            2: { trend: "down", percentChange: -5.9, lowestSeen: 299, avgPrice: 335, dealThreshold: 300 },
            3: { trend: "down", percentChange: -7.9, lowestSeen: 320, avgPrice: 365, dealThreshold: 330 },
            4: { trend: "stable", percentChange: -4.0, lowestSeen: 450, avgPrice: 495, dealThreshold: 460 },
            11: { trend: "down", percentChange: -6.7, lowestSeen: 380, avgPrice: 435, dealThreshold: 400 },
            12: { trend: "down", percentChange: -5.2, lowestSeen: 520, avgPrice: 565, dealThreshold: 530 },
            16: { trend: "down", percentChange: -7.7, lowestSeen: 450, avgPrice: 500, dealThreshold: 460 },
            41: { trend: "down", percentChange: -4.7, lowestSeen: 2700, avgPrice: 2925, dealThreshold: 2750 },
            44: { trend: "down", percentChange: -5.7, lowestSeen: 1500, avgPrice: 1700, dealThreshold: 1550 }
        };

        // Hidden Costs Data
        const hiddenCosts = {
            1: { resortFee: 0, tips: 0, transfer: 85, extras: 25, freeTransfer: false },
            2: { resortFee: 0, tips: 0, transfer: 90, extras: 15, freeTransfer: false },
            3: { resortFee: 0, tips: 0, transfer: 0, extras: 40, freeTransfer: true, resortCredits: 1500 },
            4: { resortFee: 0, tips: 0, transfer: 95, extras: 20, freeTransfer: false },
            11: { resortFee: 0, tips: 0, transfer: 0, extras: 10, freeTransfer: true },
            12: { resortFee: 0, tips: 0, transfer: 0, extras: 15, freeTransfer: true },
            16: { resortFee: 0, tips: 0, transfer: 0, extras: 0, freeTransfer: true, parksIncluded: true, parksValue: 1200 },
            41: { resortFee: 0, tips: 350, transfer: 180, extras: 200, freeTransfer: false, isVilla: true },
            44: { resortFee: 0, tips: 200, transfer: 200, extras: 150, freeTransfer: false, isVilla: true }
        };

        // All-inclusive value data
        const allInclusiveValue = {
            1: { costPerMeal: 42, retailValue: 700, savingsVsRetail: 320, valueRating: "Good" },
            2: { costPerMeal: 36, retailValue: 680, savingsVsRetail: 360, valueRating: "Excellent" },
            4: { costPerMeal: 53, retailValue: 850, savingsVsRetail: 370, valueRating: "Good" },
            11: { costPerMeal: 47, retailValue: 900, savingsVsRetail: 480, valueRating: "Exceptional" },
            12: { costPerMeal: 61, retailValue: 1100, savingsVsRetail: 550, valueRating: "Premium" },
            16: { costPerMeal: 53, retailValue: 1500, savingsVsRetail: 1020, valueRating: "BEST VALUE" }
        };

        // Get deal badge for a resort
        function getDealBadge(resort) {
            const history = priceHistory[resort.id];
            if (!history) {
                // For resorts without history, use value score
                if (resort.valueScore >= 9) return { class: 'good-value', text: 'Good Value', icon: 'ðŸ’š' };
                if (resort.valueScore >= 7) return { class: 'premium', text: 'Fair Price', icon: 'âš–ï¸' };
                return null;
            }

            const currentPrice = resort.priceMay24;

            // Hot deal: at or below deal threshold
            if (currentPrice <= history.dealThreshold) {
                return { class: 'hot-deal', text: 'Hot Deal!', icon: 'ðŸ”¥' };
            }

            // Price drop: trending down significantly
            if (history.trend === 'down' && history.percentChange <= -5) {
                return { class: 'price-drop', text: `${Math.abs(history.percentChange).toFixed(0)}% Drop`, icon: 'ðŸ“‰' };
            }

            // Good value: below average price
            if (currentPrice < history.avgPrice) {
                return { class: 'good-value', text: 'Good Value', icon: 'ðŸ’š' };
            }

            // Premium: above average
            if (currentPrice > history.avgPrice * 1.1) {
                return { class: 'premium', text: 'Premium', icon: 'â­' };
            }

            return null;
        }

        // Get trend indicator HTML
        function getTrendIndicator(resort) {
            const history = priceHistory[resort.id];
            if (!history) return '';

            const arrow = history.trend === 'down' ? 'â†“' : history.trend === 'up' ? 'â†‘' : 'â†’';
            const label = history.trend === 'down' ? 'prices falling' : history.trend === 'up' ? 'prices rising' : 'stable';

            return `<span class="trend-indicator ${history.trend}">${arrow} ${Math.abs(history.percentChange).toFixed(1)}% ${label}</span>`;
        }

        // Generate hidden costs HTML for info panel
        function getHiddenCostsHTML(resort) {
            const costs = hiddenCosts[resort.id];
            if (!costs) return '';

            let items = [];

            if (costs.freeTransfer) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Airport Transfer</span><span class="cost-value included">FREE!</span></div>`);
            } else if (costs.transfer > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Airport Transfer (each way)</span><span class="cost-value">~$${costs.transfer}/person</span></div>`);
            }

            if (costs.tips > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Suggested Staff Tips</span><span class="cost-value">$${costs.tips}/day</span></div>`);
            } else {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Gratuities</span><span class="cost-value included">Included</span></div>`);
            }

            if (costs.extras > 0) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Est. Daily Extras</span><span class="cost-value">~$${costs.extras}/day</span></div>`);
            }

            if (costs.resortCredits) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Resort Credits</span><span class="cost-value included">+$${costs.resortCredits}!</span></div>`);
            }

            if (costs.parksIncluded) {
                items.push(`<div class="hidden-cost-item"><span class="cost-label">Xcaret Parks</span><span class="cost-value included">ALL INCLUDED ($${costs.parksValue}+ value)!</span></div>`);
            }

            if (items.length === 0) return '';

            return `
                <div class="hidden-costs-panel">
                    <div class="hidden-costs-title">
                        <span>ðŸ’°</span> Hidden Costs Breakdown
                    </div>
                    ${items.join('')}
                </div>
            `;
        }

        // Generate savings summary HTML
        function getSavingsHTML(resort) {
            const history = priceHistory[resort.id];
            const costs = hiddenCosts[resort.id];
            const aiValue = allInclusiveValue[resort.id];

            let savings = [];
            let totalSavings = 0;

            // Price vs average
            if (history && resort.priceMay24 < history.avgPrice) {
                const priceSaving = Math.round((history.avgPrice - resort.priceMay24) * 7 * 7);
                savings.push({ label: 'Below avg price (7 rooms Ã— 7 nights)', amount: priceSaving });
                totalSavings += priceSaving;
            }

            // Free transfer
            if (costs && costs.freeTransfer) {
                const transferSaving = 100 * 13; // Approx $100/person for transfers
                savings.push({ label: 'Free airport transfer (13 people)', amount: transferSaving });
                totalSavings += transferSaving;
            }

            // Resort credits
            if (costs && costs.resortCredits) {
                savings.push({ label: 'Resort credits', amount: costs.resortCredits });
                totalSavings += costs.resortCredits;
            }

            // Parks included
            if (costs && costs.parksIncluded) {
                savings.push({ label: 'Parks included value', amount: costs.parksValue });
                totalSavings += costs.parksValue;
            }

            // All-inclusive value
            if (aiValue && aiValue.savingsVsRetail > 300) {
                const aiSaving = aiValue.savingsVsRetail * 7;
                savings.push({ label: 'All-inclusive vs retail (7 nights)', amount: aiSaving });
                totalSavings += aiSaving;
            }

            if (savings.length === 0) return '';

            return `
                <div class="savings-panel">
                    <div class="savings-title">
                        <span>ðŸŽ‰</span> Potential Savings
                    </div>
                    ${savings.map(s => `
                        <div class="savings-item">
                            <span>${s.label}</span>
                            <span style="font-weight:600;">+$${s.amount.toLocaleString()}</span>
                        </div>
                    `).join('')}
                    <div class="savings-total">
                        <span>Total Potential Savings</span>
                        <span>$${totalSavings.toLocaleString()}</span>
                    </div>
                </div>
            `;
        }

        // Estimate total trip cost for a resort (quick calculation)
        function estimateTripCost(resort, nights = 7) {
            const isVilla = resort.isVilla;
            const accommodationCost = isVilla ? resort.priceMay24 * nights : resort.priceMay24 * 7 * nights;
            const flightCost = 4930; // Fixed estimate for 13 people
            const transferCost = hiddenCosts[resort.id]?.freeTransfer ? 0 : 360;
            const excursionCost = hiddenCosts[resort.id]?.parksIncluded ? 1400 : 2800; // Reduced if parks included
            const extrasCost = (hiddenCosts[resort.id]?.extras || 20) * nights;

            return accommodationCost + flightCost + transferCost + excursionCost + extrasCost;
        }

        // Check if resort fits budget
        function getBudgetFit(resort, nights = 7) {
            const total = estimateTripCost(resort, nights);

            if (total <= BUDGET_TARGET.min) {
                return { status: 'under', label: 'Under Budget!', class: 'budget-under', diff: BUDGET_TARGET.min - total };
            } else if (total <= BUDGET_TARGET.max) {
                return { status: 'sweet', label: 'In Budget!', class: 'budget-sweet', diff: 0 };
            } else {
                return { status: 'over', label: 'Over Budget', class: 'budget-over', diff: total - BUDGET_TARGET.max };
            }
        }

        // Comparison feature
        let compareList = [];

        function toggleCompare(resortId) {
            const idx = compareList.indexOf(resortId);
            if (idx > -1) {
                compareList.splice(idx, 1);
            } else if (compareList.length < 4) {
                compareList.push(resortId);
            }
            updateComparisonPanel();
        }

        function clearComparison() {
            compareList = [];
            updateComparisonPanel();
        }

        function updateComparisonPanel() {
            const panel = document.getElementById('comparisonPanel');
            const grid = document.getElementById('comparisonGrid');
            const count = document.getElementById('compareCount');

            count.textContent = compareList.length;

            if (compareList.length === 0) {
                panel.classList.remove('active');
                return;
            }

            panel.classList.add('active');

            grid.innerHTML = compareList.map(id => {
                const r = resorts.find(res => res.id === id);
                if (!r) return '';
                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const perPerson = Math.round(total7 / 14);

                return `
                    <div class="comparison-item">
                        <h4>${r.name}</h4>
                        <div class="compare-row"><span>Per night:</span><span>$${r.priceMay24}</span></div>
                        <div class="compare-row"><span>7-night total:</span><span style="color:#059669;font-weight:600;">$${total7.toLocaleString()}</span></div>
                        <div class="compare-row"><span>Per person:</span><span>$${perPerson}/person</span></div>
                        <div class="compare-row"><span>Value Score:</span><span>${r.valueScore}/10</span></div>
                        <div class="compare-row"><span>Rating:</span><span>â˜… ${r.rating}</span></div>
                        ${r.points ? `<div class="compare-row"><span>Points:</span><span style="color:#4f46e5;">${r.points.toUpperCase()}</span></div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Budget Calculator
        function initBudgetPage() {
            const select = document.getElementById('budgetResort');
            if (!select) return;

            // Populate resort dropdown
            const familyResorts = resorts.filter(r => r.family).sort((a, b) => {
                if (a.isVilla && !b.isVilla) return 1;
                if (!a.isVilla && b.isVilla) return -1;
                return a.priceMay24 - b.priceMay24;
            });

            select.innerHTML = '<option value="">-- Select a resort --</option>' +
                familyResorts.map(r => {
                    const isVilla = r.isVilla;
                    const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                    return `<option value="${r.id}">${r.name} - $${r.priceMay24}/night${isVilla ? ' (Villa)' : ''}</option>`;
                }).join('');

            // Initialize quick comparison with top picks
            renderQuickComparison();
        }

        function renderQuickComparison() {
            const container = document.getElementById('quickComparison');
            if (!container) return;

            // Top picks for multigenerational family
            const topPicks = [
                { id: 2, reason: "Best accessibility + value" },
                { id: 11, reason: "Built for multigenerational" },
                { id: 16, reason: "Parks included = $1200+ value" },
                { id: 44, reason: "Private + sea turtles + lowest cost" }
            ];

            container.innerHTML = topPicks.map(pick => {
                const r = resorts.find(res => res.id === pick.id);
                if (!r) return '';

                const isVilla = r.isVilla;
                const total7 = isVilla ? r.priceMay24 * 7 : r.priceMay24 * 7 * 7;
                const perPerson = Math.round(total7 / 14);
                const dealBadge = getDealBadge(r);
                const estTripCost = estimateTripCost(r);
                const budgetFit = getBudgetFit(r);
                const borderColor = budgetFit.status === 'sweet' ? '#3b82f6' : budgetFit.status === 'under' ? '#10b981' : '#f59e0b';

                return `
                    <div style="background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);border-radius:12px;padding:16px;border:2px solid ${borderColor};">
                        <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:8px;">
                            <div style="font-weight:700;color:#1e293b;">${r.name}</div>
                            <span class="budget-badge ${budgetFit.class}">${budgetFit.status === 'sweet' ? 'âœ“' : budgetFit.status === 'under' ? 'ðŸ’°' : 'âš ï¸'} ${budgetFit.label}</span>
                        </div>
                        <div style="font-size:0.8rem;color:#64748b;margin-bottom:10px;">${pick.reason}</div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:0.8rem;margin-bottom:8px;">
                            <div style="background:white;padding:8px;border-radius:6px;text-align:center;">
                                <div style="color:#64748b;font-size:0.7rem;">Est. Total Trip</div>
                                <div style="font-weight:700;color:${budgetFit.status === 'over' ? '#f59e0b' : '#059669'};">$${estTripCost.toLocaleString()}</div>
                            </div>
                            <div style="background:white;padding:8px;border-radius:6px;text-align:center;">
                                <div style="color:#64748b;font-size:0.7rem;">Per Person</div>
                                <div style="font-weight:700;color:#0891b2;">$${Math.round(estTripCost/14).toLocaleString()}</div>
                            </div>
                        </div>
                        ${budgetFit.status === 'under' ? `<div style="font-size:0.75rem;color:#059669;font-weight:600;margin-bottom:8px;">ðŸ’° $${budgetFit.diff.toLocaleString()} under budget!</div>` : ''}
                        ${budgetFit.status === 'over' ? `<div style="font-size:0.75rem;color:#d97706;font-weight:600;margin-bottom:8px;">âš ï¸ $${budgetFit.diff.toLocaleString()} over max budget</div>` : ''}
                        <div style="display:flex;gap:6px;flex-wrap:wrap;">
                            ${dealBadge ? `<span class="deal-badge ${dealBadge.class}" style="font-size:0.6rem;padding:2px 6px;">${dealBadge.icon}</span>` : ''}
                            ${r.valueScore ? `<span style="background:#d1fae5;color:#065f46;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">${r.valueScore}/10</span>` : ''}
                            ${r.accessible ? `<span style="background:#ffedd5;color:#c2410c;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">â™¿</span>` : ''}
                            ${r.points ? `<span style="background:#cffafe;color:#0e7490;padding:2px 8px;border-radius:4px;font-size:0.7rem;font-weight:600;">${r.points.toUpperCase()}</span>` : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateBudgetCalc() {
            const resortId = document.getElementById('budgetResort')?.value;
            const week = document.getElementById('budgetWeek')?.value || 'may24';
            const nights = parseInt(document.getElementById('budgetNights')?.value || 7);
            const transferType = document.getElementById('transferType')?.value || 'private';
            const excursionBudget = parseInt(document.getElementById('excursionBudget')?.value || 200);

            // Flight costs
            const flightDSM = parseInt(document.getElementById('flightDSM')?.value || 450) * 3;
            const flightIC = parseInt(document.getElementById('flightIC')?.value || 420) * 5;
            const flightFL = parseInt(document.getElementById('flightFL')?.value || 280) * 4;
            const flightOMA = parseInt(document.getElementById('flightOMA')?.value || 380) * 2;
            const totalFlights = flightDSM + flightIC + flightFL + flightOMA;

            // Update transfer note
            const transferNote = document.getElementById('transferCostNote');
            if (transferNote) {
                if (transferType === 'included') {
                    transferNote.innerHTML = 'âœ“ Transfer included with selected resort (if applicable)';
                } else if (transferType === 'private') {
                    transferNote.innerHTML = '2 private vans for 13 people: ~$160-200 each way<br>Recommended for elderly with mobility needs';
                } else {
                    transferNote.innerHTML = 'Shared shuttle: ~$25-50 per person each way<br>Note: May have multiple stops';
                }
            }

            if (!resortId) {
                return;
            }

            const resort = resorts.find(r => r.id === parseInt(resortId));
            if (!resort) return;

            // Resort cost
            const isVilla = resort.isVilla;
            const pricePerNight = week === 'may24' ? resort.priceMay24 : resort.priceMay31;
            const roomsOrVilla = isVilla ? 1 : 7;
            const accommodationTotal = pricePerNight * roomsOrVilla * nights;

            // Transfer costs
            let transferCost = 0;
            const costs = hiddenCosts[resort.id];
            if (transferType === 'included' && costs?.freeTransfer) {
                transferCost = 0;
            } else if (transferType === 'private') {
                transferCost = 360; // 2 vans Ã— 2 ways Ã— ~$90
            } else {
                transferCost = 50 * 13; // $50 per person roundtrip
            }

            // Excursions
            const excursionTotal = excursionBudget * 13;

            // Hidden costs estimate
            const hiddenCostTotal = (costs?.extras || 20) * nights;

            // Grand total
            const grandTotal = totalFlights + accommodationTotal + transferCost + excursionTotal + hiddenCostTotal;
            const perPerson = Math.round(grandTotal / 13);

            // Deal badge
            const dealBadge = getDealBadge(resort);
            const badgeContainer = document.getElementById('resortDealBadge');
            if (badgeContainer) {
                badgeContainer.innerHTML = dealBadge ?
                    `<span class="deal-badge ${dealBadge.class}">${dealBadge.icon} ${dealBadge.text}</span> ${getTrendIndicator(resort)}` :
                    getTrendIndicator(resort);
            }

            // Update summary
            const summary = document.getElementById('budgetSummary');
            if (summary) {
                summary.innerHTML = `
                    <h3>Trip Budget Summary: ${resort.name}</h3>
                    <div style="margin-top:20px;">
                        <div class="budget-total-row">
                            <span class="label">âœˆï¸ Flights (13 people)</span>
                            <span class="amount">$${totalFlights.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸ¨ Accommodation (${isVilla ? 'villa' : '7 rooms'} Ã— ${nights} nights)</span>
                            <span class="amount">$${accommodationTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸš Airport Transfers</span>
                            <span class="amount">${transferCost === 0 ? 'FREE!' : '$' + transferCost.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸŽ¢ Excursions & Activities</span>
                            <span class="amount">$${excursionTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row">
                            <span class="label">ðŸ’µ Est. Extra Expenses</span>
                            <span class="amount">$${hiddenCostTotal.toLocaleString()}</span>
                        </div>
                        <div class="budget-total-row grand-total">
                            <span class="label">TOTAL TRIP COST</span>
                            <span class="amount">$${grandTotal.toLocaleString()}</span>
                        </div>
                    </div>

                    <!-- Budget Fit Indicator -->
                    <div style="margin-top:20px;padding:15px;border-radius:12px;${
                        grandTotal <= BUDGET_TARGET.min ? 'background:rgba(16,185,129,0.2);border:2px solid #10b981;' :
                        grandTotal <= BUDGET_TARGET.max ? 'background:rgba(59,130,246,0.2);border:2px solid #3b82f6;' :
                        'background:rgba(245,158,11,0.2);border:2px solid #f59e0b;'
                    }">
                        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;">
                            <div>
                                <div style="font-weight:700;font-size:1.1rem;">${
                                    grandTotal <= BUDGET_TARGET.min ? 'ðŸ’° Under Budget!' :
                                    grandTotal <= BUDGET_TARGET.max ? 'âœ“ Within Budget!' :
                                    'âš ï¸ Over Budget'
                                }</div>
                                <div style="font-size:0.85rem;opacity:0.9;">Target: $20K - $25K</div>
                            </div>
                            <div style="text-align:right;">
                                ${grandTotal <= BUDGET_TARGET.min ?
                                    `<div style="font-size:1.2rem;font-weight:700;">$${(BUDGET_TARGET.min - grandTotal).toLocaleString()} to spare</div>` :
                                grandTotal <= BUDGET_TARGET.max ?
                                    `<div style="font-size:1.2rem;font-weight:700;">Perfect fit!</div>` :
                                    `<div style="font-size:1.2rem;font-weight:700;">$${(grandTotal - BUDGET_TARGET.max).toLocaleString()} over</div>`
                                }
                            </div>
                        </div>
                        ${grandTotal > BUDGET_TARGET.max ? `
                        <div style="margin-top:10px;font-size:0.8rem;opacity:0.9;">
                            ðŸ’¡ Tip: Try 5-6 nights, reduce excursions, or choose a lower-cost resort
                        </div>
                        ` : ''}
                    </div>

                    <div class="per-person-badge">
                        <div class="amount">$${perPerson.toLocaleString()}</div>
                        <div class="label">per person for entire trip</div>
                    </div>
                    ${costs?.freeTransfer ? '<div style="margin-top:15px;padding:10px;background:rgba(255,255,255,0.15);border-radius:8px;font-size:0.85rem;">âœ¨ This resort includes FREE airport transfers!</div>' : ''}
                    ${costs?.parksIncluded ? '<div style="margin-top:10px;padding:10px;background:rgba(255,255,255,0.15);border-radius:8px;font-size:0.85rem;">ðŸŽ¢ Includes ALL Xcaret parks ($1200+ value) - consider reducing excursion budget!</div>' : ''}
                `;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            initMap();
            renderMatrix();
            renderVoterSelect();
            renderVotingOptions();
            updateVotingResults();
            initBudgetPage();
            document.getElementById('resortCount').textContent = resorts.length;
        });
    </script>
</body>
</html>
